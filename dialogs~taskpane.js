(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{103:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Array="array",e.Object="object",e.Attribute="attribute"}(r||(r={})),t.default=r},108:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),a=function(){function e(){}return e.newInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.getHashCode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-".split(""),n=4369,r=e.length-1;if("string"==typeof e)for(;r>-1;r--)n+=(n<<5)+e.charCodeAt(r);else for(;r>-1;r--)n+=(n<<5)+e[r];var a=2147483647&n,o="";do{o+=t[63&a]}while(a>>=6);return o},e.prototype.isLocalStorageUsed=function(){var e=!1;try{e="true"===localStorage.getItem(r.STORAGE_KEY_LSTORAGE_SUPPORTED)}catch(t){e=!1}return e},e}();t.default=a},1356:function(e,t,n){var r=n(1357);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(541)(r,a);r.locals&&(e.exports=r.locals)},1357:function(e,t,n){(t=n(540)(!1)).push([e.i,'\r\n /*begin animate*/\r\n .view {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    perspective: 400;\r\n  }\r\n  \r\n  .plane {\r\n    width: 120px;\r\n    height: 120px;\r\n    transform-style: preserve-3d;\r\n  }\r\n  .plane.main {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n    transform: rotateX(60deg) rotateZ(-30deg);\r\n    -webkit-animation: rotate 20s infinite linear;\r\n            animation: rotate 20s infinite linear;\r\n  }\r\n  .loadingtitle {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      margin-top: 20px;\r\n      box-sizing: border-box;\r\n      text-align: center;\r\n  }\r\n  .plane.main .circle {\r\n    width: 120px;\r\n    height: 120px;\r\n    position: absolute;\r\n    transform-style: preserve-3d;\r\n    border-radius: 100%;\r\n    box-sizing: border-box;\r\n    box-shadow: 0 0 60px yellow, inset 0 0 60px crimson;\r\n  }\r\n  .plane.main .circle::before, .plane.main .circle::after {\r\n    content: "";\r\n    display: block;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n    width: 10%;\r\n    height: 10%;\r\n    border-radius: 100%;\r\n    /*background: rgba(red, green, blue, 0);\r\n    box-sizing: border-box;\r\n    box-shadow: 0 0 60px 2px crimson;*/\r\n  }\r\n  .plane.main .circle::before {\r\n    transform: translateZ(-90px);\r\n  }\r\n  .plane.main .circle::after {\r\n    transform: translateZ(90px);\r\n  }\r\n  .plane.main .circle:nth-child(1) {\r\n    transform: rotateZ(72deg) rotateX(63.435deg);\r\n  }\r\n  .plane.main .circle:nth-child(2) {\r\n    transform: rotateZ(144deg) rotateX(63.435deg);\r\n  }\r\n  .plane.main .circle:nth-child(3) {\r\n    transform: rotateZ(216deg) rotateX(63.435deg);\r\n  }\r\n  .plane.main .circle:nth-child(4) {\r\n    transform: rotateZ(288deg) rotateX(63.435deg);\r\n  }\r\n  .plane.main .circle:nth-child(5) {\r\n    transform: rotateZ(360deg) rotateX(63.435deg);\r\n  }\r\n  \r\n  @-webkit-keyframes rotate {\r\n    0% {\r\n      transform: rotateX(0) rotateY(0) rotateZ(0);\r\n    }\r\n    100% {\r\n      transform: rotateX(360deg) rotateY(360deg) rotateZ(360deg);\r\n    }\r\n  }\r\n  \r\n  @keyframes rotate {\r\n    0% {\r\n      transform: rotateX(0) rotateY(0) rotateZ(0);\r\n    }\r\n    100% {\r\n      transform: rotateX(360deg) rotateY(360deg) rotateZ(360deg);\r\n    }\r\n  }\r\n    /*end animate*/',""]),e.exports=t},200:function(e,t,n){"use strict";n.d(t,"a",(function(){return le}));var r=n(8),a=n.n(r),o=n(15),i=n.n(o),c=n(17),s=n.n(c),u=n(13),l=n.n(u),d=n(19),p=n.n(d),f=n(20),h=n.n(f),m=n(11),v=n.n(m),y=n(6),b=n.n(y),C=n(4),D=n.n(C),I=n(0),S=n.n(I),g=n(2),k=n(76),x=n.n(k),_=n(187),A=n(259),w=n(237),E=n(567),M=n(269),T=n.n(M);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return h()(this,n)}}var O=function(e){p()(n,e);var t=j(n);function n(e){return i()(this,n),t.call(this,e)}return s()(n,[{key:"handleContextMenu",value:function(e){this.props.onContextMenuClick&&this.props.onContextMenuClick(e)}},{key:"render",value:function(){var e=this;if(this.props.hidden)return I.createElement(I.Fragment,null);var t=this.props.intl,n=T.a.newInstance().getContextMenu(this.props.dataNode,(function(t){e.handleContextMenu(t)}),t.messages);return null==n?I.createElement(I.Fragment,null):I.createElement(E.a,{items:n,target:this.props.contextRef,onDismiss:function(){return e.handleContextMenu(null)}})}}]),n}(I.Component),P=Object(w.c)(O);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var a=void 0;try{a=n[r]}catch(e){continue}e.register(a,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DSTreeNodeContextMenu.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DSTreeNodeContextMenu.js")}}();var N=n(103),B=n.n(N),R=n(86),L=n.n(R),F=n(573),q=n.n(F);function G(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return h()(this,n)}}var W=function(e){p()(n,e);var t=V(n);function n(e){var r;i()(this,n),r=t.call(this,e),b()(l()(r),"toggleChildren",(function(e){var t=Object.assign({},r.state.nodeStatus);t[e]?t[e].expanded=!t[e].expanded:t[e]={expanded:!0},r.setState({nodeStatus:t})})),b()(l()(r),"handleDoubleClick",(function(e,t){r.props.treeMode===L.a.DataBind?r.props.onSelect&&r.props.onSelect(e.databind,e.type):r.props.onContextMenuClick(e,t)})),b()(l()(r),"createObjectNode",(function(e){var t=[],n=Object.getOwnPropertyNames(e);if(n){var r,a=G(n);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!Array.isArray(t[o])&&"object"!==x()(t[o])){var i={name:o,defaultValue:"",type:B.a.Attribute,databind:o};t.push(i)}}}catch(e){a.e(e)}finally{a.f()}}return t})),b()(l()(r),"createGenericNode",(function(e,t,n,a,o){var i={name:e,defaultValue:t,type:n,databind:a};return o?(n===B.a.Array&&"object"===x()(o)&&(i.children=r.createObjectNode(o)),n===B.a.Object&&(i.children=r.createObjectNode(o)),i):i}));var a=r.props.nodes;r.state={contextMenuStatus:{},floatButtonStatus:{},nodeStatus:{}};for(var o=Object.keys(a),c=0;c<o.length;c++){var s=o[c],u=!1;(Array.isArray(a[s])&&"object"===x()(a[s][0])&&null!=a[s][0]||"object"===x()(a[s]))&&(r.props.quickSearch&&r.props.quickSearch.indexOf(s)>-1&&(u=!0),r.state[s]={},r.state[s].expanded=u)}return r}return s()(n,[{key:"ensureContextMemuRef",value:function(e){this.contextMenuRefs||(this.contextMenuRefs=[]);var t=this.contextMenuRefs.find((function(t){return t.id===e}));return t||(t={id:e,ref:I.createRef(e)},this.contextMenuRefs.push(t)),t}},{key:"handleContextMenuClick",value:function(e,t){this.setContextMenuStatus(null,e.name,!1),this.props.onContextMenuClick&&t&&this.props.onContextMenuClick(e,t)}},{key:"buildTreeNodeContextMenu",value:function(e,t){var n,r=this,a=!(null!==(n=this.state.contextMenuStatus[e.name])&&void 0!==n&&n.show);return I.createElement(P,{hidden:this.props.treeMode===L.a.DataBind||a,contextRef:t.ref,onContextMenuClick:function(t){r.handleContextMenuClick(e,t)},dataNode:e})}},{key:"setContextMenuStatus",value:function(e,t,n){null==e||e.preventDefault();var r=Object.assign({},this.state.contextMenuStatus);r[t]||(r[t]={}),r[t].show=n,this.setState({contextMenuStatus:r})}},{key:"setFloatButtonStatus",value:function(e,t,n){null==e||e.preventDefault();var r=Object.assign({},this.state.floatButtonStatus);r[t]||(r[t]={}),r[t].show=n,this.setState({floatButtonStatus:r})}},{key:"buildTreeNodeFloatButton",value:function(e,t){var n,r=this;if(this.props.treeMode===L.a.DataDisplay)return I.createElement(I.Fragment,null);if(null===(n=this.state.floatButtonStatus[e])||void 0===n||!n.show)return I.createElement(I.Fragment,null);var a=this.props.treeMode===L.a.DataBind?g.btnAddDataLink:g.doubleChevrondownIcon;return this.props.treeMode===L.a.DataBind?I.createElement(_.a,{className:"treenode-normal",iconProps:a,onClick:function(){return r.props.onSelect(t.databind,t.type)}}):I.createElement(_.a,{className:"treenode-normal",iconProps:a,ariaLabel:"select data",onClick:function(t){r.setContextMenuStatus(t,e,!0)}})}},{key:"getTreeNodeIcon",value:function(e){var t=q.a.newInstance().buildIconId(this.props.dataSourceType,this.props.treeMode,e),n=q.a.newInstance().getIconById(t);return n?n.Icon:e===B.a.Array?g.jsonArrayIcon:e===B.a.Object?g.jsonObjectIcon:g.jsonFieldIcon}},{key:"getTreeNodeTitle",value:function(e){return e===B.a.Array?"Variable Group":e===B.a.Object?"Variable Object":"Variable"}},{key:"getTreeNodeDbClickCommand",value:function(e){return e===B.a.Array?g.CMD_EDIT_LOOP:e===B.a.Object?g.CMD_CREATE_TABLE:g.CMD_ADD_DYNAMIC_TEXT}},{key:"buildDSTreeNode",value:function(e,t,r,a){var o,i,c,s=this,u=t.type===B.a.Array||t.type===B.a.Object,l=t.type===B.a.Array?this.props.nodes[e][0]:this.props.nodes[e],d=this.getTreeNodeIcon(t.type),p=this.buildTreeNodeFloatButton(e,t),f=this.getTreeNodeDbClickCommand(t.type),h=this.props.treeMode===L.a.DataDisplay&&(null==t||null===(o=t.defaultValue)||void 0===o||null===(i=o.toString())||void 0===i?void 0:i.length)>0?e+":"+t.defaultValue:e;return I.createElement("li",{key:e},u&&I.createElement(A.a,{className:"treenode-normal",iconProps:null!==(c=this.state.nodeStatus[e])&&void 0!==c&&c.expanded?g.collapseTreeIcon:g.expandTreeIcon,onClick:function(){return s.toggleChildren(e)}}),I.createElement(A.a,{className:"treenode-normal",iconProps:d,ariaLabel:r,onContextMenu:function(t){s.setContextMenuStatus(t,e,!0)},onDoubleClick:function(){return s.handleDoubleClick(t,f)},onMouseEnter:function(t){s.setFloatButtonStatus(t,e,!0)},onMouseLeave:function(t){s.setFloatButtonStatus(t,e,!1)}},I.createElement("span",{ref:a.ref,className:"treenode-normal"},h),p),this.buildTreeNodeContextMenu(t,a),u&&I.createElement(n,{nodes:l,treeMode:this.props.treeMode,dataSourceType:this.props.dataSourceType,nodeState:this.state.nodeStatus[e],jsonPath:r,onContextMenuClick:this.props.onContextMenuClick,onSelect:this.props.onSelect,quickSearch:this.props.quickSearch}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.nodes,r=t.nodeState,a=t.jsonPath;if("object"!==x()(n))return null;var o=Object.keys(n).map((function(t,r){var o=a+g.JSON_PATH_SEPARATOR,i=e.ensureContextMemuRef(t);if(Array.isArray(n[t])&&"object"===x()(n[t][0])&&null!=n[t][0]){o=o+t+g.JSON_PATH_ARRAY_ALL;var c=e.createGenericNode(t,"",B.a.Array,o,n[t][0]);return e.buildDSTreeNode(t,c,o,i,!0)}if("object"===x()(n[t])&&!Array.isArray(n[t])){o+=t;var s=e.createGenericNode(t,"",B.a.Object,o,n[t]);return e.buildDSTreeNode(t,s,o,i,!0)}o+=t;var u=e.createGenericNode(t,n[t],B.a.Attribute,o,null);return e.buildDSTreeNode(t,u,o,i,!1)}));return I.createElement("ul",{className:null!=r&&r.expanded?"expand":"collapse"},o)}}]),n}(I.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var a=void 0;try{a=n[r]}catch(e){continue}e.register(a,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DSTreeNode.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DSTreeNode.js")}}();var H=n(281),X=n(462),Z=n(35),Y=n(278),J=n(698),z=n(21),K=n.n(z),$=n(267),Q=n.n($);function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return h()(this,n)}}var te=function(e){p()(r,e);var t,n=ee(r);function r(e){var t;return i()(this,r),t=n.call(this,e),b()(l()(t),"toggleChildren",(function(e){var n,r=Object.assign({},null===(n=t.state)||void 0===n?void 0:n.nodeStatus);r[e].expanded=!r[e].expanded,t.setState({nodeStatus:r})})),b()(l()(t),"initTreeState",(function(e){var n,r=[],a={};if(a.id=g.DEFAULT_VIEW_ID,a.name=e.dataSourceName,a.customData=e.dataContent,a.jsonPath=g.JSON_PATH_ROOT,r.push(a),e.dataViews)for(var o=0;o<e.dataViews.length;o++){var i=e.dataViews[o];r.push({id:i.id,name:i.name,customData:e.dataContent,jsonPath:i.jsonPath})}var c=Object.assign({},t.state.nodeStatus),s=null;t.props.treedata&&null!=(null===(n=t.props.treedata)||void 0===n?void 0:n.dataSourceName)&&(s=t.props.treedata.dataSourceName);for(var u=0;u<r.length;u++){var l=r[u];s&&l.name==s?c[l.id]={expanded:!0}:c[l.id]={expanded:!1}}t.setState({nodeStatus:c,views:r})})),t.state={nodeStatus:{},views:[]},t}return s()(r,[{key:"componentDidMount",value:function(){this.props.treedata&&this.initTreeState(this.props.treedata)}},{key:"handleEditDatasourceEvent",value:(t=a()(D.a.mark((function e(t,n){var r,a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.onCreateDataSource){e.next=6;break}return r=this.props.intl.formatMessage({id:"app.control.main.defaultDataSourceName"}),e.next=4,K.a.newInstance().createEditCustomDataCommand(t,r,n);case 4:a=e.sent,this.props.onCreateDataSource(a);case 6:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getDataSourceIcon",value:function(){var e,t,n;return(null===(e=this.props.treedata)||void 0===e?void 0:e.sourceType)===Q.a.JsonFile?g.jsFileIcon:(null===(t=this.props.treedata)||void 0===t?void 0:t.sourceType)===Q.a.ExcelFile?g.excelFileIcon:(null===(n=this.props.treedata)||void 0===n?void 0:n.sourceType)===Q.a.CommonDataService?g.cdsFileIcon:g.databaseIcon}},{key:"render",value:function(){var e,t=this;if(!this.props.treedata||null===(e=this.props.treedata)||void 0===e||!e.dataSourceId)return I.createElement(X.a,{messageBarType:Z.a.warning},I.createElement(Y.a,{variant:"medium"},this.props.intl.formatMessage({id:"app.control.dstree.createds.description"},{editds:I.createElement(J.a,{key:1,onClick:function(){return t.handleEditDatasourceEvent(t.props.treedata,t.props.isChinese)}},I.createElement(Y.a,{variant:"medium"},I.createElement(H.a,{id:"app.control.dstree.createds.create"})))})));if(this.state.views.find((function(e){return"object"!==x()(e.customData)})))return I.createElement(X.a,{messageBarType:Z.a.error},I.createElement(Y.a,{variant:"medium"},this.props.intl.formatMessage({id:"app.control.dstree.errords.description"},{editds:I.createElement(J.a,{key:1,onClick:function(){return t.handleEditDatasourceEvent(t.props.treedata,t.props.isChinese)}},I.createElement(Y.a,{variant:"medium"},I.createElement(H.a,{id:"app.control.dstree.createds.edit"})))})));var n=this.getDataSourceIcon(),r=this.state.views.map((function(e,r){var a,o;return I.createElement("li",{key:r},I.createElement(_.a,{className:"treenode-normal",iconProps:null!==(a=t.state.nodeStatus[e.id])&&void 0!==a&&a.expanded?g.collapseTreeIcon:g.expandTreeIcon,onClick:function(){return t.toggleChildren(e.id)}}),I.createElement(A.a,{className:"treenode-normal",iconProps:n,title:e.name,ariaLabel:e.name},e.name),t.props.treeMode===L.a.DataPick&&I.createElement(_.a,{className:"treenode-normal",iconProps:g.standardEditIcon,onClick:function(){return t.handleEditDatasourceEvent(t.props.treedata,t.props.isChinese)}}),I.createElement(W,{nodes:e.customData,treeMode:t.props.treeMode,dataSourceType:null===(o=t.props.treedata)||void 0===o?void 0:o.sourceType,nodeState:t.state.nodeStatus[e.id],jsonPath:e.jsonPath,onSelect:t.props.onSelect,quickSearch:t.props.quickSearch,onContextMenuClick:t.props.onContextMenuClick}))}));return I.createElement("ul",{className:"domtree"},r)}}]),r}(I.Component),ne=Object(w.c)(te);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var a=void 0;try{a=n[r]}catch(e){continue}e.register(a,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DSTree.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DSTree.js")}}();var re=n(67),ae=n.n(re),oe=n(80),ie=n(707);function ce(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return h()(this,n)}}var le=function(e){p()(n,e);var t=ue(n);function n(e){var r;return i()(this,n),r=t.call(this,e),b()(l()(r),"handleUpdateDataBind",(function(e,t){r.props.mode===L.a.DataBind&&(null!==e&&r.props.onUpdateDataBind&&r.props.onUpdateDataBind(e,t),r.props.onClose())})),b()(l()(r),"handleCreateDataSource",function(){var e=a()(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r.props.handleUserCommand){e.next=3;break}return e.next=3,r.props.handleUserCommand(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),b()(l()(r),"handleContextMenuClick",(function(e,t){if(console.log("handleContextMenuClick : command=".concat(t,", name=").concat(e.name,", databind=").concat(e.databind)),t===g.CMD_ADD_DYNAMIC_TEXT)return r.quickCreateDynamicText(e.name,e.defaultValue,e.databind);if(t===g.CMD_EDIT_DYNAMIC_IMAGE)return r.quickCreateDynamicImage(e.name,e.defaultValue,e.databind);if(t===g.CMD_EDIT_BARCODE)return r.quickCreateBarcode(e.name,e.defaultValue,e.databind);if(t===g.CMD_EDIT_LOOP)return r.quickCreateLoopControl(e.name,e.databind);if(t===g.CMD_CREATE_TABLE){var n=r.findAttrsOfArray(e);return r.quickCreateTableControl(e.name,e.databind,n)}})),b()(l()(r),"findAttrsOfArray",(function(e){if(!e||!e.children||e.children.length<=0)return null;var t,n=g.CONTROL_TABLE_MAX_NUMOF_FIELDS,r=[],a=ce(e.children);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(0==n--)break;var i=ae.a.newInstance().createDDFTableColumn();i.elementName=o.name,i.dataBind=o.databind,i.defaultValue=o.defaultValue,r.push(i)}}catch(e){a.e(e)}finally{a.f()}return r})),b()(l()(r),"quickCreateDynamicText",function(){var e=a()(D.a.mark((function e(t,n,a){var o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r.props.handleUserCommand){e.next=4;break}return o=K.a.newInstance().quickCreateEditDynamicTextControlCommand(t,n,null,!1,a),e.next=4,r.props.handleUserCommand(o);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),b()(l()(r),"quickCreateDynamicImage",function(){var e=a()(D.a.mark((function e(t,n,a){var o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r.props.handleUserCommand){e.next=4;break}return o=K.a.newInstance().quickCreateDynamicImageControlCommand(t,n,null,!1,a),e.next=4,r.props.handleUserCommand(o);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),b()(l()(r),"quickCreateBarcode",function(){var e=a()(D.a.mark((function e(t,n,a){var o,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r.props.handleUserCommand){e.next=7;break}return(o=ae.a.newInstance().createDDFBarcodeNode()).elementName=t,o.dataBind=a,i=K.a.newInstance().createEditBarcodeControlCommand(o,!1),e.next=7,r.props.handleUserCommand(i);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),b()(l()(r),"quickCreateLoopControl",function(){var e=a()(D.a.mark((function e(t,n){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.props.handleUserCommand){e.next=4;break}return a=K.a.newInstance().quickCreateEditLoopControlCommand(t,null,!1,n),e.next=4,r.props.handleUserCommand(a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),b()(l()(r),"quickCreateTableControl",function(){var e=a()(D.a.mark((function e(t,n,a){var o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.props.handleUserCommand){e.next=4;break}return o=K.a.newInstance().quickCreateEditTableControlCommand(t,null,!1,n,a),e.next=4,r.props.handleUserCommand(o);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),r}return s()(n,[{key:"render",value:function(){var e,t,n,r=this;if(this.props.hidden)return S.a.createElement(S.a.Fragment,null);var a=this.props.treedata&&(null===(e=this.props.treedata)||void 0===e?void 0:e.dataSourceId)&&(null===(t=this.props)||void 0===t?void 0:t.mode)!==L.a.DataDisplay;return S.a.createElement(oe.a,{verticalAlign:!0,hidden:this.props.hidden},S.a.createElement(oe.a.Item,{grow:!0},a&&S.a.createElement(ie.a,{placeholder:this.props.quickSearch,onSearch:this.props.onSearch,underlined:!0})),S.a.createElement(oe.a.Item,null,S.a.createElement(ne,{key:"dstree_"+(null===(n=this.props)||void 0===n?void 0:n.dataHash),treeMode:this.props.mode,treedata:this.props.treedata,quickSearch:this.props.quickSearch,onSelect:function(e,t){r.handleUpdateDataBind(e,t)},hidden:this.props.hidden,onCreateDataSource:this.handleCreateDataSource,onContextMenuClick:this.handleContextMenuClick,isChinese:this.props.isChinese})))}}]),n}(I.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var a=void 0;try{a=n[r]}catch(e){continue}e.register(a,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DSTreeEditor.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DSTreeEditor.js")}}()},269:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(34),a=n(40),o=n(457),i=n(2),c=n(103),s=function(){function e(){}return e.newInstance=function(){return new e},e.prototype.getDDFNodeContextMenu=function(e,t,n){var r,c;if(e.elementType===a.default.Document)return null;var s=[{key:"ctxDelete",text:null!==(r=null==n?void 0:n.formatMessage({id:"app.contextmenu.delete"}))&&void 0!==r?r:"Delete",iconProps:i.btnDeleteIcon,onClick:function(){t(o.default.Delete,e)}}];switch(e.elementType){case a.default.Datasource:return null;case a.default.IFGroup:case a.default.Loop:return s.push({key:"ctxDeleteWithoutContent",text:null!==(c=null==n?void 0:n.formatMessage({id:"app.contextmenu.deletewithoutcontents"}))&&void 0!==c?c:"Delete without Contents",iconProps:i.btnDeleteDependency,onClick:function(){t(o.default.DeleteWithoutContent,e)}}),s;default:return s}},e.prototype.getContextMenu=function(e,t,n){var r=n?n["app.contextmenu.add.var"]:"Add Text",a=n?n["app.contextmenu.add.table"]:"Add Table",o=n?n["app.contextmenu.add.loop"]:"Add Loop",s=n?n["app.contextmenu.add.image"]:"Add Image",u=n?n["app.contextmenu.add.barcode"]:"Add Barcode",l=[{key:"ctxAddAsTable",text:a,iconProps:{iconName:"Table"},onClick:function(){t(i.CMD_CREATE_TABLE)}},{key:"ctxAddAsLoop",text:o,iconProps:i.loopIcon,onClick:function(){t(i.CMD_EDIT_LOOP)}}],d=[{key:"ctxAddAsTable",text:a,iconProps:{iconName:"Table"},onClick:function(){t(i.CMD_CREATE_TABLE)}}],p=[{key:"ctxAddAsVariable",text:r,iconProps:i.dynamicTextIcon,onClick:function(){t(i.CMD_ADD_DYNAMIC_TEXT)}},{key:"ctxAddAsImage",text:s,iconProps:i.dynamicImageIcon,onClick:function(){t(i.CMD_EDIT_DYNAMIC_IMAGE)}},{key:"ctxAddAsBarcode",text:u,iconProps:i.barcodeIcon,onClick:function(){t(i.CMD_EDIT_BARCODE)}}];switch(e.type){case c.default.Array:return l;case c.default.Object:return d;case c.default.Attribute:return p;default:return null}},e.prototype.getTreeNodeContextButtonStyle=function(){var e;return{splitButtonMenuButton:{backgroundColor:"white",width:32,height:32,border:"none"},splitButtonMenuIcon:{height:32},splitButtonContainer:{selectors:(e={},e[r.HighContrastSelector]={border:"none"},e)}}},e}();t.default=s},270:function(e,t,n){"use strict";var r=n(15),a=n.n(r),o=n(17),i=n.n(o),c=n(19),s=n.n(c),u=n(20),l=n.n(u),d=n(11),p=n.n(d),f=n(0),h=n(237);n(1356);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return l()(this,n)}}var v=function(e){s()(n,e);var t=m(n);function n(e,r){return a()(this,n),t.call(this,e,r)}return i()(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return f.createElement("div",{className:"view"},f.createElement("div",{className:"plane main"},f.createElement("div",{className:"circle"}),f.createElement("div",{className:"circle"}),f.createElement("div",{className:"circle"}),f.createElement("div",{className:"circle"}),f.createElement("div",{className:"circle"}),f.createElement("div",{className:"circle"})),f.createElement("div",{className:"loadingtitle"},this.props.intl.formatMessage({id:"loading"})))}}]),n}(f.Component);t.a=Object(h.c)(v),function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var a=void 0;try{a=n[r]}catch(e){continue}e.register(a,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\preload\\Preload.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\preload\\Preload.js")}}()},457:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Delete="delete",e.DeleteWithoutContent="deleteWithoutContent"}(r||(r={})),t.default=r},53:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressState=t.PreviewDocumentStepData=t.PreviewStep=t.ProgressStatus=void 0,function(e){e.NotStarted="notstarted",e.InProgress="inprogress",e.Completed="completed",e.Error="error"}(r=t.ProgressStatus||(t.ProgressStatus={})),function(e){e.PreparingDocument="preparingdocument",e.AssemblyDocument="assemblydocument",e.GenerateResult="generateresult"}(t.PreviewStep||(t.PreviewStep={}));var a=function(){};t.PreviewDocumentStepData=a;var o=function(e,t){this.key=e,this.value=t},i=function(){this.pStateMap=[]};t.ProgressState=i;var c=function(){function e(e){void 0===e&&(e=null),this.pState=null!=e?e:new i}return e.prototype.setStepData=function(e,t){var n=this.pState.pStateMap.findIndex((function(t){return t.key===e})),r=new o(e,t);n>-1?this.pState.pStateMap[n]=r:this.pState.pStateMap.push(r)},e.prototype.getStepData=function(e){var t=this.pState.pStateMap.find((function(t){return t.key===e}));return null==t?void 0:t.value},e.prototype.updateStateInProgess=function(e){this.setStepData(this.pState.currentStep,e),this.pState.progress=r.InProgress},e.prototype.updateStateCompleted=function(e){this.setStepData(this.pState.currentStep,e),this.pState.progress=r.Completed},e.prototype.updateStateWithFatal=function(e,t){this.setStepData(this.pState.currentStep,e),this.pState.error=t,this.pState.progress=r.Error},e.prototype.updateStatusCompleted=function(){this.pState.progress=r.Completed},e.prototype.updateStatusFatal=function(e){this.pState.progress=r.Error,this.pState.error=e},e.prototype.setCurrentStep=function(e){this.pState.currentStep=e},e.prototype.getCurrentStep=function(){return this.pState.currentStep},e.prototype.getState=function(){return this.pState},e}();t.default=c},573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),a=n(103),o=n(86),i=n(267),c=function(){function e(){this.icons=[],this.buildJsonDataSourceIcons(i.default.JsonFile),this.buildTableDataSourceIcons(i.default.ExcelFile),this.buildTableDataSourceIcons(i.default.Database),this.buildJsonDataSourceIcons(i.default.WebApi)}return e.newInstance=function(){return this.m_Instance||(this.m_Instance=new e),this.m_Instance},e.prototype.buildJsonDataSourceIcons=function(e){this.icons.push({IconId:e+"_"+o.default.DataPick+"_"+a.default.Array,Icon:r.jsonArrayIcon}),this.icons.push({IconId:e+"_"+o.default.DataPick+"_"+a.default.Object,Icon:r.jsonObjectIcon}),this.icons.push({IconId:e+"_"+o.default.DataPick+"_"+a.default.Attribute,Icon:r.jsonFieldIcon}),this.icons.push({IconId:e+"_"+o.default.DataBind+"_"+a.default.Array,Icon:r.varGroupIcon}),this.icons.push({IconId:e+"_"+o.default.DataBind+"_"+a.default.Object,Icon:r.varObjectIcon}),this.icons.push({IconId:e+"_"+o.default.DataBind+"_"+a.default.Attribute,Icon:r.varIcon}),this.icons.push({IconId:e+"_"+o.default.DataDisplay+"_"+a.default.Array,Icon:r.varGroupIcon}),this.icons.push({IconId:e+"_"+o.default.DataDisplay+"_"+a.default.Object,Icon:r.varObjectIcon}),this.icons.push({IconId:e+"_"+o.default.DataDisplay+"_"+a.default.Attribute,Icon:r.varIcon})},e.prototype.buildTableDataSourceIcons=function(e){this.icons.push({IconId:e+"_"+o.default.DataPick+"_"+a.default.Array,Icon:r.dataTableIcon}),this.icons.push({IconId:e+"_"+o.default.DataPick+"_"+a.default.Object,Icon:r.dataTableRowIcon}),this.icons.push({IconId:e+"_"+o.default.DataPick+"_"+a.default.Attribute,Icon:r.dataColumnIcon}),this.icons.push({IconId:e+"_"+o.default.DataBind+"_"+a.default.Array,Icon:r.dataTableIcon}),this.icons.push({IconId:e+"_"+o.default.DataBind+"_"+a.default.Object,Icon:r.dataTableRowIcon}),this.icons.push({IconId:e+"_"+o.default.DataBind+"_"+a.default.Attribute,Icon:r.varIcon}),this.icons.push({IconId:e+"_"+o.default.DataDisplay+"_"+a.default.Array,Icon:r.dataTableIcon}),this.icons.push({IconId:e+"_"+o.default.DataDisplay+"_"+a.default.Object,Icon:r.dataTableRowIcon}),this.icons.push({IconId:e+"_"+o.default.DataDisplay+"_"+a.default.Attribute,Icon:r.varIcon})},e.prototype.getIconById=function(e){return this.icons.find((function(t){return t.IconId===e}))},e.prototype.buildIconId=function(e,t,n){return e+"_"+t+"_"+n},e.m_Instance=null,e}();t.default=c},86:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.DataBind="databind",e.DataPick="datapick",e.DataDisplay="datadisplay"}(r||(r={})),t.default=r}}]);
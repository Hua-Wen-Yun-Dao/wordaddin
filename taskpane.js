!function(e){function t(t){for(var r,i,s=t[0],c=t[1],l=t[2],p=0,d=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(t);d.length;)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={15:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;a.push([1318,0,1,4,3,9,7,8,18,2,5,6,10]),n()}({104:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ContentStructure="contentstructure",e.DocumentData="documentdata",e.ToolBox="toolbox"}(r||(r={})),t.default=r},1318:function(e,t,n){n(538),e.exports=n(1365)},1365:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(181),a=n(15),i=n.n(a),s=n(17),c=n.n(s),l=n(19),u=n.n(l),p=n(20),d=n.n(p),f=n(11),m=n.n(f),h=n(237),v=n(281),y=n(698),g=n(25),k=n(201),b=n(642),C=n(422),D=n(80),x=n(278),E=n(699),w=n(259),S=n(2),I=n(10),O=n(155),F=n(460);function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var T=function(e){u()(n,e);var t=P(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"createResultIcon",value:function(e,t,n){return r.createElement(F.a,{content:e,id:Date.now()},r.createElement(k.a,{ariaLabel:e,iconName:n,className:t}))}},{key:"getCheckResultIcon",value:function(){if(this.props.apiversion)return"1.3"===this.props.apiversion?this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.success"}),"iconsuccess",S.statusCorrectIcon.iconName):"none"===this.props.apiversion?this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.apiversionerror"}),"iconfailed",S.statusErrorIcon.iconName):this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.apiversionwarn"}),"iconwarning",S.statusWarningIcon.iconName);if(this.props.host&&"Word"!==this.props.host)return this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.worderror"}),"iconfailed",S.statusErrorIcon.iconName);if(this.props.platform&&"Web"===this.props.platform)return this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.webwarn"}),"iconwarning",S.statusWarningIcon.iconName);if(this.props.hostversion){var e=this.props.hostversion.split(".");if(e&&4===e.length){var t=Number.parseInt(e[0]),n=Number.parseInt(e[2]),r=Number.parseInt(e[3]);if(this.props.platform){if("Windows"===this.props.platform)return t<16||16===t&&n<7668||16===t&&7668===n&&r<1e3?this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.apiversionerror"}),"iconfailed",S.statusErrorIcon.iconName):this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.success"}),"iconsuccess",S.statusCorrectIcon.iconName);if("Mac OS"===this.props.platform)return t<16||16===t&&n<15||16===t&&15===n&&r<32?this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.apiversionerror"}),"iconfailed",S.statusErrorIcon.iconName):this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.success"}),"iconsuccess",S.statusCorrectIcon.iconName)}}}return this.createResultIcon(this.props.intl.formatMessage({id:"app.page.land.env.check.failed"}),"iconfailed",S.statusErrorIcon.iconName)}},{key:"render",value:function(){return this.getCheckResultIcon()}}]),n}(r.Component),M=Object(h.c)(T);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\landpage\\checkresult.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\landpage\\checkresult.js")}}();var R=function(e){u()(n,e);var t=j(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={loading:!0},r}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.createElement("div",{className:"copyright"},r.createElement(D.a,{horizontal:!0,horizontalAlign:"center"},r.createElement(D.a.Item,null,r.createElement(k.a,{iconName:"company-logo-svg",className:"footerlogo"})),r.createElement(D.a.Item,null,r.createElement("span",{className:"footertext"},this.props.intl.formatMessage({id:"app.page.land.copyright"}))),this.props.showPrivacy&&r.createElement(r.Fragment,null,r.createElement(D.a.Item,null,r.createElement(y.a,{className:"footertextlink",onClick:this.props.onOpenULA},this.props.intl.formatMessage({id:"app.account.link.ulashort"}))),r.createElement(D.a.Item,null,r.createElement("span",{className:"footertextlink"},"|")),r.createElement(D.a.Item,null,r.createElement(y.a,{className:"footertextlink",onClick:this.props.onOpenCookiePolicy},this.props.intl.formatMessage({id:"app.account.link.cookieshort"}))))))}}]),n}(r.Component),N=Object(h.c)(R);function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\copyright\\index.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\copyright\\index.js")}}();var B=function(e){u()(n,e);var t=L(n);function n(e){var o;i()(this,n),o=t.call(this,e);var a=!1;try{a=Object(I.k)()?"true"===localStorage.getItem(S.STORAGE_KEY_LICENSE_PRV_AGREED):!0===Object(I.C)(S.STORAGE_KEY_LICENSE_PRV_AGREED)}catch(e){}return o.state={showULA:!a,ulaPrvAgreed:a,coachMarkTarget:r.createRef("coachElement"),showCoachMark:!1},o}return c()(n,[{key:"logAudit",value:function(e){try{this.state.showULA&&Object(O.e)({userName:"bootstrap",recordType:e})}catch(e){console.log(e.toString())}}},{key:"componentDidMount",value:function(){this.logAudit("Access Landing Page"),this.setState({showCoachMark:!0})}},{key:"handleStartDesigner",value:function(){try{Object(I.p)(S.STORAGE_KEY_SHOW_LAND_PAGE,!1)}catch(e){console.log(e.toString())}this.logAudit("Show Designer"),this.props.onStartDesigner&&this.props.onStartDesigner()}},{key:"handleGetASampleDemo",value:function(){this.logAudit("Get Sample Template"),Object(I.F)(S.URL_GET_A_SAMPLE)}},{key:"getPlatformInfo",value:function(){var e=Object(I.g)();switch(e.toUpperCase()){case"PC".toUpperCase():return"Windows";case"Mac".toUpperCase():return"Mac OS";case"OfficeOnline".toUpperCase():return"Web";default:return e}}},{key:"getHost",value:function(){return Object(I.f)()}},{key:"getHostVersion",value:function(e){return"Windows"===e||"Mac OS"===e?Object(I.z)():"Office Online"}},{key:"getApiVersion",value:function(){var e=Object(I.j)("WordApi","1.3");return e?"1.3":(e=Object(I.j)("WordApi","1.2"))?"1.2":(e=Object(I.j)("WordApi","1.1"))?"1.1":"None"}},{key:"onAgreeboxChecked",value:function(e,t){this.setState({ulaPrvAgreed:t});try{Object(I.k)()?localStorage.setItem(S.STORAGE_KEY_LICENSE_PRV_AGREED,t):Object(I.p)(S.STORAGE_KEY_LICENSE_PRV_AGREED,t)}catch(e){console.log(e.toString())}}},{key:"renderLicenseboxLabel",value:function(){var e=this;return r.createElement("div",{className:"uladescription"},r.createElement(v.a,{id:"app.page.land.chk.agreement",values:{ula:r.createElement(r.Fragment,null,r.createElement(y.a,{onClick:function(){return e.handleULA()}},this.props.intl.formatMessage({id:"app.account.link.ula"})),this.props.intl.formatMessage({id:"app.page.land.agreement.and"}),r.createElement(y.a,{onClick:function(){return e.handleCookiePolicy()}},this.props.intl.formatMessage({id:"app.account.link.cookie"})))}}))}},{key:"getLanguageCode",value:function(){var e=Object(I.E)();return e=e.split(/[-_]/)[0].toLowerCase()}},{key:"handleCookiePolicy",value:function(){"zh"===this.getLanguageCode()||"cn"===this.getLanguageCode()?Object(I.F)(S.URL_PRIVACY_COOKIE_CN):Object(I.F)(S.URL_PRIVACY_COOKIE_EN)}},{key:"handleULA",value:function(){"zh"===this.getLanguageCode()||"cn"===this.getLanguageCode()?Object(I.F)(S.URL_PRIVACY_ULA_CN):Object(I.F)(S.URL_PRIVACY_ULA_EN)}},{key:"handleGettingStarted",value:function(){this.logAudit("View Getting Started"),"zh"===this.getLanguageCode()||"cn"===this.getLanguageCode()?Object(I.F)(S.URL_GETTING_START_CN):Object(I.F)(S.URL_GETTING_START_EN)}},{key:"render",value:function(){var e=this,t=this.getPlatformInfo(),n=this.getHost(),o=this.getHostVersion(t),a=this.getApiVersion(),i={text:this.props.intl.formatMessage({id:"action.Go"}),onClick:function(){e.handleGettingStarted(),e.setState({showCoachMark:!1})}},s={directionalHint:g.a.bottomCenter,doNotLayer:!1};return r.createElement("div",{className:"landwrapper"},r.createElement("div",{className:"landbanner"},r.createElement(k.a,{className:"companylogo",iconName:"product-logo-svg"}),r.createElement("h2",null,this.props.intl.formatMessage({id:"app.page.land.title"})),r.createElement("h3",null,r.createElement(k.a,{iconName:S.quickStartIcon.iconName}),r.createElement("span",{ref:this.state.coachMarkTarget},r.createElement(y.a,{className:"gettingstarted",onClick:function(){return e.handleGettingStarted()}},this.props.intl.formatMessage({id:"app.page.land.btn.gettingstarted"})))),this.state.showCoachMark&&r.createElement(b.a,{target:this.state.coachMarkTarget.current,positioningContainerProps:s},r.createElement(C.a,{headline:this.props.intl.formatMessage({id:"app.page.land.btn.gettingstarted"}),hasCloseButton:!0,closeButtonAriaLabel:"Close",onDismiss:function(){e.setState({showCoachMark:!1})},primaryButtonProps:i},this.props.intl.formatMessage({id:"app.page.land.coach"})))),r.createElement("div",{className:"landbody"},r.createElement("ul",null,r.createElement("li",null,r.createElement(k.a,{iconName:"CoffeeScript",className:"featureicon"}),r.createElement("span",null,this.props.intl.formatMessage({id:"app.page.land.feature.easyuse"}))),r.createElement("li",null,r.createElement(k.a,{iconName:"ModelingView",className:"featureicon"}),r.createElement("span",null,this.props.intl.formatMessage({id:"app.page.land.feature.freeintegration"}))),r.createElement("li",null,r.createElement(k.a,{iconName:"ProductVariant",className:"featureicon"}),r.createElement("span",null,this.props.intl.formatMessage({id:"app.page.land.feature.designtool"}))),r.createElement("li",null,r.createElement(k.a,{iconName:"TextDocumentEdit",className:"featureicon"}),r.createElement("span",null,this.props.intl.formatMessage({id:"app.page.land.feature.easydesign"}))),r.createElement("li",null,r.createElement(k.a,{iconName:"LaptopSecure",className:"featureicon"}),r.createElement("span",null,this.props.intl.formatMessage({id:"app.page.land.feature.safestorage"})))),r.createElement("div",{className:"checkresult"},r.createElement(D.a,{tokens:S.buttonGroupStackTokens},r.createElement(D.a.Item,null,r.createElement(x.a,null,this.props.intl.formatMessage({id:"app.page.land.env.title"}))),r.createElement(D.a.Item,null,r.createElement(D.a,{horizontal:!0,tokens:S.buttonGroupStackTokens},r.createElement(D.a.Item,{styles:S.runtimeInfoLabelStyles},this.props.intl.formatMessage({id:"app.page.land.env.platform"})),r.createElement(D.a.Item,{styles:S.runtimeInfoValueStyles},t," ",r.createElement(M,{platform:t,hostversion:o})))),r.createElement(D.a.Item,null,r.createElement(D.a,{horizontal:!0,tokens:S.buttonGroupStackTokens},r.createElement(D.a.Item,{styles:S.runtimeInfoLabelStyles},this.props.intl.formatMessage({id:"app.page.land.env.hostversion"})),r.createElement(D.a.Item,{styles:S.runtimeInfoValueStyles,grow:2},n," (",o,") ",r.createElement(M,{platform:t,host:n,hostversion:o})))),r.createElement(D.a.Item,null,r.createElement(D.a,{horizontal:!0,tokens:S.buttonGroupStackTokens},r.createElement(D.a.Item,{styles:S.runtimeInfoLabelStyles},this.props.intl.formatMessage({id:"app.page.land.env.apiversion"})),r.createElement(D.a.Item,{styles:S.runtimeInfoValueStyles},a," ",r.createElement(M,{apiversion:a}))))))),r.createElement("div",{className:"pagefooter"},r.createElement("div",{className:"buttongroup"},this.state.showULA&&r.createElement(D.a,null,r.createElement(D.a.Item,{align:"center"},r.createElement(E.a,{onChange:function(t,n){e.onAgreeboxChecked(t,n)},onRenderLabel:function(){return e.renderLicenseboxLabel()}}))),r.createElement(D.a,{horizontal:!0,horizontalAlign:"center",tokens:S.buttonGroupStackTokens},r.createElement(D.a.Item,null,r.createElement(w.a,{disabled:!this.state.ulaPrvAgreed,iconProps:S.btnDesignIcon,onClick:function(){return e.handleStartDesigner()}},this.props.intl.formatMessage({id:"app.page.land.btn.showdesigner"}))),r.createElement(D.a.Item,null,r.createElement(w.a,{primary:!0,iconProps:S.getSampleIcon,onClick:function(){return e.handleGetASampleDemo()}},this.props.intl.formatMessage({id:"action.getASample"}))))),r.createElement(N,{showPrivacy:!this.state.showULA,onOpenULA:function(){return e.handleULA()},onOpenCookiePolicy:function(){return e.handleCookiePolicy()}})))}}]),n}(r.Component),U=Object(h.c)(B);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\landpage\\index.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\landpage\\index.js")}}();var A=n(8),_=n.n(A),G=n(13),H=n.n(G),W=n(6),V=n.n(W),z=n(4),Y=n.n(z),q=n(462),K=n(35),Q=n(712),J=(n(1353),n(702)),Z=n(142);function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}r.Component;!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\Progress.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\Progress.js")}}();var $=n(200),ee=n(77),te=n.n(ee),ne=n(187),re=n(567),oe=n(21),ae=n.n(oe),ie=n(40),se=n.n(ie),ce=n(457),le=n.n(ce),ue=n(269),pe=n.n(ue),de=n(30),fe=n.n(de);function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var he=function(e){u()(o,e);var t,n=me(o);function o(e){var t;i()(this,o),(t=n.call(this,e)).state={};return t.state={contextMenuStatus:{},nodeStatus:{},floatButtonStatus:{}},t}return c()(o,[{key:"componentDidMount",value:function(){}},{key:"toggleChildren",value:function(e){var t=Object.assign({},this.state.nodeStatus);t[e]?t[e].expanded=!t[e].expanded:(t[e]={},t[e].expanded=!0),this.setState({nodeStatus:t})}},{key:"onNodeClick",value:function(e){if(null!=this.props.handleUserCommand){var t=e.elementType===se.a.Datasource?e.dataSourceId:e.elementId,n=ae.a.newInstance().createSelectDocumentNodeCommand(t,e.elementType);this.props.handleUserCommand(n)}}},{key:"getNodeIcon",value:function(e){switch(e){case se.a.DynamicChart:return S.chartIcon;case se.a.DynamicImage:return S.dynamicImageIcon;case se.a.DynamicText:return S.dynamicTextIcon;case se.a.IFGroup:return S.ifGroupIcon;case se.a.Loop:return S.loopIcon;case se.a.Datasource:return S.databaseIcon;case se.a.Barcode:return S.barcodeIcon;case se.a.QRCode:return S.qrcodeIcon;case se.a.TextBox:return S.textboxIcon;case se.a.CheckBox:return S.checkboxIcon;case se.a.DatePicker:return S.datepickerIcon;case se.a.Dropdown:return S.dropdownIcon;default:return S.btnWarningIcon}}},{key:"executeContextMenuEvent",value:function(e,t){var n=null;e===le.a.Delete&&(n=ae.a.newInstance().createDeleteControlCommand(t.elementId,t.elementType)),e===le.a.DeleteWithoutContent&&(n=ae.a.newInstance().createDeletewithoutContentCommand(t.elementId,t.elementType)),this.props.handleUserCommand&&n&&this.props.handleUserCommand(n)}},{key:"handleEditDatasourceEvent",value:(t=_()(Y.a.mark((function e(t,n){var r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.handleUserCommand){e.next=5;break}return e.next=3,ae.a.newInstance().createEditCustomDataCommand(t,this.props.intl.formatMessage({id:"app.control.main.defaultDataSourceName"}),n);case 3:r=e.sent,this.props.handleUserCommand(r);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"setContextMenuStatus",value:function(e,t){var n=Object.assign({},this.state.contextMenuStatus);n[e]||(n[e]={}),n[e].show=t,this.setState({contextMenuStatus:n})}},{key:"handleContextMenu",value:function(e,t,n){null==e||e.preventDefault(),this.setContextMenuStatus(t.elementId,n)}},{key:"ensureContextMemuRef",value:function(e){this.contextMenuRefs||(this.contextMenuRefs=[]);var t=this.contextMenuRefs.find((function(t){return t.id===e.elementId}));return t||(t={id:e.elementId,ref:r.createRef(e.elementId)},this.contextMenuRefs.push(t)),t}},{key:"setFloatButtonStatus",value:function(e,t,n){null==e||e.preventDefault();var r=Object.assign({},this.state.floatButtonStatus);r[t]||(r[t]={}),r[t].show=n,this.setState({floatButtonStatus:r})}},{key:"buildDDFTreeNode",value:function(e,t,n,a,i,s){var c,l,u,p=this;return r.createElement("li",{key:e.elementId},r.createElement("div",null,s&&r.createElement(ne.a,{iconProps:null!==(c=this.state.nodeStatus[e.elementId])&&void 0!==c&&c.expanded?S.collapseTreeIcon:S.expandTreeIcon,onClick:function(){return p.toggleChildren(e.elementId)},className:"treenode-normal"}),r.createElement(w.a,{iconProps:t,title:e.elementName,ariaLabel:e.elementName,className:n,onClick:function(){p.onNodeClick(e)},onContextMenu:function(t){return p.handleContextMenu(t,e,!0)},onMouseEnter:function(t){p.setFloatButtonStatus(t,e.elementId,!0)},onMouseLeave:function(t){p.setFloatButtonStatus(t,e.elementId,!1)}},r.createElement("span",{ref:a.ref,className:"treenodetext"},e.elementName),(null===(l=this.state.floatButtonStatus[e.elementId])||void 0===l?void 0:l.show)&&r.createElement(ne.a,{className:n,iconProps:S.doubleChevrondownIcon,onClick:function(t){return p.handleContextMenu(t,e,!0)}})),i&&r.createElement(re.a,{items:i,hidden:!(null!==(u=this.state.contextMenuStatus[e.elementId])&&void 0!==u&&u.show),target:a.ref,onDismiss:function(){return p.handleContextMenu(null,e,!1)}})),s&&r.createElement(o,{nodes:e,nodeState:this.state.nodeStatus[e.elementId],handleUserCommand:function(e){p.props.handleUserCommand(e)},selected:this.props.selected}))}},{key:"treeNodeBuilder",value:function(e){var t,n=this,o=pe.a.newInstance().getDDFNodeContextMenu(e,(function(e,t){n.executeContextMenuEvent(e,t)}),this.props.intl);switch(e.elementType){case se.a.DynamicText:case se.a.DynamicImage:case se.a.DynamicChart:case se.a.QRCode:case se.a.Barcode:case se.a.TextBox:case se.a.CheckBox:case se.a.DatePicker:case se.a.Dropdown:var a=this.getNodeIcon(e.elementType),i=this.ensureContextMemuRef(e),s=this.props.selected&&this.props.selected.elementId===e.elementId?"treenode-selected":"treenode-normal";return this.buildDDFTreeNode(e,a,s,i,o,!1);case se.a.Loop:case se.a.IFGroup:var c=this.getNodeIcon(e.elementType),l=this.ensureContextMemuRef(e),u=this.props.selected&&this.props.selected.elementId===e.elementId?"treenode-selected":"treenode-normal";return this.buildDDFTreeNode(e,c,u,l,o,e.children&&e.children.length>0);default:var p=this.getNodeIcon(e.elementType);return r.createElement("li",{key:e.elementId},r.createElement(w.a,{iconProps:null!==(t=this.state.nodeStatus[e.elementId])&&void 0!==t&&t.expanded?S.collapseTreeIcon:S.expandTreeIcon,onClick:function(){return n.toggleChildren(index)},className:"treenode-normal"}),r.createElement(w.a,{iconProps:p,title:e.elementType,ariaLabel:e.elementType},e.elementType))}}},{key:"render",value:function(){var e=this,t=this.props,n=t.nodes,o=t.nodeState;if(!n)return r.createElement(r.Fragment,null);var a=n.children.map((function(t){return e.treeNodeBuilder(t)}));return r.createElement("ul",{className:null!=o&&o.expanded?"expand":"collapse"},a)}}]),o}(r.Component),ve=Object(h.c)(he);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DDFTreeNode.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DDFTreeNode.js")}}();var ye=n(707),ge=n(104),ke=n.n(ge);function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var Ce=function(e){u()(n,e);var t=be(n);function n(e){var r;if(i()(this,n),r=t.call(this,e),V()(H()(r),"toggleChildren",(function(e){var t=Object.assign({},r.state);t[e].expanded=!t[e].expanded,r.setState(t)})),V()(H()(r),"onNodeSelected",function(){var e=_()(Y.a.mark((function e(t){var n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r.props.handleUserCommand){e.next=4;break}return n=ae.a.newInstance().createSelectDocumentNodeCommand(t.documentId,se.a.Document),e.next=4,r.props.handleUserCommand(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),V()(H()(r),"showDataView",(function(){r.props.setDocumentViewMode&&r.props.setDocumentViewMode(ke.a.DocumentData)})),V()(H()(r),"handleGetASampleDemo",(function(){Object(I.F)(S.URL_GET_A_SAMPLE)})),V()(H()(r),"showToolboxView",(function(){r.props.setDocumentViewMode&&r.props.setDocumentViewMode(ke.a.ToolBox)})),null!=r.props.treedata){var o=r.props.treedata;r.state=V()({},o.documentId,{expanded:!1,filter:{enable:!1,expression:""}})}return r}return c()(n,[{key:"enableFilterBox",value:function(e){var t=Object.assign({},this.state.filter);t.enable=e,this.setState({filter:t})}},{key:"handleQuickSearch",value:function(e){var t=Object.assign({},this.state.filter);t.enable=!1,t.expression=e,this.setState({filter:t})}},{key:"handleClearSearch",value:function(){var e=Object.assign({},this.state.filter);e.enable=!1,e.expression="",this.setState({filter:e})}},{key:"isKeptbyFilter",value:function(e){var t,n,r=null===(t=this.state.filter)||void 0===t||null===(n=t.expression)||void 0===n?void 0:n.toLowerCase();return!(e.elementName&&r&&r.length>0&&-1===e.elementName.toLowerCase().indexOf(r))}},{key:"buildTreeChildren",value:function(e){if(!e||!e.length)return[];for(var t=[],n=0;n<e.length;n++){var r=e[n];this.isKeptbyFilter(r)?(t.push(r),r.children&&(r.children=this.buildTreeChildren(r.children))):t.push.apply(t,te()(this.buildTreeChildren(r.children)))}return t.length?t:[]}},{key:"render",value:function(){var e,t,n,o,a,i,s,c,l,u=this,p=this.props.treedata;if(null==p)return r.createElement("li",null,r.createElement(q.a,{messageBarType:K.a.warning}," ",r.createElement(x.a,{variant:"large"}," The DFF file is missing, Contact your technical support for Help.")));var d={id:p.documentId,text:p.documentName,documentId:p.documentId,documentName:p.documentName,elementType:se.a.Document,children:[]};if(p.children&&p.children.length>0){var f,m=this.buildTreeChildren(p.children);(f=d.children).push.apply(f,te()(m))}var h=pe.a.newInstance(),g=(h.getContextMenu(d),h.getTreeNodeContextButtonStyle());if(!(0!=(null===(e=d.children)||void 0===e?void 0:e.length)||null!==(t=this.state.filter)&&void 0!==t&&t.expression&&(null===(n=this.state.filter)||void 0===n||null===(o=n.expression)||void 0===o?void 0:o.length)>0||this.props.hidden))return r.createElement(q.a,{messageBarType:K.a.warning},r.createElement(x.a,{variant:"medium"},r.createElement(v.a,{id:"app.control.ddftree.createcs.description",values:{toolbox:r.createElement(y.a,{onClick:function(){u.showToolboxView()}},r.createElement(v.a,{id:"app.control.ddftree.createcs.toolbox"})),dsquickaction:r.createElement(y.a,{onClick:function(){u.showDataView()}},r.createElement(v.a,{id:"app.control.ddftree.createcs.dsquickaction"})),getasample:r.createElement(y.a,{onClick:function(){u.handleGetASampleDemo()}},r.createElement(v.a,{id:"app.control.ddftree.createcs.sampledoc"}))}})));var k=!this.props.hidden&&((null===(a=this.state.filter)||void 0===a?void 0:a.enable)||(null===(i=this.state.filter)||void 0===i?void 0:i.expression));return r.createElement(r.Fragment,null,k&&r.createElement(ye.a,{placeholder:"",value:null===(s=this.state.filter)||void 0===s?void 0:s.expression,onSearch:function(e){u.handleQuickSearch(e)},onClear:function(){u.handleClearSearch()},underlined:!0}),r.createElement("ul",{className:"domtree",hidden:this.props.hidden},r.createElement("li",null,r.createElement(ne.a,{className:"treenode-normal",iconProps:this.state[d.id].expanded?S.collapseTreeIcon:S.expandTreeIcon,onClick:function(){return u.toggleChildren(d.id)}}),r.createElement(w.a,{iconProps:S.btnDocumentIcon,className:this.props.selected&&this.props.selected.documentId===d.id?"treenode-selected":"treenode-normal",title:d.text,ariaLabel:d.text,onClick:function(){return u.onNodeSelected(d)}},r.createElement("span",{className:"treenodetext"},d.text)),!(null!==(c=this.state.filter)&&void 0!==c&&c.enable)&&r.createElement(ne.a,{className:"treenode-normal",styles:g,iconProps:S.filterSettingIcon,onClick:function(){return u.enableFilterBox(!0)}}),r.createElement(ve,{key:d.id,filter:null===(l=this.state.filter)||void 0===l?void 0:l.expression,nodes:d,nodeState:this.state[d.id],selected:this.props.selected,handleUserCommand:function(e){return u.props.handleUserCommand(e)}}))))}}]),n}(r.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DDFTree.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DDFTree.js")}}();var De=n(644),xe=n(704),Ee=n(94),we=n(184),Se=n.n(we),Ie=n(705),Oe=n(14);function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var Pe=function(e){u()(n,e);var t=Fe(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={userinfo:null},r}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"signInUser",value:function(){var e=ae.a.newInstance().createSiginUserCommand();this.props.handleUserCommand&&this.props.handleUserCommand(e)}},{key:"signUpUser",value:function(){var e=ae.a.newInstance().createSigupUserCommand();this.props.handleUserCommand&&this.props.handleUserCommand(e)}},{key:"signOutUser",value:function(){var e=ae.a.newInstance().createSignoutUserCommand();this.props.handleUserCommand&&this.props.handleUserCommand(e)}},{key:"getServiceLevel",value:function(){switch(this.props.principal.userServiceLevel){case 0:return r.createElement(F.a,{content:this.props.intl.formatMessage({id:"app.account.license.traildesc"}),id:Date.now()},r.createElement(x.a,null,this.props.intl.formatMessage({id:"app.account.license.trail"}),r.createElement(k.a,{iconName:S.statusWarningIcon.iconName,className:"iconwarning"})));case 1:return r.createElement(x.a,null,this.props.intl.formatMessage({id:"app.account.license.subscribe"}),r.createElement(k.a,{iconName:S.statusCorrectIcon.iconName,className:"iconsuccess"}));case 2:return r.createElement(x.a,null,this.props.intl.formatMessage({id:"app.account.license.esubscribe"}),r.createElement(k.a,{iconName:S.statusCorrectIcon.iconName,className:"iconsuccess"}));case 3:return r.createElement(x.a,null,this.props.intl.formatMessage({id:"app.account.license.onpromise"}),r.createElement(k.a,{iconName:S.statusCorrectIcon.iconName,className:"iconsuccess"}));default:return r.createElement(F.a,{content:this.props.intl.formatMessage({id:"app.account.license.invaliddesc"}),id:Date.now()},r.createElement(x.a,null,this.props.intl.formatMessage({id:"app.account.license.invalid"}),r.createElement(k.a,{iconName:S.statusErrorIcon.iconName,className:"iconfailed"})))}}},{key:"onOptionalTextRender",value:function(e){var t=this;return r.createElement("div",null,r.createElement("div",null,r.createElement(F.a,{content:e.secondaryText,id:Date.now()},r.createElement(x.a,null,e.secondaryText))),r.createElement("div",null,r.createElement(w.a,{iconProps:S.signoutIcon,className:"personaldesc",onClick:function(){return t.signOutUser()}},this.props.intl.formatMessage({id:"app.account.link.logout"}))))}},{key:"onOpenSubscribe",value:function(){Object(I.F)(S.URL_SHOW_PRICE_LIST)}},{key:"render",value:function(){var e,t=this;return null!==(e=this.props.principal)&&void 0!==e&&e.userName?r.createElement(r.Fragment,null,r.createElement("h3",null,this.props.intl.formatMessage({id:"app.account.subtitle.userinfo"})),r.createElement("div",{className:"sectionbody"},r.createElement(Ie.a,{secondaryText:this.props.principal.userEmail,text:this.props.principal.userName,onRenderSecondaryText:function(e){return t.onOptionalTextRender(e)},size:Oe.c.size48,initialsColor:Oe.a.purple})),r.createElement("h3",null,this.props.intl.formatMessage({id:"app.account.subtitle.license"})),r.createElement("div",{className:"sectionbody"},r.createElement(D.a,{verticalAlign:!0,tokens:S.buttonGroupStackTokens},r.createElement(D.a.Item,{styles:S.runtimeInfoLabelStyles},this.getServiceLevel()),r.createElement(D.a.Item,{styles:S.runtimeInfoValueStyles,grow:2},r.createElement(y.a,{className:"blocklink",onClick:function(){return t.onOpenSubscribe()}},this.props.intl.formatMessage({id:"app.account.link.getsubscription"}),r.createElement(k.a,{iconName:S.subscribeIcon.iconName,className:"inlineicon"})))))):r.createElement(r.Fragment,null,r.createElement("h3",null,this.props.intl.formatMessage({id:"app.account.subtitle.signin"})),r.createElement("div",{className:"checkresult"},this.props.intl.formatMessage({id:"app.account.subtitle.warning"},{signin:r.createElement(y.a,{onClick:function(){return t.signInUser()}},r.createElement(k.a,{iconName:S.signinIcon.iconName,className:"inlineicon"}),this.props.intl.formatMessage({id:"app.account.link.signin"})),signup:r.createElement(y.a,{onClick:function(){return t.signUpUser()}},r.createElement(k.a,{iconName:S.signupIcon.iconName,className:"inlineicon"}),this.props.intl.formatMessage({id:"app.account.link.signup"}))})))}}]),n}(r.Component),Te=Object(h.c)(Pe);function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\account\\signin.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\account\\signin.js")}}();var je=function(e){u()(n,e);var t=Me(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={loading:!0},r}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"getLanguageCode",value:function(){var e=Object(I.E)();return e=e.split(/[-_]/)[0].toLowerCase()}},{key:"handleCookiePolicy",value:function(){"zh"===this.getLanguageCode()||"cn"===this.getLanguageCode()?Object(I.F)(S.URL_PRIVACY_COOKIE_CN):Object(I.F)(S.URL_PRIVACY_COOKIE_EN)}},{key:"handleULA",value:function(){"zh"===this.getLanguageCode()||"cn"===this.getLanguageCode()?Object(I.F)(S.URL_PRIVACY_ULA_CN):Object(I.F)(S.URL_PRIVACY_ULA_EN)}},{key:"handleThirdpartyNotice",value:function(){Object(I.F)(S.URL_THIRD_PARTY_URL)}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement("div",{className:"pagesection"},r.createElement(Te,{principal:this.props.principal,handleUserCommand:this.props.handleUserCommand})),r.createElement("div",{className:"pagesection"},r.createElement("h3",null,this.props.intl.formatMessage({id:"app.account.subtitle.product"})),r.createElement("ul",{className:"sectionbody"},r.createElement("li",null,this.props.intl.formatMessage({id:"app.account.product.appliedto"}),r.createElement(k.a,{className:"inlinetxtvalue",iconName:"wordbrand-svg"})),r.createElement("li",null,this.props.intl.formatMessage({id:"app.account.product.version"}),r.createElement("span",{className:"inlinetxtvalue"},"1.0.0.10")))),r.createElement("div",{className:"pagesection"},r.createElement("h3",null,this.props.intl.formatMessage({id:"app.account.subtitle.privacy"})),r.createElement("div",{className:"sectionbody"},r.createElement(y.a,{className:"blocklink",onClick:function(){return e.handleULA()}},this.props.intl.formatMessage({id:"app.account.link.ula"})),r.createElement(y.a,{className:"blocklink",onClick:function(){return e.handleCookiePolicy()}},this.props.intl.formatMessage({id:"app.account.link.cookie"})),r.createElement(y.a,{className:"blocklink",onClick:function(){return e.handleThirdpartyNotice()}},this.props.intl.formatMessage({id:"app.account.link.thirdparty"})))),r.createElement("div",{className:"accountfooter"},r.createElement(N,null)))}}]),n}(r.Component),Re=Object(h.c)(je);function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\account\\index.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\account\\index.js")}}();var Le=function(e){u()(n,e);var t=Ne(n);function n(e){var r;return i()(this,n),r=t.call(this,e),V()(H()(r),"saveDocument",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r.props.handleUserCommand){e.next=4;break}return t=CommandArgumentFactory.newInstance().createSaveDocumentCommand(),e.next=4,r.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(r),"showDebugDDF",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createShowDebugDDFInfo(),e.next=4,r.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(r),"openPreviewForm",(function(e){var t=e===Se.a.Word?ae.a.newInstance().createPreviewAsWordDocumentCommand():ae.a.newInstance().createPreviewAsPDFDocumentCommand();r.props.handleUserCommand(t)})),V()(H()(r),"toggleDataView",function(){var e=_()(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.props.setDocumentViewMode(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),V()(H()(r),"toggleToolsView",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.props.setDocumentViewMode&&(t=ke.a.ToolBox,r.props.documentViewMode===ke.a.ToolBox?t=r.state.lastViewMode:r.setState({lastViewMode:r.props.documentViewMode}),r.props.setDocumentViewMode(t));case 1:case"end":return e.stop()}}),e)})))),V()(H()(r),"handleToggleFullScreen",(function(){r.props.onToggleFullScreen&&(r.props.propertyGridSize.fullSize?r.props.onToggleFullScreen(r.props.propertyGridSize.lastSize,!1):r.props.onToggleFullScreen(S.PROPERTY_GRID_ZERO_SIZE,!0))})),V()(H()(r),"handleContactSupport",(function(){var e=ae.a.newInstance().createContactSupportCommand();r.props.handleUserCommand&&r.props.handleUserCommand(e)})),V()(H()(r),"handleGotoHelp",(function(){var e=ae.a.newInstance().createGotoHelpCommand();r.props.handleUserCommand&&r.props.handleUserCommand(e)})),V()(H()(r),"handleRequestDemo",(function(){var e=ae.a.newInstance().createBookDemoCommand();r.props.handleUserCommand&&r.props.handleUserCommand(e)})),V()(H()(r),"handleShowPriceList",(function(){var e=ae.a.newInstance().createShowPriceListCommand();r.props.handleUserCommand&&r.props.handleUserCommand(e)})),V()(H()(r),"getResizeIcon",(function(){return r.props.propertyGridSize.fullSize?S.btnFullScreen:S.btnSmallScreen})),r.state={lastViewMode:ke.a.ContentStructure,openAccountPanel:!1},r}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"closeAccountPanel",value:function(){this.setState({openAccountPanel:!1})}},{key:"openAccountPanel",value:function(){this.setState({openAccountPanel:!0})}},{key:"getLanguageCode",value:function(){var e=Object(I.E)();return e=e.split(/[-_]/)[0].toLowerCase()}},{key:"handleGettingStarted",value:function(){"zh"===this.getLanguageCode()||"cn"===this.getLanguageCode()?Object(I.F)(S.URL_GETTING_START_CN):Object(I.F)(S.URL_GETTING_START_EN)}},{key:"render",value:function(){var e=this,t={ariaLabel:this.props.intl.formatMessage({id:"action.morecommand"})},n=[{key:"mnuInsert",iconOnly:!0,text:this.props.documentViewMode===ke.a.ToolBox?this.props.intl.formatMessage({id:"action.returnback"}):this.props.intl.formatMessage({id:"action.toolbox"}),cacheKey:"mnuInsertCacheKey",iconProps:this.props.documentViewMode===ke.a.ToolBox?S.navibackIcon:S.toolboxIcon,onClick:function(){e.toggleToolsView()}}],o=[{key:"btnContentView",text:this.props.intl.formatMessage({id:"action.ShowContent"}),ariaLabel:this.props.intl.formatMessage({id:"app.commandbar.view.document"}),className:this.props.documentViewMode===ke.a.ContentStructure?"toolbaractive":"",iconOnly:!0,iconProps:S.btnShowContent,onClick:function(){e.toggleDataView(ke.a.ContentStructure)}},{key:"btnDataView",text:this.props.intl.formatMessage({id:"action.ShowData"}),className:this.props.documentViewMode===ke.a.DocumentData?"toolbaractive":"",iconOnly:!0,ariaLabel:this.props.intl.formatMessage({id:"app.commandbar.view.data"}),iconProps:S.dataManagementIcon,onClick:function(){e.toggleDataView(ke.a.DocumentData)}},{key:"btnPreviewDocument",iconOnly:!0,iconProps:S.previewPDFIcon,ariaLabel:this.props.intl.formatMessage({id:"action.PreviewDocument"}),subMenuProps:{items:[{key:"btnPreviewWord",text:this.props.intl.formatMessage({id:"action.PreviewAsWord"}),ariaLabel:this.props.intl.formatMessage({id:"action.PreviewAsWord"}),iconOnly:!0,iconProps:S.previewWordIcon,onClick:function(){e.openPreviewForm(Se.a.Word)}},{key:"btnPreviewPDF",text:this.props.intl.formatMessage({id:"action.PreviewAsPDF"}),ariaLabel:this.props.intl.formatMessage({id:"action.PreviewAsPDF"}),iconOnly:!0,iconProps:S.previewPDFIcon,onClick:function(){e.openPreviewForm(Se.a.PDF)}}]}},{key:"btnAppSettings",iconOnly:!0,iconProps:S.settingsIcon,subMenuProps:{items:[{key:"btnAbout",text:this.props.intl.formatMessage({id:"action.showAbout"}),iconProps:S.infoIcon,onClick:function(){e.openAccountPanel()}},{key:"btnPrice",text:this.props.intl.formatMessage({id:"action.showPrice"}),iconProps:S.priceIcon,onClick:function(){e.handleShowPriceList()}},{key:"btnSupport",text:this.props.intl.formatMessage({id:"action.contactSupport"}),iconProps:S.supportIcon,onClick:function(){e.handleContactSupport()}},{key:"btnRequestDemo",text:this.props.intl.formatMessage({id:"action.requestDemo"}),iconProps:S.contactIcon,onClick:function(){e.handleRequestDemo()}},{key:"btnGettingStarted",text:this.props.intl.formatMessage({id:"app.page.land.btn.gettingstarted"}),iconProps:S.quickStartIcon,onClick:function(){e.handleGettingStarted()}},{key:"btnHelp",text:this.props.intl.formatMessage({id:"action.showHelp"}),iconProps:S.helpIcon,onClick:function(){e.handleGotoHelp()}}]}},{key:"btnFullScreen",text:this.props.propertyGridSize.fullSize?this.props.intl.formatMessage({id:"action.screen.reset"}):this.props.intl.formatMessage({id:"action.screen.full"}),iconOnly:!0,iconProps:this.props.propertyGridSize.fullSize?S.btnSmallScreen:S.btnFullScreen,onClick:function(){e.handleToggleFullScreen()}}];this.props.autoSave||o.splice(0,0,{key:"btnSaveDocument",text:this.props.intl.formatMessage({id:"action.SaveDocument"}),ariaLabel:this.props.intl.formatMessage({id:"action.SaveDocument"}),iconOnly:!0,iconProps:{iconName:"SaveAll"},onClick:function(){e.saveDocument()}});return r.createElement("div",{className:"properties-bar"},r.createElement(De.a,{items:n,overflowItems:[],overflowButtonProps:t,styles:{root:{padding:"0px 14px 0 0"}},farItems:o,ariaLabel:this.props.intl.formatMessage({id:"app.commandbar.leftToRight"})}),r.createElement(xe.a,{isOpen:this.state.openAccountPanel,onDismiss:function(){return e.closeAccountPanel()},type:Ee.a.smallFluid,closeButtonAriaLabel:"Close",headerText:this.props.intl.formatMessage({id:"app.account.title"})},r.createElement(Re,{principal:this.props.principal,handleUserCommand:this.props.handleUserCommand})))}}]),n}(r.Component),Be=Object(h.c)(Le);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\YDocCommandBar.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\YDocCommandBar.js")}}();var Ue=n(439),Ae=n(67),_e=n.n(Ae);function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var He={root:{height:32,width:48}},We=function(e){u()(n,e);var t=Ge(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"handleUpdateDataBind",value:function(e,t,n){if(this.props.property&&this.props.property[e]!==t){var r=_e.a.newInstance().createBasicNode(this.props.property.elementId,this.props.property.elementType);r[e]=t;var o=ae.a.newInstance().createUpdateDDFNodePropertyCommand(r);this.props.handleUserCommand(o)}}},{key:"getShortBindName",value:function(e){var t=e?e.split("."):[];return t.length>0?t[t.length-1]:e}},{key:"openDataBindEditor",value:function(e){this.props.onDataBind&&this.props.onDataBind(e)}},{key:"handleBlur",value:function(e){this.handleUpdateDataBind(this.props.fieldName,e,null)}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&handleBlur(e.target.value)}},{key:"render",value:function(){var e=this;return r.createElement(D.a,{key:this.props.property.elementId,tokens:S.propertyStackTokens,horizontal:!0,display:null!=this.props.property[this.props.fieldName]},r.createElement(D.a.Item,{styles:S.propertyLableFieldStyles,disableShrink:!0},r.createElement(v.a,{id:this.props.fieldName})),r.createElement(D.a.Item,{styles:S.propertyValueFieldStyles,grow:2},r.createElement(D.a.Item,{align:"start",styles:S.dataBindValueStyles,grow:2},r.createElement(Ue.a,{key:"bindtext_"+this.props.fieldName+this.props.fieldValue,defaultValue:this.props.fieldValue,borderless:!0,onKeyPress:function(t){return e.handleKeyPress(t)},onBlur:function(t){return e.handleBlur(t.target.value)}})),r.createElement(D.a.Item,{align:"end",styles:He,disableShrink:!0},r.createElement(ne.a,{iconProps:S.dataBindFieldIcon,onClick:function(){e.props.onDataBind(e.props.fieldName,e)}}))))}}]),n}(r.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DataBindEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DataBindEditorField.js")}}();Object(h.c)((function(e){return r.createElement(Ue.a,{styles:S.editorLabelStyles,label:e.intl.formatMessage({id:e.fieldName}),defaultValue:e.fieldValue,readOnly:!0,underlined:!0,iconProps:S.readonlyFieldIcon})}));!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ReadonlyPropertiesField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ReadonlyPropertiesField.js")}}();var Ve=Object(h.c)((function(e){function t(t){if(e.handleUserCommand&&e.fieldValue!==t){var n=_e.a.newInstance().createBasicNode(e.elementId,e.elementType);n[e.fieldName]=t;var r=ae.a.newInstance().createUpdateDDFNodePropertyCommand(n);e.handleUserCommand(r)}}return r.createElement(D.a,{key:e.fieldName+"_"+e.fieldValue,tokens:S.propertyStackTokens,horizontal:!0},r.createElement(D.a.Item,{styles:S.propertyLableFieldStyles,disableShrink:!0},e.intl.formatMessage({id:e.fieldName})),r.createElement(D.a.Item,{styles:S.propertyValueFieldStyles,grow:2},r.createElement(Ue.a,{styles:S.autoFillTextBoxStyle,defaultValue:e.fieldValue,onKeyPress:function(e){var n;"Enter"===(n=e).key&&t(n.target.value)},borderless:!0,onBlur:function(e){return t(e.target.value)}})))}));function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\SimpleTextEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\SimpleTextEditorField.js")}}();var Ye=function(e){u()(n,e);var t=ze(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"handleBlur",value:function(e){if(this.props.handleUserCommand&&this.props.fieldValue!==e){var t=_e.a.newInstance().createBasicNode(this.props.elementId,this.props.elementType);t[this.props.fieldName]=e;var n=ae.a.newInstance().createEditDynamicControlNameCommand(t);this.props.handleUserCommand(n)}}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&this.handleBlur(e.target.value)}},{key:"render",value:function(){var e=this,t=this.props.intl;return r.createElement(Ue.a,{styles:S.editorLabelStyles,label:t.formatMessage({id:this.props.fieldName}),defaultValue:this.props.fieldValue,underlined:!0,onKeyPress:function(t){return e.handleKeyPress(t)},onBlur:function(t){return e.handleBlur(t.target.value)}})}}]),n}(r.Component);Object(h.c)(Ye);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ControlNameEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ControlNameEditorField.js")}}();var qe=n(708),Ke=n(7);var Qe=Object(h.c)((function(e){var t={root:{alignItems:"center",background:Ke.DefaultPalette.neutralLighter,display:"flex",height:32,borderBottom:"gray solid 1px",justifyContent:"left",padding:"0 0 0 12px",fontWeight:"600",overflow:"hidden",width:138}};return r.createElement(D.a,{tokens:{childrenGap:0},horizontal:!0},r.createElement(D.a.Item,{styles:t},e.intl.formatMessage({id:e.fieldName})),r.createElement(D.a.Item,{styles:{root:{alignItems:"center",display:"flex",height:32,justifyContent:"left",padding:"0 0 0 12px",borderBottom:"gray solid 1px"}},grow:2},r.createElement(qe.a,{inlineLabel:!0,onText:"On",offText:"Off"})))}));!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\BooleanValueEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\BooleanValueEditorField.js")}}();var Je=n(76),Ze=n.n(Je),Xe=n(248),$e=n(458),et=n(328),tt=n(118),nt=n(703);function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var ot=function(e){u()(n,e);var t=rt(n);function n(e){var o;return i()(this,n),o=t.call(this,e),V()(H()(o),"onRenderOption",(function(e){return r.createElement("div",{className:"dropdowneditor"},e.data&&e.data.icon&&r.createElement(tt.a,{style:{marginRight:"8px"},iconName:e.data.icon,"aria-hidden":"true",title:e.data.icon}),r.createElement("span",null,e.text))})),o}return c()(n,[{key:"handleOnChange",value:function(e){this.props.onChange&&this.props.fieldValue!==e&&this.props.onChange(e)}},{key:"render",value:function(){var e,t=this,n=this.props.useFormLabelStyle?{root:{alignItems:"center",display:"flex",height:32,borderBottom:"gray solid 1px",justifyContent:"center",padding:"0 0 0 12px",overflow:"hidden",width:138}}:S.propertyLableFieldStyles;return r.createElement(D.a,{tokens:S.propertyStackTokens,horizontal:!0},r.createElement(D.a.Item,{styles:n,disableShrink:!0},r.createElement(v.a,{id:this.props.fieldName})),r.createElement(D.a.Item,{styles:S.propertyValueFieldStyles,grow:2},r.createElement(nt.a,{key:this.props.fieldName,responsiveMode:null!==(e=this.props.responsiveMode)&&void 0!==e?e:"",placeholder:this.props.placeholder,onRenderOption:this.onRenderOption,styles:{title:{border:"none",minWidth:150}},options:this.props.options,selectedKey:this.props.fieldValue,onChange:function(e,n){return t.handleOnChange(n.key)},disabled:!!this.props.disabled})))}}]),n}(r.Component);function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DropdownEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DropdownEditorField.js")}}();var it=function(e){u()(a,e);var t,n,o=at(a);function a(e){var t;return i()(this,a),(t=o.call(this,e)).state={editing:!1,series:[],category:""},t}return c()(a,[{key:"extractChartSeries",value:(n=_()(Y.a.mark((function e(){var t,n,r,o,a,i,s,c,l,u,p,d,f,m;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.A)(this.props.property.elementId);case 2:if(t=e.sent,n=[],!t){e.next=29;break}if(r=new et.a(t),!((o=r.getElementsByTagName("c:tx"))&&o.length>0)){e.next=29;break}a=0;case 9:if(!(a<o.length)){e.next=29;break}if(c=o[a],(l=null==c?void 0:c.getElementsByTagName("c:strRef"))&&0!==l.length){e.next=14;break}return e.abrupt("continue",26);case 14:if((u=null===(i=l[0])||void 0===i?void 0:i.getElementsByTagName("c:strCache"))&&0!==u.length){e.next=17;break}return e.abrupt("continue",26);case 17:if((p=null===(s=u[0])||void 0===s?void 0:s.getElementsByTagName("c:pt"))&&0!==p.length){e.next=20;break}return e.abrupt("continue",26);case 20:if((d=p[0].getElementsByTagName("c:v"))&&0!==d.length){e.next=23;break}return e.abrupt("continue",26);case 23:f=d[0].innerHTML,m=_e.a.newInstance().createDDFChartSerialNode(f),n.push(m);case 26:a++,e.next=9;break;case 29:return e.abrupt("return",n);case 30:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setEditing",value:(t=_()(Y.a.mark((function e(t){var n,r,o,a,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],r="",!t){e.next=8;break}return e.next=5,this.extractChartSeries();case 5:n=e.sent,this.mapChartSeries(n),r=null!==(o=null===(a=this.props.property)||void 0===a||null===(i=a.chartDataMapping)||void 0===i?void 0:i.category)&&void 0!==o?o:"";case 8:this.props.onToggleFullScreen&&this.props.onToggleFullScreen(t),this.setState({editing:t,series:n,category:r});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"handleUpdateSeriesDataBind",value:function(e,t){for(var n=te()(this.state.series),r=0;r<n.length;r++){var o=n[r];if(o.serialName===e){o.dataBind=t;break}}this.setState({series:n,editing:!0})}},{key:"handleUpdateCategoryDataBind",value:function(e){this.setState({category:e,editing:!0})}},{key:"handleApply",value:function(){if(this.props.handleUserCommand){var e=_e.a.newInstance().createBasicNode(this.props.property.elementId,this.props.property.elementType),t={series:te()(this.state.series),category:this.state.category};e.chartDataMapping=t;var n=ae.a.newInstance().createUpdateDDFNodePropertyCommand(e);this.props.handleUserCommand(n)}this.setEditing(!1)}},{key:"findStoredSerial",value:function(e){for(var t=this.props.property.chartDataMapping.series,n=0;t&&n<t.length;n++)if(t[n].serialName===e)return t[n];return null}},{key:"mapChartSeries",value:function(e){for(var t=0;e&&t<e.length;t++){var n=e[t],r=this.findStoredSerial(n.serialName);r&&(n.dataBind=r.dataBind)}}},{key:"createBindPropertiesDropdownOptions",value:function(){var e,t=null===(e=this.props.dataSource)||void 0===e?void 0:e.dataContent,n=Object($e.a)({path:this.props.property.dataBind,json:t}),o=[{key:"Header",text:r.createElement(v.a,{id:"app.control.field.head.bindproperties"}),itemType:Xe.a.Header}];if(n&&n.length>0&&"object"===Ze()(n[0]))for(var a=n[0],i=Object.keys(a),s=0;s<i.length;s++){var c=i[s];Array.isArray(a[c])||o.push({key:c,text:c,data:{icon:"Variable"}})}return o}},{key:"generateObjectPropertyMappingEditor",value:function(e,t,n,o,a){var i=this,s=o?function(e){return i.handleUpdateCategoryDataBind(e)}:function(e){return i.handleUpdateSeriesDataBind(t,e)},c=!(a&&a.length>1);return r.createElement(ot,{key:e,placeholder:r.createElement(v.a,{id:"app.control.field.selectChartDataMapping"}),options:a,fieldValue:n,fieldName:t,onChange:s,disabled:c,useFormLabelStyle:!0})}},{key:"generateSeriesBindForm",value:function(){var e=this;if(!this.state.editing)return null;var t=this.createBindPropertiesDropdownOptions(),n=this.state.series.map((function(n,r){return e.generateObjectPropertyMappingEditor(r,n.serialName,n.dataBind,!1,t)})),o=this.generateObjectPropertyMappingEditor("chart_category_field","app.control.field.category",this.state.category,!0,t);return r.createElement(r.Fragment,null,n,o,r.createElement(D.a,{tokens:S.propertyButtonStackTokens,horizontal:!0},r.createElement(D.a.Item,{styles:S.bindFormButtonsStyles,disableShrink:!0},r.createElement(w.a,{iconProps:S.confirmIcon,onClick:function(){return e.handleApply()}},r.createElement(x.a,{style:S.bindFormButtonFontStyles},r.createElement(v.a,{id:"action.Apply"}))),r.createElement(w.a,{iconProps:S.cancelIcon,onClick:function(){return e.setEditing(!1)}},r.createElement(x.a,{style:S.bindFormButtonFontStyles},r.createElement(v.a,{id:"action.Cancel"}))))))}},{key:"render",value:function(){var e,t=this;return r.createElement(r.Fragment,null,r.createElement(D.a,{tokens:S.propertyStackTokens,horizontal:!0},r.createElement(D.a.Item,{styles:S.propertyLableFieldStyles,disableShrink:!0},r.createElement(v.a,{id:this.props.fieldName})),r.createElement(D.a.Item,{styles:S.propertyValueFieldStyles,grow:2},!this.state.editing&&r.createElement(ne.a,{iconProps:S.chartEditIcon,onClick:function(){t.setEditing(!0)},disabled:void 0===(null===(e=this.props.property)||void 0===e?void 0:e.dataBind)||""===this.props.property.dataBind}))),this.generateSeriesBindForm())}}]),a}(r.Component);function st(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ChartDataMappingEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ChartDataMappingEditorField.js")}}();var ct=function(e){u()(n,e);var t=st(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"hanldeExpressionEditing",value:function(){if(this.props.handleUserCommand){var e=ae.a.newInstance().createEditExpressionCommand(this.props.property);this.props.handleUserCommand(e)}}},{key:"render",value:function(){var e,t,n=this,o=this.props.intl;return r.createElement(D.a,{tokens:S.propertyStackTokens,horizontal:!0,display:null!=this.props.property.expression},r.createElement(D.a.Item,{styles:S.propertyLableFieldStyles,disableShrink:!0},o.formatMessage({id:this.props.fieldName})),r.createElement(D.a.Item,{styles:S.propertyValueFieldStyles,grow:2},r.createElement(D.a.Item,{align:"start",styles:S.dataBindValueStyles,grow:2},r.createElement(F.a,{content:null===(e=this.props.property)||void 0===e||null===(t=e.expression)||void 0===t?void 0:t.value,id:this.props.property.elementId,calloutProps:{gapSpace:0},styles:{root:{display:"inline-block"}}},r.createElement(ne.a,{iconProps:S.varIcon,onClick:function(){n.hanldeExpressionEditing()}})))))}}]),n}(r.Component),lt=Object(h.c)(ct);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ExpressionEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ExpressionEditorField.js")}}();var ut=Object(h.c)((function(e){function t(t){var n=t;(function(t){return!!t&&(e.unit&&e.unit.length>0&&t.indexOf(e.unit)>=0)})(n)&&(n=n.substr(0,n.indexOf(e.unit)).trim());try{return Number(n.trim())}catch(e){}return 0}function n(n){var r=t(n);if(e.handleUserCommand&&e.fieldValue!==r){var o=_e.a.newInstance().createBasicNode(e.elementId,e.elementType);o[e.fieldName]=r;var a=ae.a.newInstance().createUpdateDDFNodePropertyCommand(o);e.handleUserCommand(a)}}return r.createElement(D.a,{key:e.fieldName+"_"+e.fieldValue,tokens:S.propertyStackTokens,horizontal:!0},r.createElement(D.a.Item,{styles:S.propertyLableFieldStyles,disableShrink:!0},e.intl.formatMessage({id:e.fieldName})),r.createElement(D.a.Item,{styles:S.propertyValueFieldStyles,grow:2},r.createElement(Ue.a,{styles:S.autoFillTextBoxStyle,defaultValue:String(e.fieldValue),suffix:e.unit,onKeyPress:function(e){var t;"Enter"===(t=e).key&&n(t.target.value)},onBlur:function(e){return n(e.target.value)},borderless:!0})))}));!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\SimpleNumberEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\SimpleNumberEditorField.js")}}();var pt=n(50);function dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var ft=function(e){u()(n,e);var t=dt(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"handleUpdateCompositeProperty",value:function(e){var t=this.props.fieldName;if(e&&e.node){for(var n=Object.assign({},e.node),r=Object.assign({},this.props.fieldValue),o=Object.keys(r),a=0;a<o.length;a++){var i=o[a];n[i]&&n[i]!==r[i]&&(r[i]=n[i])}e.node=V()({elementId:n.elementId,elementType:n.elementType},t,r),this.props.handleUserCommand&&this.props.handleUserCommand(e)}}},{key:"handleUpdateFieldValue",value:function(e,t){if(this.props.handleUserCommand&&this.props.fieldValue[e]!==t){var n=_e.a.newInstance().createBasicNode(this.props.elementId,this.props.elementType),r=Object.assign({},this.props.fieldValue);r[e]=t,n[this.props.fieldName]=r;var o=ae.a.newInstance().createUpdateDDFNodePropertyCommand(n);this.props.handleUserCommand(o)}}},{key:"buildDropdownOptions",value:function(e){var t=[];return e===fe.a.barcodeQRECLevelField&&(t.push({key:"Header",text:this.props.intl.formatMessage({id:"app.control.field.head.qreclevel"}),itemType:Xe.a.Header}),t.push({key:pt.QRECLevel.Low,text:this.props.intl.formatMessage({id:"app.control.field.optqrlevel.low"}),data:{icon:"FavoriteList"}}),t.push({key:pt.QRECLevel.Middle,text:this.props.intl.formatMessage({id:"app.control.field.optqrlevel.middle"}),data:{icon:"FavoriteList"}}),t.push({key:pt.QRECLevel.MiddleHigh,text:this.props.intl.formatMessage({id:"app.control.field.optqrlevel.middlehigh"}),data:{icon:"FavoriteList"}}),t.push({key:pt.QRECLevel.High,text:this.props.intl.formatMessage({id:"app.control.field.optqrlevel.high"}),data:{icon:"FavoriteList"}})),e===fe.a.humanReadablePositionField&&(t.push({key:"Header",text:this.props.intl.formatMessage({id:"app.control.field.head.hreadable"}),itemType:Xe.a.Header}),t.push({key:pt.HumanReadablePosition.None,text:this.props.intl.formatMessage({id:"app.control.field.hreadable.none"}),data:{icon:"FavoriteList"}}),t.push({key:pt.HumanReadablePosition.Bottom,text:this.props.intl.formatMessage({id:"app.control.field.hreadable.bottom"}),data:{icon:"FavoriteList"}}),t.push({key:pt.HumanReadablePosition.Top,text:this.props.intl.formatMessage({id:"app.control.field.hreadable.top"}),data:{icon:"FavoriteList"}})),t}},{key:"getNumberFieldUnit",value:function(e){return e===fe.a.barcodeHeightField||e===fe.a.barcodeModuleWidthField?"mm":e===fe.a.barcodeQRVersionField?"(1-40)":e===fe.a.barcodePDF417ECLevelField?"(0-8)":e===fe.a.barcodeColumnsField?"(1-30)":void 0}},{key:"getDWPlaceHolderMessageId",value:function(e){return e===fe.a.barcodeQRECLevelField?"app.control.field.qreclevel":"app.control.field.selecthreadable"}},{key:"renderFieldEditor",value:function(e,t){var n=this;switch(e){case fe.a.barcodeQRECLevelField:case fe.a.humanReadablePositionField:var o=this.buildDropdownOptions(e),a=this.getDWPlaceHolderMessageId(e);return r.createElement(ot,{key:this.props.elementId+"_"+e,responsiveMode:"large",placeholder:this.props.intl.formatMessage({id:a}),fieldName:e,fieldValue:this.props.fieldValue[e],options:o,onChange:function(t){return n.handleUpdateFieldValue(e,t)}});case fe.a.barcodeHeightField:case fe.a.barcodeModuleWidthField:case fe.a.barcodeQRVersionField:case fe.a.barcodePDF417ECLevelField:case fe.a.barcodeColumnsField:var i=this.getNumberFieldUnit(e);return r.createElement(ut,{key:this.props.elementId+"_"+e,elementId:this.props.elementId,fieldName:e,fieldValue:this.props.fieldValue[e],elementType:this.props.elementType,unit:i,handleUserCommand:function(e){return n.handleUpdateCompositeProperty(e)}})}}},{key:"render",value:function(){var e=this;if(!this.props.fieldValue)return null;var t=Object.keys(this.props.fieldValue).map((function(t,n){return e.renderFieldEditor(t,n)}));return r.createElement(r.Fragment,null,t)}}]),n}(r.Component),mt=Object(h.c)(ft);function ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\CompositeVNodeEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\CompositeVNodeEditorField.js")}}();var vt=function(e){u()(n,e);var t=ht(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={editing:!1,optionSettings:{}},r}return c()(n,[{key:"setEditing",value:function(e){var t;this.props.onToggleFullScreen&&this.props.onToggleFullScreen(e);var n=Object.assign({},null===(t=this.props.property)||void 0===t?void 0:t.dropdownOption);this.setState({editing:e,optionSettings:n})}},{key:"handleUpdatePropertyDataBind",value:function(e,t){var n=Object.assign({},this.state.optionSettings);n[e]=t,this.setState({editing:!0,optionSettings:n})}},{key:"handleApply",value:function(){if(this.props.handleUserCommand){var e,t,n,r,o=_e.a.newInstance().createBasicNode(this.props.property.elementId,this.props.property.elementType),a={displayTextBindField:null!==(e=null===(t=this.state.optionSettings)||void 0===t?void 0:t.displayTextBindField)&&void 0!==e?e:"",valueBindField:null!==(n=null===(r=this.state.optionSettings)||void 0===r?void 0:r.valueBindField)&&void 0!==n?n:""};o.dropdownOption=a;var i=ae.a.newInstance().createUpdateDDFNodePropertyCommand(o);this.props.handleUserCommand(i)}this.setEditing(!1)}},{key:"createBindPropertiesDropdownOptions",value:function(){var e,t=null===(e=this.props.dataSource)||void 0===e?void 0:e.dataContent,n=Object($e.a)({path:this.props.property.dataBind,json:t}),o=[{key:"Header",text:r.createElement(v.a,{id:"app.control.field.head.bindproperties"}),itemType:Xe.a.Header}];if(n&&n.length>0&&"object"===Ze()(n[0]))for(var a=n[0],i=Object.keys(a),s=0;s<i.length;s++){var c=i[s];Array.isArray(a[c])||o.push({key:c,text:c,data:{icon:"Variable"}})}return o}},{key:"generateObjectPropertyMappingEditor",value:function(e,t,n,o){var a=this,i=!(n&&n.length>1);return r.createElement(ot,{key:e+"_"+t,placeholder:o,options:n,fieldValue:t,fieldName:e,onChange:function(t){return a.handleUpdatePropertyDataBind(e,t)},disabled:i,useFormLabelStyle:!0})}},{key:"generateOptionSettingsBindForm",value:function(){var e,t,n,o,a=this;if(!this.state.editing)return null;var i=this.createBindPropertiesDropdownOptions(),s=this.generateObjectPropertyMappingEditor("displayTextBindField",null!==(e=null===(t=this.state.optionSettings)||void 0===t?void 0:t.displayTextBindField)&&void 0!==e?e:"",i,r.createElement(v.a,{id:"app.control.field.plc.textbind"})),c=this.generateObjectPropertyMappingEditor("valueBindField",null!==(n=null===(o=this.state.optionSettings)||void 0===o?void 0:o.valueBindField)&&void 0!==n?n:"",i,r.createElement(v.a,{id:"app.control.field.plc.valuebind"}));return r.createElement(r.Fragment,null,s,c,r.createElement(D.a,{tokens:S.propertyButtonStackTokens,horizontal:!0},r.createElement(D.a.Item,{styles:S.bindFormButtonsStyles,disableShrink:!0},r.createElement(w.a,{iconProps:S.confirmIcon,onClick:function(){return a.handleApply()}},r.createElement(x.a,{style:S.bindFormButtonFontStyles},r.createElement(v.a,{id:"action.Apply"}))),r.createElement(w.a,{iconProps:S.cancelIcon,onClick:function(){return a.setEditing(!1)}},r.createElement(x.a,{style:S.bindFormButtonFontStyles},r.createElement(v.a,{id:"action.Cancel"}))))))}},{key:"render",value:function(){var e,t=this;return r.createElement(r.Fragment,null,r.createElement(D.a,{tokens:S.propertyStackTokens,horizontal:!0},r.createElement(D.a.Item,{styles:S.propertyLableFieldStyles,disableShrink:!0},r.createElement(v.a,{id:this.props.fieldName})),r.createElement(D.a.Item,{styles:S.propertyValueFieldStyles,grow:2},!this.state.editing&&r.createElement(ne.a,{iconProps:S.listEditingIcon,onClick:function(){t.setEditing(!0)},disabled:void 0===(null===(e=this.props.property)||void 0===e?void 0:e.dataBind)||""===this.props.property.dataBind}))),this.generateOptionSettingsBindForm())}}]),n}(r.Component);function yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DWOptionSettingsEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\DWOptionSettingsEditorField.js")}}();var gt=function(e){u()(n,e);var t=yt(n);function n(e){var o;return i()(this,n),o=t.call(this,e),V()(H()(o),"onRenderOption",(function(e){return r.createElement("div",{className:"dropdowneditor"},e.data&&e.data.icon&&r.createElement(tt.a,{style:{marginRight:"8px"},iconName:e.data.icon,"aria-hidden":"true",title:e.data.icon}),r.createElement("span",null,e.text))})),o}return c()(n,[{key:"createbarcodeTypeDropdownOptions",value:function(){var e=[{key:"Header",text:r.createElement(v.a,{id:"app.control.field.head.2dbarcode"}),itemType:Xe.a.Header}];return e.push({key:pt.DDFBarCodeType.QRCode,text:pt.DDFBarCodeType.QRCode,data:{icon:"FavoriteList"}}),e.push({key:pt.DDFBarCodeType.PDF417,text:pt.DDFBarCodeType.PDF417,data:{icon:"FavoriteList"}}),e.push({key:pt.DDFBarCodeType.DataMatrix,text:pt.DDFBarCodeType.DataMatrix,data:{icon:"FavoriteList"}}),e.push({key:"Header",text:r.createElement(v.a,{id:"app.control.field.head.barcode"}),itemType:Xe.a.Header}),e.push({key:pt.DDFBarCodeType.ISBN,text:pt.DDFBarCodeType.ISBN,data:{icon:"FavoriteList"}}),e.push({key:pt.DDFBarCodeType.UPC_A,text:pt.DDFBarCodeType.UPC_A,data:{icon:"FavoriteList"}}),e.push({key:pt.DDFBarCodeType.UPC_E,text:pt.DDFBarCodeType.UPC_E,data:{icon:"FavoriteList"}}),e.push({key:pt.DDFBarCodeType.EAN13,text:pt.DDFBarCodeType.EAN13,data:{icon:"FavoriteList"}}),e.push({key:pt.DDFBarCodeType.Code39,text:pt.DDFBarCodeType.Code39,data:{icon:"FavoriteList"}}),e.push({key:pt.DDFBarCodeType.Code128,text:pt.DDFBarCodeType.Code128,data:{icon:"FavoriteList"}}),e}},{key:"updateBarcodeSettings",value:function(e){var t={};t=e.barcodeType===pt.DDFBarCodeType.QRCode?_e.a.newInstance().createDDFQRCodeSettings():e.barcodeType===pt.DDFBarCodeType.PDF417?_e.a.newInstance().createDDFPDF417Settings():e.barcodeType===pt.DDFBarCodeType.DataMatrix?_e.a.newInstance().createDDFDataMatrixSettings():_e.a.newInstance().createDDFBarcodeGeneralSettings(e.barcodeType),e[fe.a.barcodeSettingsField]=t}},{key:"handleUpdateFieldValue",value:function(e){var t;if(this.props.handleUserCommand&&(null===(t=this.props.property)||void 0===t?void 0:t.barcodeType)!==e){var n=Object.assign({},this.props.property);n.barcodeType=e,this.updateBarcodeSettings(n);var r=ae.a.newInstance().createEditBarcodeTypeCommand(n);this.props.handleUserCommand(r)}}},{key:"render",value:function(){var e,t,n=this,o=this.createbarcodeTypeDropdownOptions();return r.createElement(ot,{key:(null===(e=this.props.property)||void 0===e?void 0:e.elementId)+"_"+this.props.fieldName,responsiveMode:"large",placeholder:r.createElement(v.a,{id:"app.control.field.selectBarcodeType"}),fieldName:this.props.fieldName,fieldValue:null===(t=this.props.property)||void 0===t?void 0:t.barcodeType,options:o,onChange:function(e){return n.handleUpdateFieldValue(e)}})}}]),n}(r.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\BarcodeTypeEditorField.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\BarcodeTypeEditorField.js")}}();var kt=n(86),bt=n.n(kt);function Ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var Dt=function(e){u()(n,e);var t=Ct(n);function n(e){var r;return i()(this,n),r=t.call(this,e),V()(H()(r),"openDataBindPanel",(function(e,t){r.onToggleFullScreen(!0),r.setState({bindFieldName:e,showDataBindTree:!0}),r.setBindingField(t),r.props.onSetPropertyForm&&r.props.onSetPropertyForm(H()(r))})),V()(H()(r),"closeDataBindPanel",(function(){r.onToggleFullScreen(!1),r.setState({bindFieldName:null,showDataBindTree:!1}),r.props.onSetPropertyForm&&r.props.onSetPropertyForm(null)})),V()(H()(r),"handleCancelOperation",(function(){r.closeDataBindPanel()})),r.state={bindFieldName:null,showDataBindTree:!1},r.bindingField=null,r}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"onToggleFullScreen",value:function(e){this.props.onToggleFullScreen(e?S.PROPERTY_GRID_FULL_SIZE:S.PROPERTY_GRID_DEFAULT_SIZE,e)}},{key:"setBindingField",value:function(e){this.bindingField=e}},{key:"handleUpdateDataBind",value:function(e,t){this.bindingField&&this.bindingField.handleUpdateDataBind(this.state.bindFieldName,e,t)}},{key:"renderFieldEditor",value:function(e,t){var n,o,a,i,s,c,l,u,p=this;switch(e){case fe.a.elementNameField:case fe.a.defaultValueField:case fe.a.checkboxGroupField:return r.createElement(Ve,{key:(null===(n=this.props.property)||void 0===n?void 0:n.elementId)+"_"+e+"_"+this.props.property[e],fieldName:e,fieldValue:this.props.property[e],elementId:this.props.property.elementId,elementType:this.props.property.elementType,handleUserCommand:function(e){return p.props.handleUserCommand(e)}});case fe.a.documentNameField:case fe.a.dataSourceNameField:var d=e===fe.a.documentNameField?this.props.property.documentId:this.props.property.dataSourceId;return r.createElement(Ve,{key:d+"_"+e,fieldName:e,fieldValue:this.props.property[e],elementId:d,elementType:this.props.property.elementType,handleUserCommand:function(e){return p.props.handleUserCommand(e)}});case fe.a.hiddenField:return r.createElement(Qe,{key:d+"_"+e,fieldName:e});case fe.a.chartDataMappingField:return r.createElement(it,{key:(null===(o=this.props.property)||void 0===o?void 0:o.elementId)+"_"+e,property:this.props.property,dataSource:this.props.treedata,fieldName:e,onToggleFullScreen:function(e){return p.onToggleFullScreen(e)},handleUserCommand:function(e){return p.props.handleUserCommand(e)}});case fe.a.dropdownOptionField:return r.createElement(vt,{key:(null===(a=this.props.property)||void 0===a?void 0:a.elementId)+"_"+e,property:this.props.property,dataSource:this.props.treedata,fieldName:e,onToggleFullScreen:function(e){return p.onToggleFullScreen(e)},handleUserCommand:function(e){return p.props.handleUserCommand(e)}});case fe.a.dataBindField:case fe.a.selectedBindField:return r.createElement(We,{key:(null===(i=this.props.property)||void 0===i?void 0:i.elementId)+"_"+e+"_"+(null===(s=this.props.property)||void 0===s?void 0:s.dataBind),property:this.props.property,onBindingField:this.bindingField,fieldName:e,fieldValue:this.props.property[e],handleUserCommand:function(e){return p.props.handleUserCommand(e)},onDataBind:function(e,t){return p.openDataBindPanel(e,t)}});case fe.a.barcodeTypeField:return r.createElement(gt,{key:(null===(c=this.props.property)||void 0===c?void 0:c.elementId)+"_"+e+"_"+(null===(l=this.props.property)||void 0===l?void 0:l.barcodeType),responsiveMode:"large",property:this.props.property,fieldName:e,handleUserCommand:function(e){return p.props.handleUserCommand(e)}});case fe.a.barcodeSettingsField:return r.createElement(mt,{elementId:this.props.property.elementId,fieldName:e,fieldValue:this.props.property[e],elementType:this.props.property.elementType,handleUserCommand:function(e){p.props.handleUserCommand(e)}});case fe.a.expressionField:return r.createElement(lt,{key:(null===(u=this.props.property)||void 0===u?void 0:u.elementId)+"_"+e,fieldName:e,property:this.props.property,handleUserCommand:function(e){return p.props.handleUserCommand(e)}})}}},{key:"render",value:function(){var e=this;if(!this.props.property)return null;var t=[fe.a.childrenField,fe.a.elementIdField,fe.a.elementTypeField,fe.a.dataSourceIdField,fe.a.documentIdField,fe.a.dataSourcesField,fe.a.parentField,fe.a.dataContentField,fe.a.dataViewsField],n=Object.keys(this.props.property).filter((function(e){return!t.includes(e)})).map((function(t,n){return e.renderFieldEditor(t,n)})),o=(this.props.property.elementId?this.props.property.elementId:this.props.property.documentId?this.props.property.documentId:this.props.property.dataSourceId)+"_DSTree_"+this.props.dataHash;return r.createElement(r.Fragment,{key:o},r.createElement("div",{hidden:this.state.showDataBindTree,key:this.props.property.elementId},n),r.createElement($.a,{mode:bt.a.DataBind,dataHash:this.props.dataHash,treedata:this.props.treedata,handleUserCommand:function(t){e.props.handleUserCommand(t)},onUpdateDataBind:function(t,n){e.handleUpdateDataBind(t,n)},property:this.props.property,quickSearch:this.props.quickSearch,onSearch:this.props.onSearch,hidden:!this.state.showDataBindTree,isChinese:this.props.isChinese,onClose:this.closeDataBindPanel}))}}]),n}(r.Component);function xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\GenericPropertyForm.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\GenericPropertyForm.js")}}();var Et=function(e){u()(n,e);var t=xt(n);function n(e){var o;return i()(this,n),o=t.call(this,e),V()(H()(o),"handleToggleFullScreen",(function(){o.props.onToggleFullScreen&&(o.props.propertyGridSize.fullSize?o.props.onToggleFullScreen(o.props.propertyGridSize.lastSize,!1):o.props.onToggleFullScreen(S.PROPERTY_GRID_FULL_SIZE,!0))})),V()(H()(o),"handleCancelButtonClick",(function(){var e;o.setState({showCancelButton:!1}),null!==(e=o.propertyForm)&&void 0!==e&&e.handleCancelOperation&&o.propertyForm.handleCancelOperation()})),V()(H()(o),"renderPropertyCell",(function(e){return null==e?r.createElement("div",null):r.createElement(Dt,{key:"property_form_"+e.elementId,treedata:o.props.treedata,dataHash:o.props.dataHash,handleUserCommand:function(e){o.props.handleUserCommand(e)},onSetPropertyForm:function(e){o.setPropertyForm(e)},onToggleFullScreen:o.props.onToggleFullScreen,property:e,quickSearch:o.props.quickSearch,onSearch:o.props.onSearch,isChinese:o.props.isChinese})})),V()(H()(o),"getResizeIcon",(function(){return o.props.propertyGridSize.fullSize?S.btnSmallScreen:S.btnFullScreen})),V()(H()(o),"getResizeButtonToolTip",(function(){return o.props.propertyGridSize.fullSize?r.createElement(v.a,{id:"action.screen.reset"}):r.createElement(v.a,{id:"action.screen.full"})})),o.state={showCancelButton:!1},o.propertyForm=null,o}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"setPropertyForm",value:function(e){this.propertyForm=e,e?this.setState({showCancelButton:!0}):this.setState({showCancelButton:!1})}},{key:"render",value:function(){var e=this,t={childrenGap:1},n=this.props.selected,o={gapSpace:0},a=n?n.elementId?n.elementId:n.documentId?n.documentId:n.dataSourceId:"static_empty_property",i=r.createElement(v.a,{id:"app.control.propertygrid.tooltip.close"}),s=this.getResizeButtonToolTip();return r.createElement(r.Fragment,null,r.createElement("div",{className:"properties-bar"},r.createElement(D.a,{tokens:t},r.createElement(D.a.Item,{align:"end",styles:{root:{padding:"0 15px 0 5px"}}},this.state.showCancelButton&&r.createElement(F.a,{content:i,id:"cancelButtonToolTip",calloutProps:o},r.createElement(ne.a,{iconProps:S.cancelIcon,onClick:function(){return e.handleCancelButtonClick()}})),r.createElement(F.a,{content:s,id:"resizeButtonToolTip",calloutProps:o},r.createElement(ne.a,{iconProps:this.getResizeIcon(),disabled:!n,onClick:function(){return e.handleToggleFullScreen()}}))))),r.createElement("div",{className:"tree-content"},r.createElement(D.a,{key:"property_"+a,tokens:t},this.renderPropertyCell(n))))}}]),n}(r.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\YDocPropertiesGrid.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\YDocPropertiesGrid.js")}}();var wt=function e(t){i()(this,e),V()(this,"editDynamicText",function(){var e=_()(Y.a.mark((function e(t,n){var r,o,a,i,s,c,l,u;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(I.h)(t.elementId);case 3:return o=e.sent,e.next=6,Object(I.B)();case 6:if(a=e.sent,i=Object.assign({},t),s=Object(I.a)(t.elementType,t.elementName),!a||i.defaultValue&&""!==i.defaultValue||(i.defaultValue=a.trim()),c=(null===(r=i.defaultValue)||void 0===r?void 0:r.toString())||i.elementName,!o){e.next=17;break}return e.next=14,Object(I.s)(i.elementId,c,s);case 14:e.t0=e.sent,e.next=20;break;case 17:return e.next=19,Object(I.t)(s,c,i.elementId,Word.ContentControlAppearance.boundingBox,!0,!0);case 19:e.t0=e.sent;case 20:if(!(l=e.t0)){e.next=27;break}return e.next=24,Object(I.D)(i.elementId,!1);case 24:u=e.sent,this.repoManager.createOrUpdateDDFElement(i,u),null!=n&&u.index>0&&n(i.elementId);case 27:return e.abrupt("return",l);case 30:throw e.prev=30,e.t1=e.catch(0),console.error(e.t1),e.t1;case 34:case"end":return e.stop()}}),e,this,[[0,30]])})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editDynamicImage",function(){var e=_()(Y.a.mark((function e(t,n){var r,o;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(I.a)(t.elementType,t.elementName),e.next=3,Object(I.h)(t.elementId);case 3:if(!e.sent){e.next=10;break}return e.next=7,Object(I.s)(t.elementId,null,r);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,Object(I.b)(r,t.elementId,S.TEMPLATE_INLINE_IMAGE_PLCHOLDER,Word.ContentControlAppearance.boundingBox);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=20;break}return e.next=17,Object(I.D)(t.elementId,!1);case 17:o=e.sent,this.repoManager.createOrUpdateDDFElement(t,o),n&&o.index>0&&n(t.elementId);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editBarcode",function(){var e=_()(Y.a.mark((function e(t,n){var r,o,a,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(I.a)(t.elementType,t.elementName),e.next=3,Object(I.h)(t.elementId);case 3:if(o=e.sent,a=S.TEMPLATE_BARCODE_PLACEHOLDER+t.barcodeType.toLowerCase()+".png",!o){e.next=11;break}return e.next=8,Object(I.s)(t.elementId,null,r);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,Object(I.b)(r,t.elementId,a,Word.ContentControlAppearance.boundingBox,!1,!0);case 13:e.t0=e.sent;case 14:if(!e.t0){e.next=21;break}return e.next=18,Object(I.D)(t.elementId,!1);case 18:i=e.sent,this.repoManager.createOrUpdateDDFElement(t,i),n&&i.index>0&&n(t.elementId);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"checkBarcodeDimentions",(function(e){return e===pt.DDFBarCodeType.PDF417||e===pt.DDFBarCodeType.QRCode||e===pt.DDFBarCodeType.DataMatrix?2:1})),V()(this,"editBarcodeType",function(){var e=_()(Y.a.mark((function e(t,n){var r,o,a,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t||!t.barcodeType){e.next=13;break}if(r={barcodeType:t.barcodeType,barcodeSettings:t.barcodeSettings},o=this.repoManager.findDDFElement(t.elementId)){e.next=5;break}return e.abrupt("return");case 5:if(a=!0,o.barcodeType===t.barcodeType){e.next=11;break}return i=S.TEMPLATE_BARCODE_PLACEHOLDER+t.barcodeType.toLowerCase()+".png",e.next=10,Object(I.r)(t.elementId,i);case 10:a=e.sent;case 11:a&&this.repoManager.updateDDFNodeProperty(t.elementId,r),null!=n&&n(t.elementId);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editQRCode",function(){var e=_()(Y.a.mark((function e(t,n){var r,o;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(I.a)(t.elementType,t.elementName),e.next=3,Object(I.h)(t.elementId);case 3:if(!e.sent){e.next=10;break}return e.next=7,Object(I.s)(t.elementId,null,r);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,Object(I.b)(r,t.elementId,S.TEMPLATE_QRCODE_PLACEHOLDER,Word.ContentControlAppearance.boundingBox);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=20;break}return e.next=17,Object(I.D)(t.elementId,!1);case 17:o=e.sent,this.repoManager.createOrUpdateDDFElement(t,o),n&&o.index>0&&n(t.elementId);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"isChineseLocale",(function(){try{var e=Object(I.E)().split(/[-_]/)[0].toLowerCase();if("zh"!==e&&"cn"!==e)return!1}catch(e){console.log(e)}return!0})),V()(this,"editDynamicChart",function(){var e=_()(Y.a.mark((function e(t,n){var r,o,a,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(I.a)(t.elementType,t.elementName),e.next=3,Object(I.h)(t.elementId);case 3:if(o=e.sent,a=this.isChineseLocale(),!o){e.next=11;break}return e.next=8,Object(I.s)(t.elementId,null,r);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,Object(I.c)(r,t.elementId,a?S.TEMPLATE_INLINE_CHART:S.TEMPLATE_INLINE_CHART_EN,Word.ContentControlAppearance.boundingBox,!1,!0);case 13:e.t0=e.sent;case 14:if(!e.t0){e.next=21;break}return e.next=18,Object(I.D)(t.elementId,!1);case 18:i=e.sent,this.repoManager.createOrUpdateDDFElement(t,i),n&&i.index>0&&n(t.elementId);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),this.repoManager=t};!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YDynamicTextCommand.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YDynamicTextCommand.js")}}();var St=n(53),It=n.n(St),Ot=n(108),Ft=n.n(Ot),Pt=n(566),Tt=function(){function e(t){i()(this,e),V()(this,"signInUser",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&this.repoManager.updateStoredPrincipal(t.node);case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"signUpUser",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&this.repoManager.updateStoredPrincipal(t.node);case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"signoutUser",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&this.repoManager.updateStoredPrincipal({accessToken:null,userName:null,userEmail:null,userServiceLevel:0});case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"gotoHelp",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(I.F)(S.URL_GOTO_HELP);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"contactSupport",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(I.F)(S.URL_CONTACT_SUPPORT);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"showPriceList",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(I.F)(S.URL_SHOW_PRICE_LIST);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"bookDemo",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(I.F)(S.URL_BOOK_DEMO);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"selectDocumentNode",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.elementType===se.a.Datasource&&t.elementType===se.a.Document){e.next=3;break}return e.next=3,Object(I.q)(t.elementId);case 3:null!=n&&n(t.elementId);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"deleteControl",function(){var e=_()(Y.a.mark((function e(t,n){var r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.d)(t.elementId);case 2:e.sent&&(r=this.repoManager.deleteDDFElement(t.elementId),n&&r&&n(r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"deleteControlWithoutContent",function(){var e=_()(Y.a.mark((function e(t,n){var r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.d)(t.elementId,!0);case 2:e.sent&&(r=this.repoManager.deleteDDFElementWithoutContents(t.elementId),n&&r&&n(r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"updateDDFNodeProperty",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.repoManager.updateDDFNodeProperty(t.elementId,t),null!=n&&t.elementType!==se.a.Document&&t.elementType!==se.a.Datasource&&n(t.elementId);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editDynamicControlName",function(){var e=_()(Y.a.mark((function e(t,n){var r,o;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(I.a)(t.elementType,t.elementName),o=t.defaultValue?"["+t.defaultValue+"]":null,e.next=4,Object(I.s)(t.elementId,o,r);case 4:this.repoManager.updateDDFNodeProperty(t.elementId,t),null!=n&&n(t.elementId);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editExpression",function(){var e=_()(Y.a.mark((function e(t,n){var r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=t&&t.expression&&(r={expression:t.expression},this.repoManager.updateDDFNodeProperty(t.elementId,r),null!=n&&n(t.elementId));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editDocumentProperties",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&this.repoManager.editDocumentProperties(t),null!=n&&n(this.repoManager.getDDF());case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editDocumentCustomData",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,this.repoManager.saveDataSource(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"showDebugDDFInfo",function(){var e=_()(Y.a.mark((function e(t,n){var r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.repoManager.getDDF(),Object(I.l)(r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"handleDocumentPreview",function(){var e=_()(Y.a.mark((function e(t,n,r){var o,a,i,s,c,l,u,p,d,f,m,h,v=this;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.designRecord,i=new It.a,this.setupPreviewDocumentProgressStatus(i),e.next=5,Object(I.y)((function(e){var t=i.getStepData(St.PreviewStep.PreparingDocument);if(e.error)return t.stepDescription="Error",i.updateStateWithFatal(t,e.error),void v.updateUIPreviewProgress(i,r);var n=e.slicesReceived/e.sliceCount;t.completePercentage=n,i.updateStateInProgess(t),v.updateUIPreviewProgress(i,r)}));case 5:if(s=e.sent,c=i.getStepData(St.PreviewStep.PreparingDocument),!(!s&&s.length>0||1!==c.completePercentage)){e.next=9;break}return e.abrupt("return");case 9:return i.setCurrentStep(St.PreviewStep.AssemblyDocument),this.updateUIPreviewProgress(i,r),l=null===(o=n.authConfig)||void 0===o?void 0:o.accessToken,u=Object(I.E)(),p="en",d="us",!u||null===u||"zh"!==u.toLowerCase()&&"zh-cn"!==u.toLowerCase()||(p="zh",d="cn"),f=Object.assign({},a),m=ae.a.newInstance().createDocumentServiceRequest(btoa(s),JSON.stringify(f),Pt.LogLevel.debug,p,d),e.next=20,Object(O.f)(m,l,t,(function(e){if(e.uploaded&&200===e.statusCode){i.setCurrentStep(St.PreviewStep.AssemblyDocument);var t=i.getStepData(i.getCurrentStep());return t.completePercentage=e.uploaded/e.upTotal,i.updateStateInProgess(t),t.completePercentage>=1&&i.setCurrentStep(St.PreviewStep.GenerateResult),void v.updateUIPreviewProgress(i,r)}if(e.downloaded&&200===e.statusCode){i.setCurrentStep(St.PreviewStep.GenerateResult);var n=i.getStepData(i.getCurrentStep());return n.completePercentage=e.downloaded/e.downTotal,i.updateStateInProgess(n),void v.updateUIPreviewProgress(i,r)}if(e.documentName&&e.documentName.length>0){i.setCurrentStep(St.PreviewStep.GenerateResult);var o=i.getStepData(i.getCurrentStep());return i.updateStateCompleted(o),void v.updateUIPreviewProgress(i,r)}if(e.errorMessage||e.statusCode&&200!==e.statusCode||e.error){var a=i.getStepData(i.getCurrentStep());a.stepDescription="Error";var s=e.errorMessage||e.error;return i.updateStateWithFatal(a,s),void v.updateUIPreviewProgress(i,r)}}));case 20:if(!(h=e.sent)){e.next=26;break}return console.log(h.documentName),e.next=25,Object(I.F)(h.documentName);case 25:try{null!=r&&i.getState().progress===St.ProgressStatus.Completed&&r.close()}catch(e){}case 26:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()),V()(this,"previewWordDocument",function(){var e=_()(Y.a.mark((function e(t,n,r){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleDocumentPreview(Se.a.Word,t,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()),V()(this,"previewPDFDocument",function(){var e=_()(Y.a.mark((function e(t,n,r){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleDocumentPreview(Se.a.PDF,t,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()),V()(this,"saveDocument",function(){var e=_()(Y.a.mark((function e(t,n){var r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.repoManager.getDDF(),e.next=3,this.repoManager.saveDocumentDDF(r);case 3:n&&n(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"openWindowURL",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(I.F)(t),n&&n(ddf);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.repoManager=t}return c()(e,[{key:"setupPreviewDocumentProgressStatus",value:function(e){var t={completePercentage:0,stepTitle:"Preparing",stepDescription:"Preparing Document",nextStep:St.PreviewStep.AssemblyDocument};e.setStepData(St.PreviewStep.PreparingDocument,t);var n={completePercentage:0,stepTitle:"Assembly",stepDescription:"Assembly Document",nextStep:St.PreviewStep.GenerateResult};e.setStepData(St.PreviewStep.AssemblyDocument,n);var r={completePercentage:0,stepTitle:"Finalize",stepDescription:"Finalize Document",nextStep:St.PreviewStep.GenerateResult};e.setStepData(St.PreviewStep.GenerateResult,r),e.setCurrentStep(St.PreviewStep.PreparingDocument)}},{key:"updateUIPreviewProgress",value:function(e,t){var n=e.getState(),r=JSON.stringify(n),o=Ft.a.newInstance().isLocalStorageUsed();console.log("is localstorage used: "+o),o?localStorage.setItem(S.LOCAL_STORE_KEY_PROGRESS,r):Object(I.H)(t,r)}}]),e}();function Mt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return jt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YCommonCommand.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YCommonCommand.js")}}();var Rt=function e(t){var n=this;i()(this,e),V()(this,"editLoop",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.editContainerControl(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editIfGroup",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.editContainerControl(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editContainerControl",function(){var e=_()(Y.a.mark((function e(t,n){var r,o,a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.h)(t.elementId);case 2:if(r=e.sent,o=Object(I.a)(t.elementType,t.elementName),!r){e.next=10;break}return e.next=7,Object(I.s)(t.elementId,null,o);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,Object(I.v)(o,t.elementId,Word.ContentControlAppearance.boundingBox,!1,!0);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=20;break}return e.next=17,Object(I.D)(t.elementId,!0);case 17:a=e.sent,this.repoManager.createOrUpdateDDFElement(t,a),null!=n&&a.index>0&&n(t.elementId);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"createTable",function(){var e=_()(Y.a.mark((function e(t,r){var o,a,i,s,c;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object.assign([],t.columns),a=Object.assign({},t.loop),(null==o?void 0:o.length)>0){a.children=[],i=Mt(o);try{for(i.s();!(s=i.n()).done;)(c=s.value).parent=a.elementId,a.children.push(c)}catch(e){i.e(e)}finally{i.f()}}return e.next=5,n._createTableAndLoopControl(a,o,r);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"_createTableAndLoopControl",function(){var e=_()(Y.a.mark((function e(t,r,o){var a,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null==r?void 0:r.length)>0){e.next=2;break}return e.abrupt("return",!1);case 2:return a=Object(I.a)(t.elementType,t.elementName),e.next=5,Object(I.u)(a,t.elementId,Word.ContentControlAppearance.boundingBox,!1,!0,r);case 5:if(!e.sent){e.next=12;break}return e.next=9,Object(I.D)(t.elementId,!1);case 9:i=e.sent,n.repoManager.createOrUpdateDDFElement(t,i),null!=o&&i.index>0&&o(t.elementId);case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),this.repoManager=t};!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YControlFlowCommand.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YControlFlowCommand.js")}}();var Nt=function(){function e(t){i()(this,e),V()(this,"editTextbox",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.editFormFieldControl(t,n,S.TEMPLATE_TEXTBOX_PLACEHOLDER);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editCheckbox",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.editFormFieldControl(t,n,S.TEMPLATE_CHECKBOX_PLACEHOLDER);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editDropdown",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.editFormFieldControl(t,n,S.TEMPLATE_DROPDOWN_PLACEHOLDER);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"editDatePicker",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.editFormFieldControl(t,n,S.TEMPLATE_DATEPICKER_PLACEHOLDER);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),this.repoManager=t}var t;return c()(e,[{key:"editFormFieldControl",value:(t=_()(Y.a.mark((function e(t,n,r){var o,a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(I.a)(t.elementType,t.elementName),e.next=3,Object(I.h)(t.elementId);case 3:if(!e.sent){e.next=10;break}return e.next=7,Object(I.s)(t.elementId,null,o);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,Object(I.c)(o,t.elementId,r,Word.ContentControlAppearance.hidden,!0,!0);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=20;break}return e.next=17,Object(I.D)(t.elementId,!1);case 17:a=e.sent,this.repoManager.createOrUpdateDDFElement(t,a),n&&a.index>0&&n(t.elementId);case 20:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}();!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YFormfieldCommand.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YFormfieldCommand.js")}}();var Lt=n(711),Bt=function e(t){i()(this,e),V()(this,"setErrorMessage",(function(e){this.error=e})),V()(this,"handleUndefinedCommand",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.l)(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"handleDialogCommand",function(){var e=_()(Y.a.mark((function e(t){var n,r,o,a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Lt.a(this.repoManager),e.next=3,n.handleDialogCommand(t);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return o=r.getDialogResult(),e.next=9,o;case 9:if(!(a=e.sent).result){e.next=13;break}if(a.result.error||a.result.cancel){e.next=13;break}return e.abrupt("return",a);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()),V()(this,"searchAndExecuteCommand",function(){var e=_()(Y.a.mark((function e(t,n){var r,o,a,i,s,c,l;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=t.commandName,a=t.node,i=null===(r=t.dialog)||void 0===r?void 0:r.dialogWindow,s=0;case 4:if(!(s<this.commands.length)){e.next=15;break}if(c=this.commands[s],!(Object.keys(this.commands[s]).indexOf(o)>=0)){e.next=12;break}return l=c[o],e.next=11,l.call(c,a,n,i);case 11:return e.abrupt("return",e.sent);case 12:s++,e.next=4;break;case 15:return e.abrupt("return",this.handleUndefinedCommand(t,n));case 16:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()),V()(this,"executeCommand",function(){var e=_()(Y.a.mark((function e(t,n){var r,o,a,i,s;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object.assign({},t),null===(r=o.authConfig)||void 0===r||!r.required){e.next=19;break}if(console.log("try to get access token from store."),a=this.repoManager.getStroredPrincipal(),console.log("token is null? "+(!(null!=a&&a.accessToken)||null===(null==a?void 0:a.accessToken))),o.authConfig.accessToken=null==a?void 0:a.accessToken,!Object(I.m)()||o.authConfig.accessToken&&""!==o.authConfig.accessToken&&null!==o.authConfig.accessToken){e.next=19;break}return e.prev=7,console.log("try to get access token with SSO cache."),e.next=11,Object(I.e)();case 11:i=e.sent,console.log("get token."),o.authConfig.accessToken=i,e.next=19;break;case 16:e.prev=16,e.t0=e.catch(7),console.log(e.t0);case 19:if(!0!==o.usingDialog){e.next=31;break}return console.log("opening dialog"),e.next=23,this.handleDialogCommand(o,n);case 23:if(s=e.sent,console.log("get dialog result"),!s||!s.result){e.next=30;break}o.node=s.result,o.dialog.dialogWindow=s.dialogWindow,e.next=31;break;case 30:return e.abrupt("return",!1);case 31:return e.next=33,this.searchAndExecuteCommand(o,n);case 33:case"end":return e.stop()}}),e,this,[[7,16]])})));return function(t,n){return e.apply(this,arguments)}}()),this.repoManager=t,this.commands=[new Tt(t),new wt(t),new Rt(t),new Nt(t)],this.error=null};function Ut(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return At(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\YCommander.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\YCommander.js")}}();var _t=function(){function e(t){var n=this;i()(this,e),V()(this,"searchElement",(function(e){if(this.ddf.documentId===e)return this.ddf;if(this.ddf.dataSources&&this.ddf.dataSources.length>0)for(var t=0;t<this.ddf.dataSources.length;t++){var n=this.ddf.dataSources[t];if(n.dataSourceId===e)return n}return this.searchChildrenElement(this.ddf,e)})),V()(this,"addElement",(function(e,t){if(this.updateChildrenRelationShip(t,e),this.resolveDatabinding(e),t.parent){var n=this.searchElement(t.parent);n&&(n.children?t.index>=0?n.children.splice(t.index,0,e):n.children.push(e):n.children=[e])}else this.ddf.children?t.index>=0?this.ddf.children.splice(t.index,0,e):this.ddf.children.push(e):this.ddf.children=[e];return this.getDDF()})),V()(this,"deleteElement",(function(e){var t=this.searchElement(e);if(t&&t.parent){var n=this.searchElement(t.parent);n&&n.children.splice(n.children.indexOf(t),1)}return this.getDDF()})),V()(this,"deleteWithoutChildren",(function(e){var t=this.searchElement(e);if(t){for(var n,r=t.parent,o=this.searchElement(r),a=0;a<(null!==(i=null===(s=t.children)||void 0===s?void 0:s.length)&&void 0!==i?i:0);a++){var i,s;t.children[a].parent=r}if(o&&(null===(n=t.children)||void 0===n?void 0:n.length)>0){var c,l=o.children.indexOf(t);if(l>=0)(c=o.children).splice.apply(c,[l,1].concat(te()(t.children)))}}return this.getDDF()})),V()(this,"updateElement",(function(e,t){var n=this.searchElement(e.elementId);return n&&(e.parent=n.parent,Object.assign(n,e)),this.getDDF()})),V()(this,"resetDDF",(function(e){var t=Object.assign({},e);n.ddf=t})),V()(this,"editDocumentProperties",(function(e){Object.assign(this.ddf,e)})),V()(this,"getDDF",(function(){return Object.assign({},this.ddf)})),V()(this,"resolveDatabinding",(function(e){if(e){var t=n.searchElement(e.parent);if(t&&t.dataBind){for(var r=[];t&&t.elementId;)r.push(t.dataBind),t=n.searchElement(t.parent);if(0!=r.length&&e.dataBind){var o,a=Ut(r);try{for(a.s();!(o=a.n()).done;){var i=o.value;if(e.dataBind.includes(i))return void(e.dataBind=e.dataBind.substring(e.dataBind.indexOf(i)+i.length+1,e.dataBind.length))}}catch(e){a.e(e)}finally{a.f()}}}}})),V()(this,"findAbsolutedPathOfDDFNode",(function(e){if(!e||!e.dataBind)return null;if(e.dataBind.startsWith(S.JSON_PATH_ROOT))return e.dataBind;var t=n.searchElement(e.parent);if(!t.dataBind)return S.JSON_PATH_ROOT+S.JSON_PATH_SEPARATOR+e.dataBind;for(var r=[];t&&t.elementId;)r.push(t.dataBind),t=n.searchElement(t.parent);if(0==r.length)return S.JSON_PATH_ROOT+S.JSON_PATH_SEPARATOR+e.dataBind;var o,a="",i=Ut(r=Object.assign([],r.reverse()));try{for(i.s();!(o=i.n()).done;){a+=o.value+S.JSON_PATH_SEPARATOR}}catch(e){i.e(e)}finally{i.f()}return a+e.dataBind})),this.ddf=t}return c()(e,[{key:"searchChildrenElement",value:function(e,t){if(e.elementId===t)return e;if(null!=e.children&&e.children.length>0)for(var n=0;n<e.children.length;n++){var r=e.children[n],o=this.searchChildrenElement(r,t);if(o)return o}return null}},{key:"updateChildrenRelationShip",value:function(e,t){if(e&&(e.parent?t.parent=e.parent:t.parent=this.ddf.documentId,e.children&&e.children.length>0)){t.children?t.children.splice(0,t.children.length):t.children=[];for(var n=0;n<e.children.length;n++){var r=e.children[n],o=this.searchChildrenElement(this.ddf,r);o&&o.parent!=t.elementId&&(this.deleteElement(r),o.parent=t.elementId,t.children.push(o))}}}},{key:"updateObjectFieldValues",value:function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;r++){var o=n[r];e[o]!==t[o]&&(t[o]=e[o])}}},{key:"updateDDFNodeProperty",value:function(e,t){var n=this.searchElement(e);n&&(this.updateObjectFieldValues(t,n),(t[fe.a.dataBindField]||t[fe.a.selectedBindField])&&this.resolveDatabinding(n))}}]),e}();!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\YRepository.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\YRepository.js")}}();var Gt=function(){function e(){var t=this;i()(this,e),V()(this,"getDataSourceInStorage",_()(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.x)();case 2:return t=e.sent,n=null,t&&(n=JSON.parse(t)),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))),V()(this,"registerDDFModifyMonitor",(function(e){null!=e&&this.ddfMonitors.indexOf(e)<0&&this.ddfMonitors.push(e)})),V()(this,"registerSigninMonitor",(function(e){null!=e&&this.signinMonitors.indexOf(e)<0&&this.signinMonitors.push(e)})),V()(this,"registerDataSourceMonitor",(function(e){e&&this.dataSourceMonitors.indexOf(e)<0&&this.dataSourceMonitors.push(e)})),V()(this,"removeDDFModifyMonitor",(function(e){null!=e&&this.ddfMonitors.indexOf(e)>=0&&(this.ddfMonitors=this.ddfMonitors.splice(this.ddfMonitors.indexOf(e),1))})),V()(this,"getDDF",(function(){var e=t.repo.getDDF();return e.documentId?e:null})),V()(this,"resetDDF",(function(e){this.repo.resetDDF(e);var t=this.getDDF();return this.notifyDDFMonitors(t),t})),V()(this,"editDocumentProperties",(function(e){this.repo.editDocumentProperties(e);var t=this.getDDF();return this.notifyDDFMonitors(t,t.documentId),t})),V()(this,"getDocumentPropertis",(function(e){var t=Object.assign({},e);return t.elementType=se.a.Document,t.dataSources=[],t.children=[],t})),V()(this,"getDataSourceElement",(function(e){var t=e.dataSources[0];return Object.assign({},t)})),V()(this,"createOrUpdateDDFElement",(function(e,t){null==this.repo.searchElement(e.elementId)?this.repo.addElement(e,t):this.repo.updateElement(e,t);var n=this.getDDF();return this.notifyDDFMonitors(n,e.documentId),n})),V()(this,"deleteDDFElement",(function(e){var t=this.findDDFElement(e);if(t){var n=this.repo.deleteElement(e);return this.notifyDDFMonitors(n,t.parent),t.parent}return null})),V()(this,"deleteDDFElementWithoutContents",(function(e){var t=this.findDDFElement(e);if(t){var n=this.repo.deleteWithoutChildren(e);return this.notifyDDFMonitors(n,t.parent),t.parent}return null})),this.ddfMonitors=[],this.dataSourceMonitors=[],this.signinMonitors=[],this.accessToken=null,this.principal={accessToken:null,userName:null,userEmail:null,userServiceLevel:0}}var t,n,r,o,a,s;return c()(e,[{key:"setupRepositoryManager",value:(s=_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDDFInStorage();case 2:t=e.sent,this.repo=new _t(null!=t?t:{});case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"getDDFInStorage",value:(a=_()(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.w)();case 2:return t=e.sent,n=null,t&&(n=JSON.parse(t)),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"getStoredAccessToken",value:(o=_()(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasStoredAccessToken()){e.next=10;break}return e.prev=1,e.next=4,Object(I.e)();case 4:this.accessToken=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:return e.abrupt("return",this.accessToken);case 11:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(){return o.apply(this,arguments)})},{key:"hasStoredAccessToken",value:function(){var e;return!!this.accessToken&&(null===(e=this.accessToken)||void 0===e?void 0:e.length)>0}},{key:"updateStoredAccessToken",value:function(e){this.accessToken=e}},{key:"updateStoredPrincipal",value:function(e){this.principal=Object.assign({},e),this.notifySigninMonitors(e)}},{key:"getStroredPrincipal",value:function(){return this.principal}},{key:"saveDataSource",value:(r=_()(Y.a.mark((function e(t){var n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify(t),e.next=3,Object(I.o)(n);case 3:return r=e.sent,Ft.a.newInstance().isLocalStorageUsed()&&localStorage.setItem(S.STORAGE_KEY_DATASOURCE,n),this.notifyDataSourceMonitors(t),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setupAutoSave",value:function(e){e?this.registerDDFModifyMonitor(this.saveDocumentDDF):this.removeDDFModifyMonitor(this.saveDocumentDDF)}},{key:"saveDocumentDDF",value:(n=_()(Y.a.mark((function e(t,n){var r,o;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.stringify(t),o=Object(I.n)(r),e.next=4,o;case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"setPluginAutoLoad",value:(t=_()(Y.a.mark((function e(t){var n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(I.I)(t),e.next=3,n;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"updateDDFNodeProperty",value:function(e,t){this.repo.updateDDFNodeProperty(e,t);var n=this.getDDF();return this.notifyDDFMonitors(n,e),n}},{key:"findDDFElement",value:function(e){var t=this.repo.getDDF();return t.documentId===e?this.getDocumentPropertis(t):t.dataSources&&t.dataSources.length>0&&t.dataSources[0].dataSourceId===e?this.getDataSourceElement(t):this.repo.searchElement(e)}},{key:"notifyDDFMonitors",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0;n<this.ddfMonitors.length;n++){var r=this.ddfMonitors[n];r(e,t)}}},{key:"notifyDataSourceMonitors",value:function(e){for(var t=0;t<this.dataSourceMonitors.length;t++){var n=this.dataSourceMonitors[t];n&&n(e)}}},{key:"notifySigninMonitors",value:function(e){for(var t=0;t<this.signinMonitors.length;t++){var n=this.signinMonitors[t];n&&n(e)}}},{key:"findAbsolutedPathOfDDFNode",value:function(e){return e?this.repo.findAbsolutedPathOfDDFNode(e):""}}]),e}();!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\YRepositoryManager.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\YRepositoryManager.js")}}();var Ht=n(438),Wt=n(706),Vt=n(261),zt=n(419);function Yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var qt=function(e){u()(n,e);var t=Yt(n);function n(e,r){var o;return i()(this,n),o=t.call(this,e,r),V()(H()(o),"handleCreateDynamicText",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==o.props.handleUserCommand){e.next=5;break}return(t=ae.a.newInstance().createEditDynamicTextControlCommand()).usingDialog=!1,e.next=5,o.props.handleUserCommand(t);case 5:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateDynamicImage",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createEditDynamicImageControlCommand(),e.next=4,o.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateDynamicChart",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createEditDynamicChartControlCommand(),e.next=4,o.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateBarcode",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createEditBarcodeControlCommand(),e.next=4,o.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateQRCode",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createEditQRCodeControlCommand(),e.next=4,o.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateTextbox",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createEditTextboxControlCommand(),e.next=4,o.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateDropdown",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createEditDropdownControlCommand(),e.next=4,o.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateCheckbox",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createEditCheckboxControlCommand(),e.next=4,o.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateDatePicker",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createEditDatePickerControlCommand(),e.next=4,o.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateLoopControl",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=4;break}return t=ae.a.newInstance().createEditLoopControlCommand(),e.next=4,o.props.handleUserCommand(t);case 4:case"end":return e.stop()}}),e)})))),V()(H()(o),"handleCreateIFGroupControl",_()(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.props.handleUserCommand){e.next=5;break}return(t=ae.a.newInstance().createEditIFGroupControlCommand()).usingDialog=!1,e.next=5,o.props.handleUserCommand(t);case 5:case"end":return e.stop()}}),e)})))),o}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"buildActionButton",value:function(e){return r.createElement(D.a.Item,{styles:{root:{height:64,alignItems:"center",display:"flex",justifyContent:"left",overflow:"hidden",padding:0,width:"50%"}},key:e.key},r.createElement(Ht.a,{iconProps:e.iconProps,allowDisabledFocus:!0,onClick:e.onClick,secondaryText:e.ariaLabel,styles:{root:{border:"none"},icon:{selectors:{".designericon":{fontSize:24,height:24,width:24}}}}},e.text))}},{key:"renderTextControlGroup",value:function(){var e=this,t=[V()({key:"mnuInsertDyText",text:this.props.intl.formatMessage({id:"app.control.dynamic.text"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.dynamic.text.desc"}),iconProps:S.dynamicTextIcon,onClick:function(){e.handleCreateDynamicText()}},"data-automation-id","mnuInsertDyText"),{key:"mnuInsertDyImage",text:this.props.intl.formatMessage({id:"app.control.dynamic.image"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.dynamic.image.desc"}),onClick:function(){e.handleCreateDynamicImage()},iconProps:S.dynamicImageIcon},{key:"mnuInsertDyChart",text:this.props.intl.formatMessage({id:"app.control.dynamic.chart"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.dynamic.chart.desc"}),onClick:function(){e.handleCreateDynamicChart()},iconProps:S.chartIcon},{key:"mnuInsertBarcode",text:this.props.intl.formatMessage({id:"app.control.dynamic.barcode"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.dynamic.barcode.desc"}),onClick:function(){e.handleCreateBarcode()},iconProps:S.barcodeIcon}];return this.buildActionGroupElements(t)}},{key:"buildActionGroupElements",value:function(e){for(var t={root:{alignItems:"center",display:"flex",height:64,justifyContent:"left",padding:0,width:"100%",margin:0}},n=[],o=0;o<e.length;o+=2){var a=e[o],i=o+1<e.length?e[o+1]:null,s=r.createElement(D.a.Item,{styles:t,key:a.text},r.createElement(D.a,{tokens:S.propertyStackTokens,styles:t,horizontal:!0},this.buildActionButton(a),i&&this.buildActionButton(i)));n.push(s)}return n}},{key:"renderLogicControlGroup",value:function(){var e=this,t=[{key:"mnuConditionIF",text:this.props.intl.formatMessage({id:"app.control.logicflow.if"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.logicflow.if.desc"}),onClick:function(){e.handleCreateIFGroupControl()},iconProps:S.ifGroupIcon},{key:"mnuLoop",text:this.props.intl.formatMessage({id:"app.control.logicflow.loop"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.logicflow.loop.desc"}),onClick:function(){e.handleCreateLoopControl()},iconProps:S.loopIcon}];return this.buildActionGroupElements(t)}},{key:"renderFormControlGroup",value:function(){var e=this,t=[{key:"mnuTextBox",text:this.props.intl.formatMessage({id:"app.control.forms.textbox"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.forms.textbox.desc"}),onClick:function(){e.handleCreateTextbox()},iconProps:S.textboxIcon},{key:"mnuDropdown",text:this.props.intl.formatMessage({id:"app.control.forms.dropdown"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.forms.dropdown.desc"}),onClick:function(){e.handleCreateDropdown()},iconProps:S.dropdownIcon},{key:"mnuCheckbox",text:this.props.intl.formatMessage({id:"app.control.forms.checkbox"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.forms.checkbox.desc"}),onClick:function(){e.handleCreateCheckbox()},iconProps:S.checkboxIcon},{key:"mnuDatepicker",text:this.props.intl.formatMessage({id:"app.control.forms.datepicker"}),ariaLabel:this.props.intl.formatMessage({id:"app.control.forms.datepicker.desc"}),onClick:function(){e.handleCreateDatePicker()},iconProps:S.datepickerIcon}];return this.buildActionGroupElements(t)}},{key:"render",value:function(){return r.createElement(Wt.a,{linkSize:Vt.b.normal},r.createElement(zt.a,{headerText:this.props.intl.formatMessage({id:"app.control.forms.text"}),itemIcon:"PlainText"},r.createElement(D.a,{tokens:S.propertyStackTokens,verticalAlign:!0},this.renderTextControlGroup())),r.createElement(zt.a,{headerText:this.props.intl.formatMessage({id:"app.control.forms.logic"}),itemIcon:"FlowChart"},this.renderLogicControlGroup()),r.createElement(zt.a,{headerText:this.props.intl.formatMessage({id:"app.control.forms.forms"}),itemIcon:"FormLibrary"},this.renderFormControlGroup()))}}]),n}(r.Component),Kt=Object(h.c)(qt);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ToolsPanel.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\controls\\ToolsPanel.js")}}();var Qt=n(268),Jt=n(270);function Zt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var Xt=function(e){u()(a,e);var t,n,o=Zt(a);function a(e,t){var n;i()(this,a),n=o.call(this,e,t),V()(H()(n),"disableWordSelectionEvent",(function(){Office.context.document.removeHandlerAsync("documentSelectionChanged",{handler:this.handleWordSelectionEvent},(function(e){}))})),V()(H()(n),"enableWordSelectionEvent",(function(){Office.context.document.addHandlerAsync("documentSelectionChanged",this.handleWordSelectionEvent,(function(e){}))})),V()(H()(n),"setupMessageChannel",(function(){try{var e=!Object(I.i)();localStorage.setItem(S.STORAGE_KEY_LSTORAGE_SUPPORTED,e)}catch(e){console.log("error: "+e)}})),V()(H()(n),"handleRibbonCommand",(function(){var e=localStorage.getItem(S.CMD_EVENT_TYPE_RIBBON);if(e){localStorage.removeItem(S.CMD_EVENT_TYPE_RIBBON);var t=JSON.parse(e);n.handleUserCommand(t)}})),V()(H()(n),"initalizeyDocumentData",_()(Y.a.mark((function e(){var t,n,r,o,a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("initializing the ddf tree."),e.prev=1,t=new Gt,e.next=5,t.setupRepositoryManager();case 5:if(this.state.autoSave&&t.setupAutoSave(this.state.autoSave),this.registerStorageMonitors(t),this.repoManager=t,this.commander=new Bt(t),n=this.repoManager.getDDF()){e.next=19;break}return r=this.props.intl.formatMessage({id:"app.control.main.defaultDocumentName"}),e.next=14,ae.a.newInstance().createEditDocumentPropertiesCommand(r);case 14:return o=e.sent,e.next=17,this.handleUserCommand(o);case 17:return e.next=19,this.repoManager.setPluginAutoLoad(!0);case 19:return e.next=21,this.repoManager.getDataSourceInStorage();case 21:return a=e.sent,e.next=24,this.repoManager.getDDF();case 24:n=e.sent,this.setState({isReady:!0,ddf:n,dataSource:a}),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(1),console.log(e.t0);case 31:case"end":return e.stop()}}),e,this,[[1,28]])})))),V()(H()(n),"setSelectedControl",(function(e){var t=this.getNodeProperties(e),n=this.handleInitQuickSearch(t);this.setState({selected:t,hideDSTreeEditor:!0,quickSearch:n})})),V()(H()(n),"setErrorMessage",(function(e){this.setState({errormsg:e})})),V()(H()(n),"handleWordSelectionEvent",function(){var e=_()(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=_()(Y.a.mark((function e(t){var r,o,a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=t.document.getSelection(),null==(o=r.parentContentControlOrNullObject)){e.next=7;break}return t.load(o,["tag"]),e.next=7,t.sync();case 7:if(null!=o&&void 0!==o.tag){e.next=13;break}if(null==(o=r.contentControls.getFirstOrNullObject())){e.next=13;break}return t.load(o,["tag"]),e.next=13,t.sync();case 13:a=n.state.ddf.documentId,void 0!==o.tag&&null!==o.tag&&(a=o.tag),n.setSelectedControl(a),e.next=21;break;case 19:e.prev=19,e.t0=e.catch(0);case 21:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),V()(H()(n),"handleUserCommand",function(){var e=_()(Y.a.mark((function e(t){var n=this;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.callback){e.next=5;break}return e.next=3,this.handleCallbackCommand(t,t.callback);case 3:e.next=7;break;case 5:return e.next=7,this.handleCallbackCommand(t,(function(e){n.setSelectedControl(e)}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()),V()(H()(n),"handleCallbackCommand",function(){var e=_()(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.commander.executeCommand(t,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),this.setErrorMessage("Fatal Error: "+e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}()),V()(H()(n),"getNodeProperties",(function(e){console.log("element instance id :"+e+" is focused.");var t=e&&""!=e?n.repoManager.findDDFElement(e):null;return console.log("found element :".concat(t)),t&&null!=t.elementType?Object.assign({},t):null})),V()(H()(n),"setDocumentViewMode",(function(e){n.state.documentViewMode!==e&&n.setState({documentViewMode:e})})),V()(H()(n),"handleInitQuickSearch",(function(e){return e&&e.elementType!==S.DDF_CONTROL_TYPE_DOCUMENT?n.repoManager.findAbsolutedPathOfDDFNode(e):""})),V()(H()(n),"handleSearchDSTreeNode",(function(e){n.setState({quickSearch:e})}));var r=!0;try{var s=Object(I.E)().split(/[-_]/)[0].toLowerCase();r="zh"===s||"cn"===s}catch(e){console.log(e)}return n.state={isReady:!1,isChinese:r,autoSave:!0,selected:{},documentViewMode:ke.a.ContentStructure,ddf:{},dataSource:{},principal:{},propertyGridSize:{currSize:S.PROPERTY_GRID_DEFAULT_SIZE,lastSize:S.PROPERTY_GRID_DEFAULT_SIZE,fullSize:!1},hideDSTreeEditor:!0,errormsg:null},n.repoManager=null,n.commander=null,n}return c()(a,[{key:"componentDidMount",value:(n=_()(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.enableWordSelectionEvent(),this.setupMessageChannel(),e.next=4,this.initalizeyDocumentData();case 4:this.enalbeMessageListener();case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){this.disableWordSelectionEvent(),this.disableMessageListener()}},{key:"handleChannelCommandMessage",value:(t=_()(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t.newValue),Word.run((function(e){return e.document.body.insertText("get data "+t.newValue,Word.InsertLocation.replace),e.sync()}));case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"enalbeMessageListener",value:function(){this.interval=setInterval(this.handleRibbonCommand,300)}},{key:"disableMessageListener",value:function(){clearInterval(this.interval)}},{key:"registerStorageMonitors",value:function(e){var t=this;e.registerDDFModifyMonitor((function(e,n){n&&t.setSelectedControl(n),t.setState({ddf:e,quickSearch:""})})),e.registerDataSourceMonitor((function(e){e&&t.setState({dataSource:e})})),e.registerSigninMonitor((function(e){t.setState({principal:e})}))}},{key:"resizePropertyGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?this.state.propertyGridSize.currSize:e;this.setState({propertyGridSize:{currSize:e,lastSize:n,fullSize:t}})}},{key:"renderMainPanel",value:function(e,t,n){var o=this;return r.createElement(r.Fragment,null,r.createElement(Ce,{treedata:e,handleUserCommand:function(e){return o.handleUserCommand(e)},selected:this.state.selected,setDocumentViewMode:function(e){return o.setDocumentViewMode(e)},hidden:this.state.documentViewMode!==ke.a.ContentStructure}),r.createElement($.a,{key:n,dataHash:n,mode:bt.a.DataPick,treedata:t,handleUserCommand:function(e){return o.handleUserCommand(e)},quickSearch:this.state.quickSearch,onSearch:this.handleSearchDSTreeNode,isChinese:this.state.isChinese,hidden:this.state.documentViewMode!==ke.a.DocumentData}),this.state.documentViewMode===ke.a.ToolBox&&r.createElement(Kt,{handleUserCommand:function(e){return o.handleUserCommand(e)}}))}},{key:"render",value:function(){var e=this;if(!this.state||!this.state.isReady||!this.repoManager)return r.createElement(Jt.a,null);var t=this.repoManager.getDDF(),n="content_body",o=Object(Qt.a)(this.state.dataSource);if(o){var a=JSON.stringify(o);n=Ft.a.newInstance().getHashCode(a)}return r.createElement(Q.a,{split:"horizontal",minSize:"0",onChange:function(t){return e.resizePropertyGrid(t)},defaultSize:this.state.propertyGridSize.currSize,size:this.state.propertyGridSize.currSize},r.createElement("div",{className:"main-panel"},r.createElement(Be,{handleUserCommand:function(t){return e.handleUserCommand(t)},documentViewMode:this.state.documentViewMode,setDocumentViewMode:function(t){return e.setDocumentViewMode(t)},onToggleFullScreen:function(t,n){return e.resizePropertyGrid(t,n)},propertyGridSize:this.state.propertyGridSize,autoSave:this.state.autoSave,principal:this.state.principal}),r.createElement("div",{className:"tree-content"},this.renderMainPanel(t,o,n))),r.createElement("div",{className:"properties-panel"},r.createElement(Et,{treedata:o,dataHash:n,selected:this.state.selected,hideDSTreeEditor:this.state.hideDSTreeEditor,quickSearch:this.state.quickSearch,onSearch:this.handleSearchDSTreeNode,openDataBindPanel:this.openDataBindPanel,closeDataBindPanel:this.closeDataBindPanel,handleUserCommand:function(t){return e.handleUserCommand(t)},onToggleFullScreen:function(t,n){return e.resizePropertyGrid(t,n)},propertyGridSize:this.state.propertyGridSize,isChinese:this.state.isChinese})),this.state.errormsg&&r.createElement(q.a,{messageBarType:K.a.error},this.state.errormsg))}}]),a}(r.Component),$t=Object(h.c)(Xt);function en(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\App.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\App.js")}}();var tn=function(e){u()(n,e);var t=en(n);function n(e){var r;i()(this,n),r=t.call(this,e);var o=!0;try{o=!1!==Object(I.C)(S.STORAGE_KEY_SHOW_LAND_PAGE)}catch(e){}return r.state={loadDesigner:!o},r}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"handleStartDesigner",value:function(){this.setState({loadDesigner:!0})}},{key:"render",value:function(){var e=this;return this.state.loadDesigner?r.createElement($t,null):r.createElement(U,{onStartDesigner:function(){e.handleStartDesigner()}})}}]),n}(r.Component),nn=Object(h.c)(tn);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\bootstrap\\index.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\bootstrap\\index.js")}}();var rn=n(714),on=n(273),an=n(271),sn=n(199),cn=n(186),ln=n(272),un="en",pn={cn:cn,zh:cn,en:ln};Object(an.initializeIcons)();var dn=function(e){un=(un=Object(I.E)()).split(/[-_]/)[0].toLowerCase(),console.log(un),o.render(r.createElement(rn.a,{locale:un,messages:pn[un]},r.createElement(on.AppContainer,null,r.createElement(sn.a,null,r.createElement(e,{title:r.createElement(v.a,{id:"title"})})))),document.getElementById("container"))};Office.onReady((function(e){e.host===Office.HostType.Word&&dn(nn)})),dn(Jt.a),function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\index.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\index.js")}}()},30:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.childrenField="children",e.elementIdField="elementId",e.elementNameField="elementName",e.elementTypeField="elementType",e.defaultValueField="defaultValue",e.dataSourceIdField="dataSourceId",e.dataSourceNameField="dataSourceName",e.dataContentField="dataContent",e.documentIdField="documentId",e.documentNameField="documentName",e.dataSourcesField="dataSources",e.dataBindField="dataBind",e.chartDataMappingField="chartDataMapping",e.expressionField="expression",e.dataViewsField="dataViews",e.hiddenField="hidden",e.parentField="parent",e.chartSeriesField="series",e.barcodeTypeField="barcodeType",e.versionField="version",e.barcodeHeightField="barHeight",e.barcodeModuleWidthField="moduleWidth",e.barcodeSettingsField="barcodeSettings",e.barcodeQRVersionField="qrCodeVersion",e.barcodeQRECLevelField="qrECLevel",e.barcodePDF417ECLevelField="pdf417ECLevel",e.humanReadablePositionField="humanReadablePosition",e.barcodeColumnsField="columns",e.dropdownOptionField="dropdownOption",e.selectedBindField="selectedBindField",e.checkboxGroupField="checkboxGroup"}(r||(r={})),t.default=r},711:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r=n(8),o=n.n(r),a=n(15),i=n.n(a),s=n(6),c=n.n(s),l=n(4),u=n.n(l),p=n(2),d=n(10),f=n(108),m=n.n(f),h=function t(n){var r=this;i()(this,t),c()(this,"getDialogResult",(function(){if(r.dialogResult){var t=Object.assign({},r.dialogResult);return r.dialogResult=null,e.resolve(t)}return new e((function(e){r.resultResolver=e}))})),c()(this,"setDialogResult",(function(e){r.dialogResult=e,r.resultResolver&&(r.resultResolver(r.dialogResult),r.resultResolver=null)})),c()(this,"setErrorMessage",(function(e){r.setDialogResult({error:e})})),c()(this,"getDlgHeight",(function(e){return e&&e.dialog&&e.dialog.height?e.dialog.height:40})),c()(this,"getDlgWidth",(function(e){return e&&e.dialog&&e.dialog.width?e.dialog.width:40})),c()(this,"getDialogUrl",(function(e){return window.location.origin+"/dialogbox.html"})),c()(this,"setLocalStorageCommand",(function(e){try{var t;localStorage&&localStorage.setItem(p.STORAGE_KEY_DLG_COMMAND,r.command),null!=e&&null!==(t=e.authConfig)&&void 0!==t&&t.required&&(console.log("dialog command stored"),localStorage.removeItem(p.STORAGE_KEY_AUTH_REQUESTED))}catch(e){console.log(e),console.log("local storage is not supported by browser.")}})),c()(this,"handleDialogCommand",function(){var t=o()(u.a.mark((function t(n){var o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.command=JSON.stringify(n),console.log("handling dialog"),m.a.newInstance().isLocalStorageUsed()&&(console.log("local storage is used."),r.setLocalStorageCommand(n)),o=new e((function(e){var t,o,a=r.getDlgHeight(n),i=r.getDlgWidth(n);Office.context.ui.displayDialogAsync(r.getDialogUrl(n),{height:a,width:i,promptBeforeOpen:!1,displayInIframe:!(null!==(t=n.authConfig)&&void 0!==t&&t.required||null!==(o=n.authConfig)&&void 0!==o&&o.logout)},(function(t){if("failed"==t.status){switch(t.error.code){case 12004:r.setErrorMessage("Domain is not trusted");break;case 12005:r.setErrorMessage("HTTPS is required");break;case 12007:r.setErrorMessage("A dialog is already opened.");break;default:r.setErrorMessage(t.error.message)}r.setDialogResult({error:t.error.code}),e(null)}else r.dialog=t.value,r.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(t){r.dialogMessageHandler(t.message),e(r)})),r.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(t){r.dialogEventHandler(t),e(r)}))}))})),t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),c()(this,"dialogMessageHandler",function(){var e=o()(u.a.mark((function e(t){var n,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("get message from dialog"),(n=JSON.parse(t))&&!0===n.keep||(r.dialog.close(),r.dialog=null),!0!==n.dialogReady){e.next=7;break}return console.log("send message to dialog."),Object(d.H)(r.dialog,r.command),e.abrupt("return");case 7:if(!0!==n.requestDS){e.next=14;break}return console.log("request for datasource"),e.next=11,r.repoManager.getDataSourceInStorage();case 11:return o=e.sent,Object(d.H)(r.dialog,JSON.stringify(o)),e.abrupt("return");case 14:if(!n.principal){e.next=17;break}return r.repoManager.updateStoredPrincipal(n.principal),e.abrupt("return");case 17:if(!0!==n.updateCommand){e.next=20;break}return r.command=n.command,e.abrupt("return");case 20:r.setDialogResult({result:n,dialogWindow:r.dialog});case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c()(this,"closeDialog",(function(){r.dialog&&r.dialog.close()})),c()(this,"dialogEventHandler",(function(e){switch(e.error){case 12002:r.setErrorMessage("Cannot load URL, no such page or bad URL syntax.");break;case 12003:r.setErrorMessage("HTTPS is required.");break;case 12006:r.setErrorMessage("Dialog closed by user");break;default:r.setErrorMessage("Undefined error in dialog window")}})),this.repoManager=n,this.dialog=null,this.resultResolver=null,this.command="",this.dialogResult=null};!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==t?t:exports;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YDialogCommand.js")}}else e.register(n,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\taskpane\\components\\common\\commands\\YDialogCommand.js")}}()}).call(this,n(88).Promise)}});
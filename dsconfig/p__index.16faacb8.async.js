(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{QeBL:function(e,a,t){"use strict";t.r(a),t.d(a,"AppWrapper",(function(){return h}));t("T2oS");var n=t("W9HT"),i=(t("fOrg"),t("+KLJ")),o=(t("miYZ"),t("tsqr")),s=t("ODXe"),r=t("q1tI"),c=t.n(r),l=t("9kvl"),f=t("LvDl"),d=t("o0o1"),u=t.n(d),g=t("HaE+"),p=t("LtsZ"),m=Object(p["dynamic"])({loader:function(){var e=Object(g["a"])(u.a.mark((function e(){var a,n;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(3),t.e(0)]).then(t.bind(null,"rhp1"));case 2:return a=e.sent,n=a.default,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));function a(){return e.apply(this,arguments)}return a}()}),v=t("okkz"),O="dialogcmd",y="localstorage-used",h=function(e){var a=Object(r["useState"])(!1),t=Object(s["a"])(a,2),d=t[0],u=t[1],g=Object(r["useState"])(!0),p=Object(s["a"])(g,2),h=p[0],b=p[1],S=Object(r["useState"])(!1),w=Object(s["a"])(S,2),M=w[0],T=w[1],j=Object(l["e"])("entity-metadata-loader"),C=j.dataSource,k=j.setAccessToken,E=j.setDataSource,D=function(e){var a=Object(f["cloneDeep"])(C);a.dataSourceId=e.dataSourceId,a.dataSourceName=e.dataSourceName,a.dataUri=e.dataUri,a.sourceType=e.sourceType,(null===e||void 0===e?void 0:e.dataContent)&&(a.dataContent=e.dataContent),(null===e||void 0===e?void 0:e.erMappingSchema)&&(a.erMappingSchema=e.erMappingSchema),(null===e||void 0===e?void 0:e.databaseType)?a.databaseType=e.databaseType:a.sourceType===v["b"].DataSourceDriver.Database&&(a.databaseType=v["b"].DatabaseType.MySQL),(null===e||void 0===e?void 0:e.erMappingContent)&&(a.erMappingContent=e.erMappingContent),E(a)},L=function(){var e=!1;try{e="true"===localStorage.getItem(y)}catch(a){e=!1}return e},N=function(e){if(console.log("receive office message from dialog parent."),e&&e.message){var a,t=JSON.parse(e.message);D(t.node),k(null===(a=t.authConfig)||void 0===a?void 0:a.accessToken)}console.log(e.message),T(!0)},x=function(){var e=Office.context.displayLanguage||"en-US",a=e.split("-");2===a.length&&(e=a[0].toLowerCase()+"-"+a[1].toUpperCase()),"zh"===e.toLowerCase()&&(e="zh-CN"),"zh-CN"!==e&&(e="en-US"),console.log(e),Object(l["d"])(e,!1)},J=function(a){a.status!==Office.AsyncResultStatus.Succeeded&&o["default"].error(e.intl.formatMessage({id:"message.registerhdlerror",defaultMessage:"Error, Office Runtime is not initialized successfully, please close the dialog and try again."}));try{console.log("sending dialog ready message."),Office.context.ui.messageParent(JSON.stringify({keep:!0,dialogReady:!0}))}catch(t){console.log(t)}u(!0)};Object(r["useEffect"])((function(){if(!M&&L())try{var e=localStorage.getItem(O);if(e){var a;localStorage.removeItem(O);var t=JSON.parse(e);D(t.node),k(null===(a=t.authConfig)||void 0===a?void 0:a.accessToken)}T(!0)}catch(n){console.log(n)}}),[M]),Object(r["useEffect"])((function(){Office.onReady((function(a){if(console.log("office ready called."),a.host!==Office.HostType.Word)o["default"].warn(e.intl.formatMessage({id:"message.notoffice",defaultMessage:"Warning,You are not in Office word context, some functionality in this moudle might be limited!"})),u(!1);else try{Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,N,{},J)}catch(t){console.log(t)}b(!1),x()}))}),[]);var z=function(a){if(Office){var t=JSON.stringify(a);console.log(t),Office.context.ui.messageParent(t)}else o["default"].error(e.intl.formatMessage({id:"message.office.load.failed"}))},I=e.intl.formatMessage({id:"message.office.loading",defaultMessage:"Office Plugin is Loading..."});if(h){var P=e.intl.formatMessage({id:"message.office.loading.desc",defaultMessage:"The application is loading the Office plugin, please wait for a while..."});return c.a.createElement(n["a"],{spinning:h},c.a.createElement(i["a"],{message:I,description:P,type:"info"}))}if(d&&!M){var R=e.intl.formatMessage({id:"message.office.cmdwaiting.desc",defaultMessage:"The application is waiting for initialize message, please wait for a while..."});return c.a.createElement(n["a"],{spinning:!M},c.a.createElement(i["a"],{message:I,description:R,type:"info"}))}return c.a.createElement(m,{isOfficeWrapped:d,onFinishSetting:z})};a["default"]=Object(l["b"])(h)}}]);
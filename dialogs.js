!function(e){function t(t){for(var n,s,i=t[0],l=t[1],c=t[2],p=0,d=[];p<i.length;p++)s=i[p],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(u&&u(t);d.length;)d.shift()();return a.push.apply(a,c||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,i=1;i<r.length;i++){var l=r[i];0!==o[l]&&(n=!1)}n&&(a.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},o={13:0},a=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var i=window.webpackJsonp=window.webpackJsonp||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;a.push([1361,0,1,4,3,9,7,8,2,5,6,10]),r()}({1361:function(e,t,r){r(538),e.exports=r(1362)},1362:function(e,t,r){"use strict";r.r(t),function(e){var n=r(8),o=r.n(n),a=r(4),s=r.n(a),i=r(0),l=r(181),c=r(714),u=r(273),p=r(271),d=r(574),f=r(270),g=r(199),m=r(186),h=r(272),v=r(155),y=r(2),x=r(10),E=r(108),S=r.n(E),b=r(232),w="en",O={cn:m,zh:m,en:h};function k(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}Object(p.initializeIcons)();var R=function(e,t){l.render(i.createElement(c.a,{locale:w,messages:O[w]},i.createElement(u.AppContainer,null,i.createElement(g.a,null,i.createElement(e,t)))),document.getElementById("container"))};function D(e){var t,r,n;console.log("handling dialog message...");var o,a=JSON.parse(e);return console.log(a),!0===(null===(t=a.authConfig)||void 0===t?void 0:t.logout)?(null!==(o=a.authConfig)&&void 0!==o&&o.accessToken&&M({keep:!0,principal:{accessToken:null,userName:null,userEmail:null,userServiceLevel:0}}),void function(e){console.log("setup logout redirect.");var t=k("redirect");console.log("is redirect already done? "+t),"true"!==t?(console.log("redirecting..."),window.location.href=Object(v.b)()):R(b.a,{node:e,message:"dialog.auth.message.logout"})}(a)):(console.log("authenticate required? "+(!0===(null===(r=a.authConfig)||void 0===r?void 0:r.required))),null!==(n=a.authConfig)&&void 0!==n&&n.required?(console.log("authenticate required, start authenticate process..."),void function(e){var t;console.log("try to sigin user!");var r=e.commandName===y.CMD_SIGNUP_USER;(function(e){console.log("try signin current user......");var t=Object(v.c)(),r=Object(v.d)(t,e);return console.log("getLoginUserInfo promise created."),r})(r?null:null===(t=e.authConfig)||void 0===t?void 0:t.accessToken).then((function(t){var n,o;console.log("get the signin response."),console.log("status code: "+t.status),200===t.status&&(null===(n=t.data)||void 0===n||null===(o=n.accessToken)||void 0===o?void 0:o.length)>0?(console.log("signin successfully!"),function(e,t,r,n,o){if(o.commandName===y.CMD_SIGNIN_USER||o.commandName===y.CMD_SIGNUP_USER)return o.node={accessToken:e,userName:t,userEmail:r,userServiceLevel:n},void M(o);if(M({keep:!0,principal:{accessToken:e,userName:t,userEmail:r,userServiceLevel:n}}),o.authConfig.accessToken=e,o.commandName===y.CMD_EDIT_DOCUMENT_CUSTOMDATA){var a=JSON.stringify(o);return console.log("processing datasource configuration request..."),S.a.newInstance().isLocalStorageUsed()?(console.log("save command to local storage."),localStorage.setItem(y.STORAGE_KEY_DLG_COMMAND,a)):(console.log("send authenticate command update."),M({keep:!0,updateCommand:!0,command:a})),void setTimeout((function(){console.log("redirecting to datasource configuraiton page."),window.location.href=window.location.origin+"/dsconfig/index.html"}),1e3)}console.log("create requested user interface."),R(d.a,o)}(t.data.accessToken,t.data.userName,t.data.userEmail,t.data.userServiceLevel,e)):(console.log("signin failed, redirect user to login screen!"),P(r))})).catch((function(e){console.log(e),console.log("signin failed, redirect user to login screen!"),P(r)}))}(a)):(console.log("rendering dialog UI."),void R(d.a,a)))}function P(e){console.log("setup login redirect.");var t=k("redirect");console.log("is redirect already done? "+t),"true"!==t?(console.log("redirecting..."),window.location.href=Object(v.a)(e)):R(b.a,{node:{error:"login failed"},message:"dialog.auth.error.login"})}function M(e){console.log("sending dialog message to parent."),Office.context.ui.messageParent(JSON.stringify(e)),console.log("parent dialog message sent!")}Office.onReady((function(t){console.log("startup office dialog..."),t.host===Office.HostType.Word?(console.log("initialize locale..."),w=(w=Office.context.displayLanguage||"en").split(/[-_]/)[0].toLowerCase(),console.log("deal with dialog logic..."),new e((function(e,t){try{console.log("check dialog environment");var r=S.a.newInstance().isLocalStorageUsed();console.log("using localstorage? "+r),r?function(e,t){try{console.log("get dialog command by localstorage method.");for(var r=localStorage.getItem(y.STORAGE_KEY_DLG_COMMAND);!r;)r=localStorage.getItem(y.STORAGE_KEY_DLG_COMMAND);console.log("localstorage command received!"),e(r)}catch(e){console.log("error when try to get the localstorage command."),t(e)}}(e,t):function(e){console.log("Registering DialogParentMessageReceived event."),Object(x.G)((function(t){console.log("receive message from parent event."),e(t.message)}),(function(e){e.status===Office.AsyncResultStatus.Succeeded?(console.log("DialogParentMessageReceived event Registered."),M({keep:!0,dialogReady:!0})):console.log("DialogParentMessageReceived event Register Failed.")}))}(e)}catch(e){t(e)}})).then(function(){var e=o()(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e),R(b.a,{node:{error:e},message:"dialog.error.startup"})}))):console.log("terminate for it is not in office Word context.")})),R(f.a),function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\dialogindex.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\dialogindex.js")}}()}.call(this,r(88).Promise)},226:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(15),o=r.n(n),a=r(17),s=r.n(a),i=r(19),l=r.n(i),c=r(20),u=r.n(c),p=r(11),d=r.n(p),f=r(0),g=r(462),m=r(35);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=d()(e);if(t){var o=d()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u()(this,r)}}var v=function(e){l()(r,e);var t=h(r);function r(e,n){return o()(this,r),t.call(this,e,n)}return s()(r,[{key:"clearErrorMessage",value:function(){this.props.clearErrorMessage&&this.props.clearErrorMessage()}},{key:"render",value:function(){var e=this;return!this.props.message||this.props.message.length<=0?null:f.createElement(g.a,{className:"errormessage",messageBarType:this.props.isError?m.a.error:m.a.warning,isMultiline:this.props.isMultiline,onDismiss:function(){return e.clearErrorMessage()},dismissButtonAriaLabel:"Close"},"function"==typeof this.props.message?this.props.message():this.props.message)}}]),r}(f.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\SimpleMessageBar.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\SimpleMessageBar.js")}}()},227:function(e,t,r){"use strict";var n=r(318),o=r.n(n),a=r(0),s=r(281),i=r(80),l=r(278),c=r(463);t.a=function(e){var t,r;return e.dialog?a.createElement(i.a.Item,{disableShrink:!0},a.createElement(i.a,o()({horizontal:!0},{tokens:{childrenGap:1}}),a.createElement(i.a.Item,{align:"center"},a.createElement("img",{src:"assets/logo-filled.png",width:48,height:48})),a.createElement(i.a.Item,{grow:!0,align:"center"},a.createElement(l.a,{block:!0,variant:"large"},e.dialog?a.createElement(s.a,{id:null===(t=e.dialog)||void 0===t?void 0:t.title}):""),a.createElement(l.a,{variant:"medium"},e.dialog?a.createElement(s.a,{id:null===(r=e.dialog)||void 0===r?void 0:r.description}):""))),a.createElement(i.a,null,a.createElement(c.a,null))):null},function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DialogHeader.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DialogHeader.js")}}()},228:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n=r(15),o=r.n(n),a=r(17),s=r.n(a),i=r(13),l=r.n(i),c=r(19),u=r.n(c),p=r(20),d=r.n(p),f=r(11),g=r.n(f),m=r(6),h=r.n(m),v=r(0),y=r(281),x=r(80),E=r(182),S=r(2);var b=function(e){var t={alignItems:"center",display:"flex",justifyContent:"center",width:100,margin:10};return v.createElement(x.a,{verticalAlign:"center"},v.createElement(x.a,{horizontal:!0,horizontalAlign:"center"},v.createElement(E.a,{text:v.createElement(y.a,{id:"action.OK"}),iconProps:S.btnIconOK,style:t,onClick:function(){return e.onOkClick()}}),v.createElement(E.a,{text:v.createElement(y.a,{id:"action.Cancel"}),iconProps:S.btnIconCancel,style:t,onClick:function(){return e.onCancelClick()}})))};!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DialogButtons.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DialogButtons.js")}}();var w=r(463);function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var o=g()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var k=function(e){u()(r,e);var t=O(r);function r(e,n){var a;return o()(this,r),a=t.call(this,e,n),h()(l()(a),"handleOkClick",(function(){null!==a.props.sendMessage&&a.props.sendMessage(a.props.formData)})),h()(l()(a),"handleCancelClick",(function(){null!==a.props.sendMessage&&a.props.sendMessage({error:"user canceled"})})),a}return s()(r,[{key:"render",value:function(){var e=this;return this.props.showButtons?v.createElement(x.a,{className:"dialogactionpanel",verticalAlign:!0},v.createElement(x.a.Item,null,v.createElement(w.a,{style:{root:{backgroundColor:"darkgray"}}})),v.createElement(x.a.Item,{align:"center"},v.createElement(b,{onOkClick:function(){return e.handleOkClick()},onCancelClick:function(){return e.handleCancelClick()}}))):null}}]),r}(v.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DialogFooter.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DialogFooter.js")}}()},232:function(e,t,r){"use strict";var n=r(76),o=r.n(n),a=r(15),s=r.n(a),i=r(17),l=r.n(i),c=r(13),u=r.n(c),p=r(19),d=r.n(p),f=r(20),g=r.n(f),m=r(11),h=r.n(m),v=r(6),y=r.n(v),x=r(0),E=r(80),S=r(237),b=r(227),w=r(228),O=r(226);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var R=function(e){d()(r,e);var t=k(r);function r(e,n){var a;return s()(this,r),a=t.call(this,e,n),y()(u()(a),"sendMessageToParent",(function(e){var t=e;"object"!==o()(e)&&"string"!=typeof e||(t=JSON.stringify(e)),Office.context.ui.messageParent(t)})),a}return l()(r,[{key:"render",value:function(){var e,t,r=this,n=this.props.intl;return x.createElement(E.a,{grow:!0,tokens:{childrenGap:1},style:{padding:10}},x.createElement(b.a,{dialog:this.props.dialog}),x.createElement(E.a.Item,{align:"center",verticalFill:!0},x.createElement(E.a,{verticalAlign:"center"},x.createElement(O.a,{isMultiline:!0,isError:!(null===(e=this.props.node)||void 0===e||!e.error),message:null!==(t=this.props.message)&&void 0!==t&&t.formattedMessage?this.props.message.formattedMessage:n.formatMessage({id:this.props.message})}))),x.createElement(E.a.Item,null,x.createElement(w.a,{formData:this.props.node,sendMessage:function(e){return r.sendMessageToParent(e)},showButtons:!0})))}}]),r}(x.Component);t.a=Object(S.c)(R),function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\MessageBox.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\MessageBox.js")}}()},303:function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.default=e.exports,e.exports.__esModule=!0},318:function(e,t){function r(){return e.exports=r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,r.apply(this,arguments)}e.exports=r,e.exports.default=e.exports,e.exports.__esModule=!0},54:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogicOperator=t.ExpressionOperator=t.ExpressionValueType=void 0,function(e){e.DataBind="databind",e.Value="value"}(t.ExpressionValueType||(t.ExpressionValueType={})),function(e){e.Equal="equal",e.NoEqual="noequal",e.GreatEqual="greatequal",e.LessEqual="lessequal",e.GreatThan="greatthan",e.LessThan="lessthan",e.Contains="contains"}(t.ExpressionOperator||(t.ExpressionOperator={})),function(e){e.And="and",e.Or="or"}(t.LogicOperator||(t.LogicOperator={}))},540:function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"==typeof btoa){var o=(s=n,i=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(l," */")),a=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[r].concat(a).concat([o]).join("\n")}var s,i,l;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,n){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(n)for(var a=0;a<this.length;a++){var s=this[a][0];null!=s&&(o[s]=!0)}for(var i=0;i<e.length;i++){var l=[].concat(e[i]);n&&o[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},541:function(e,t,r){var n,o,a={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=n.apply(this,arguments)),o}),i=function(e,t){return t?t.querySelector(e):document.querySelector(e)},l=function(e){var t={};return function(e,r){if("function"==typeof e)return e();if(void 0===t[e]){var n=i.call(this,e,r);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),c=null,u=0,p=[],d=r(542);function f(e,t){for(var r=0;r<e.length;r++){var n=e[r],o=a[n.id];if(o){o.refs++;for(var s=0;s<o.parts.length;s++)o.parts[s](n.parts[s]);for(;s<n.parts.length;s++)o.parts.push(x(n.parts[s],t))}else{var i=[];for(s=0;s<n.parts.length;s++)i.push(x(n.parts[s],t));a[n.id]={id:n.id,refs:1,parts:i}}}}function g(e,t){for(var r=[],n={},o=0;o<e.length;o++){var a=e[o],s=t.base?a[0]+t.base:a[0],i={css:a[1],media:a[2],sourceMap:a[3]};n[s]?n[s].parts.push(i):r.push(n[s]={id:s,parts:[i]})}return r}function m(e,t){var r=l(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=p[p.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),p.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=l(e.insertAt.before,r);r.insertBefore(t,o)}}function h(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=p.indexOf(e);t>=0&&p.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=function(){0;return r.nc}();n&&(e.attrs.nonce=n)}return y(t,e.attrs),m(e,t),t}function y(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}function x(e,t){var r,n,o,a;if(t.transform&&e.css){if(!(a="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=a}if(t.singleton){var s=u++;r=c||(c=v(t)),n=b.bind(null,r,s,!1),o=b.bind(null,r,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),m(e,t),t}(t),n=O.bind(null,r,t),o=function(){h(r),r.href&&URL.revokeObjectURL(r.href)}):(r=v(t),n=w.bind(null,r),o=function(){h(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=g(e,t);return f(r,t),function(e){for(var n=[],o=0;o<r.length;o++){var s=r[o];(i=a[s.id]).refs--,n.push(i)}e&&f(g(e,t),t);for(o=0;o<n.length;o++){var i;if(0===(i=n[o]).refs){for(var l=0;l<i.parts.length;l++)i.parts[l]();delete a[i.id]}}}};var E,S=(E=[],function(e,t){return E[e]=t,E.filter(Boolean).join("\n")});function b(e,t,r,n){var o=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=S(t,o);else{var a=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(a,s[t]):e.appendChild(a)}}function w(e,t){var r=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function O(e,t,r){var n=r.css,o=r.sourceMap,a=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||a)&&(n=d(n)),o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var s=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(s),i&&URL.revokeObjectURL(i)}},542:function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var o,a=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(o=0===a.indexOf("//")?a:0===a.indexOf("/")?r+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},543:function(e,t,r){var n=r(303);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.default=e.exports,e.exports.__esModule=!0},544:function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0},545:function(e,t,r){var n=r(303);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},546:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},574:function(e,t,r){"use strict";r.d(t,"a",(function(){return Re}));var n=r(76),o=r.n(n),a=r(15),s=r.n(a),i=r(17),l=r.n(i),c=r(13),u=r.n(c),p=r(19),d=r.n(p),f=r(20),g=r.n(f),m=r(11),h=r.n(m),v=r(6),y=r.n(v),x=r(0),E=r(80),S=r(278),b=r(462),w=r(35),O=r(2),k=r(199),R=r(201),D=r(698),P=r(259),M=r(704),C=r(94),j=r(237),I=r(10),L=r(200),A=r(86),B=r.n(A),T=r(7),N=r(1384),V=r(440),G=r(55),_=r(51),F=r(281),U=r(438),W=r(702),H=r(142),z=r(53),q=r.n(z);function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var J=function(e){d()(r,e);var t=K(r);function r(e,n){var o;return s()(this,r),o=t.call(this,e,n),y()(u()(o),"renderAssembly",(function(e){var t="progresszone-primary",r="Accept";if(e.currentStep===z.PreviewStep.PreparingDocument)return x.createElement(x.Fragment,null);var n=new q.a(e).getStepData(z.PreviewStep.AssemblyDocument);(null==n?void 0:n.completePercentage)>=1&&(t="progresszone-success"),e.error&&e.currentStep===z.PreviewStep.AssemblyDocument&&(t="progresszone-error",r="Clear");var a=n.completePercentage<1&&!e.error;return o.renderProgressIndicator(x.createElement(F.a,{id:"app.progress.step.assembly.title"}),x.createElement(F.a,{id:"app.progress.step.assembly.desc"}),a,e.currentStep===z.PreviewStep.AssemblyDocument?"progresszone-last":"progresszone",t,r)})),y()(u()(o),"renderGenerating",(function(e){var t,r="progresszone-primary",n="Accept";if(e.currentStep===z.PreviewStep.PreparingDocument||e.currentStep===z.PreviewStep.AssemblyDocument)return x.createElement(x.Fragment,null);var a=new q.a(e).getStepData(z.PreviewStep.GenerateResult);return(null==a?void 0:a.completePercentage)>=1&&(r="progresszone-success"),e.error&&e.currentStep===z.PreviewStep.GenerateResult&&(r="progresszone-error",n="Clear"),t=(null==a?void 0:a.completePercentage)<1&&!e.error,o.renderProgressIndicator(x.createElement(F.a,{id:"app.progress.step.getresult.title"}),x.createElement(F.a,{id:"app.progress.step.getresult.desc"}),t,"progresszone-last",r,n)})),o}return l()(r,[{key:"renderPreparing",value:function(e){var t=new q.a(e).getStepData(z.PreviewStep.PreparingDocument),r=t.completePercentage<1&&!e.error,n="progresszone-primary",o="Accept";return e.error&&e.currentStep===z.PreviewStep.PreparingDocument&&(n="progresszone-error",o="Clear"),t.completePercentage>=1&&(n="progresszone-success"),this.renderProgressIndicator(x.createElement(F.a,{id:"app.progress.step.preparing.title"}),x.createElement(F.a,{id:"app.progress.step.preparing.desc"}),r,e.currentStep===z.PreviewStep.PreparingDocument?"progresszone-single":"progresszone-first",n,o)}},{key:"renderProgressIndicator",value:function(e,t,r,n,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"Accept";return x.createElement(E.a.Item,{className:n,align:"center"},x.createElement(U.a,{className:o},x.createElement(E.a,{horizontal:!0},x.createElement(E.a.Item,null,r&&x.createElement(W.a,{size:H.a.small}),!r&&x.createElement(R.a,{iconName:a})),x.createElement(E.a.Item,null,x.createElement(E.a,{verticalAlign:!0},x.createElement(E.a.Item,null,e),x.createElement(E.a.Item,null,t))))))}},{key:"render",value:function(){var e=this.props.progressState;return x.createElement(E.a,{verticalFill:!0,horizontal:!0,horizontalAlign:"center"},this.renderPreparing(e),this.renderAssembly(e),this.renderGenerating(e))}}]),r}(x.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\ProgressBar.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\ProgressBar.js")}}();var Y=r(108),$=r.n(Y);function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var Z=function(e){d()(r,e);var t=X(r);function r(e,n){var o;return s()(this,r),o=t.call(this,e,n),y()(u()(o),"processDialogProgressMsg",(function(e){console.log("receive updated Message from parent event."),o.processProgressMessage(e.message)})),y()(u()(o),"startMonitor",(function(){o.setState({timer:setInterval((function(){o.sync()}),100)})})),y()(u()(o),"clearTimer",(function(){o.state.timer&&clearInterval(o.state.timer)})),y()(u()(o),"willClosed",(function(){var e,t,r;return(null===(e=o.state.progressState)||void 0===e||null===(t=e.error)||void 0===t?void 0:t.length)>0?(o.clearTimer(),o.props.sendMessage({keep:!0}),!1):!(!o.state.progressState||(null===(r=o.state.progressState)||void 0===r?void 0:r.progress)!=z.ProgressStatus.Completed)&&(o.clearTimer(),o.props.sendMessage({keep:!1}),!0)})),y()(u()(o),"sync",(function(){var e=localStorage.getItem(O.LOCAL_STORE_KEY_PROGRESS);console.log("current progressStateStr: "+e),e&&o.processProgressMessage(e)})),y()(u()(o),"processProgressMessage",(function(e){var t=JSON.parse(e);if(console.log(e),t.error){if(console.log("get error "+t.error),o.props.reportErrorMessage){console.log("report error message...");var r=o.props.intl.formatMessage({id:"dialog.progressbar.error"},{error:o.props.intl.formatMessage({id:t.error})});o.props.reportErrorMessage(r)}o.props.onShowButtons&&o.props.onShowButtons(!0)}o.setState({progressState:t})})),o.state={progressState:{},timer:null},o}return l()(r,[{key:"componentDidMount",value:function(){var e=this;if(this.props.onShowButtons&&this.props.onShowButtons(!1),$.a.newInstance().isLocalStorageUsed()){console.log("setup local storage message licener..."),this.startMonitor();var t=Object.assign({},this.props.formData);t.keep=!0,t.authConfig=this.props.authConfig,t.designRecord=this.props.designRecord,this.props.sendMessage(t)}else console.log("register update message listener..."),Object(I.G)(this.processDialogProgressMsg,(function(t){if(t.status===Office.AsyncResultStatus.Succeeded){console.log("DialogParentMessageReceived event Registered.");var r=Object.assign({},e.props.formData);r.keep=!0,r.authConfig=e.props.authConfig,r.designRecord=e.props.designRecord,e.props.sendMessage(r)}else console.log("DialogParentMessageReceived event Register Failed.")}))}},{key:"componentWillUnmount",value:function(){this.clearTimer()}},{key:"render",value:function(){var e;return this.willClosed()?null:this.state.progressState&&null!==(e=this.state.progressState)&&void 0!==e&&e.currentStep?x.createElement(J,{progressState:this.state.progressState}):x.createElement(W.a,{size:H.a.large})}}]),r}(x.Component),Q=Object(j.c)(Z);function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\ProgressForm.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\ProgressForm.js")}}();var te=Object(T.mergeStyleSets)({fileIconHeaderIcon:{padding:0,fontSize:"16px"},fileIconCell:{textAlign:"center",selectors:{"&:before":{content:".",display:"inline-block",verticalAlign:"middle",height:"100%",width:"0px",visibility:"hidden"}}},fileIconImg:{verticalAlign:"middle",maxHeight:"16px",maxWidth:"16px"},controlWrapper:{display:"flex",flexWrap:"wrap"},exampleToggle:{display:"inline-block",marginBottom:"10px",marginRight:"30px"},selectionDetails:{marginBottom:"20px"}}),re=function(e){d()(r,e);var t=ee(r);function r(e,n){var a;return s()(this,r),a=t.call(this,e,n),y()(u()(a),"getObjectName",(function(e){if(Array.isArray(e)&&e.length>0)return a.getObjectName(e[0]);if("object"===o()(e))for(var t=Object.keys(e),r=0;r<t.length;r++){var n=t[r];if("string"==typeof e[n])return e[n];if("object"===o()(e[n]))return a.getObjectName(e[n])}return a.props.intl.formatMessage({id:"dialog.previewform.cplxobj"})})),y()(u()(a),"setupDataSource",(function(e){var t=[];if(e&&e.length>0){var r=JSON.parse(e);if(Array.isArray(null==r?void 0:r.dataContent)){if(1===r.dataContent.length)return void a.setState({showPreviewProcess:!0,selectedRecord:r.dataContent[0]});for(var n=0;n<r.dataContent.length;n++){var o=r.dataContent[n],s=a.getObjectName(o);t.push({recordindex:n,recordname:s,recordlink:o})}return void a.setState({dataSource:r,designRecords:t})}a.setState({showPreviewProcess:!0,selectedRecord:null==r?void 0:r.dataContent})}})),y()(u()(a),"handleDataSourceParentMsg",(function(e){console.log("receive datasource from parent event."),a.state.showPreviewProcess||a.setupDataSource(e.message)})),y()(u()(a),"handleSelectedItem",(function(e){a.setState({selectedRecord:null==e?void 0:e.recordlink})})),y()(u()(a),"handleSelectedRecordPreview",(function(){a.setState({showPreviewProcess:!0})})),y()(u()(a),"handleShowDetails",(function(e){var t=Object.assign({},a.state.dataSource);t.dataContent=e.recordlink,a.setState({showDetailsPanel:!0,recordToShow:t})})),a.state={designRecords:[],dataSource:null,selectedRecord:null,showPreviewProcess:!1,showDetailsPanel:!1,recordToShow:null},a.selection=new N.a({onSelectionChanged:function(){a.setState({selectedRecord:a.getSelectionDetails()})}}),a}return l()(r,[{key:"getSelectionDetails",value:function(){var e,t=this.selection.getSelection();return t&&t.length>0?null===(e=t[0])||void 0===e?void 0:e.recordlink:null}},{key:"componentDidMount",value:function(){var e=this;if($.a.newInstance().isLocalStorageUsed()){var t=localStorage.getItem(O.STORAGE_KEY_DATASOURCE);console.log("local storage datasource processing..."),console.log("dsDataString === null ?"+t===null),console.log("clear the previous progress status..."),localStorage.removeItem(O.LOCAL_STORE_KEY_PROGRESS),this.state.showPreviewProcess||this.setupDataSource(t)}else console.log("Message Handler datasource processing..."),Object(I.G)(this.handleDataSourceParentMsg,(function(t){t.status===Office.AsyncResultStatus.Succeeded?(console.log("DialogParentMessageReceived event Registered."),e.props.sendMessage({keep:!0,requestDS:!0})):console.log("DialogParentMessageReceived event Register Failed.")}));this.props.onShowButtons&&this.props.onShowButtons(!1)}},{key:"closeDetailsPanel",value:function(){this.setState({showDetailsPanel:!1})}},{key:"initColums",value:function(){var e=this;return[{key:"column_type",name:this.props.intl.formatMessage({id:"dialog.previewform.column.type"}),className:te.fileIconCell,iconClassName:te.fileIconHeaderIcon,ariaLabel:"data source record",iconName:O.dataTableRowIcon.iconName,fieldName:"recordindex",minWidth:16,maxWidth:16,onRender:function(e){return x.createElement(R.a,{iconName:O.dataTableRowIcon.iconName})}},{key:"column_index",name:this.props.intl.formatMessage({id:"dialog.previewform.column.index"}),fieldName:"recordindex",minWidth:32,maxWidth:32,isRowHeader:!0,isResizable:!0,isSorted:!0,isSortedDescending:!1,sortAscendingAriaLabel:"Sorted A to Z",sortDescendingAriaLabel:"Sorted Z to A",data:"string",isPadded:!0},{key:"column_name",name:this.props.intl.formatMessage({id:"dialog.previewform.column.sample"}),fieldName:"recordname",minWidth:200,maxWidth:260,isResizable:!0,data:"string",isPadded:!0},{key:"column_details",name:this.props.intl.formatMessage({id:"dialog.previewform.column.action"}),fieldName:"recordlink",minWidth:40,maxWidth:40,isResizable:!0,isCollapsible:!0,data:"string",isPadded:!0,onRender:function(t){return x.createElement(D.a,{onClick:function(){return e.handleShowDetails(t)}},e.props.intl.formatMessage({id:"dialog.previewform.link.showdetails"}))}}]}},{key:"getItemKey",value:function(e,t){return e.index}},{key:"render",value:function(){var e=this;if(!this.state.showPreviewProcess){var t=this.initColums();return x.createElement(E.a,{verticalFill:!0},x.createElement(E.a,{className:"recordlist"},x.createElement(S.a,{variant:"mediumPlus",block:!0},this.props.intl.formatMessage({id:"dialog.previewform.record.title"})),x.createElement(V.a,{items:this.state.designRecords,compact:!0,columns:t,selectionMode:G.c.single,selection:this.selection,getKey:this.getItemKey,setKey:"single",layoutMode:_.e.justified,isHeaderVisible:!0,selectionPreservedOnEmptyClick:!0,enterModalSelectionOnTouch:!0,ariaLabelForSelectionColumn:"Toggle selection",ariaLabelForSelectAllCheckbox:"Toggle selection for all items",checkButtonAriaLabel:"Row checkbox"})),x.createElement(E.a,{className:"dialogactionpanel"},x.createElement(E.a.Item,{align:"center"},x.createElement(E.a,{verticalAlign:"center"},x.createElement(E.a,{horizontal:!0,horizontalAlign:"center"},x.createElement(P.a,{iconProps:O.previewLinkIcon,disabled:!this.state.selectedRecord,onClick:function(){return e.handleSelectedRecordPreview()}},this.props.intl.formatMessage({id:"action.dopreview"})))))),x.createElement(E.a.Item,null,x.createElement(M.a,{isOpen:this.state.showDetailsPanel,onDismiss:function(){return e.closeDetailsPanel()},type:C.a.smallFluid,closeButtonAriaLabel:"Close",headerText:this.props.intl.formatMessage({id:"dialog.previewform.record.details"})},x.createElement(L.a,{key:"dataSelectorTree",mode:B.a.DataDisplay,treedata:this.state.recordToShow,hidden:!1,isChinese:!1,onClose:function(){return e.closeDetailsPanel()}}))))}return x.createElement(Q,{sendMessage:this.props.sendMessage,formData:this.props.formData,designRecord:this.state.selectedRecord,authConfig:this.props.authConfig,updateFormFieldValue:this.props.updateFormFieldValue,reportErrorMessage:this.props.reportErrorMessage,onShowButtons:this.props.onShowButtons})}}]),r}(x.Component),ne=Object(j.c)(re);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\PreviewForm.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\PreviewForm.js")}}();var oe=r(77),ae=r.n(oe),se=r(699),ie=r(187),le=r(564),ce=r(703),ue=r(644),pe=r(54),de=r(439);function fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var ge=function(e){d()(r,e);var t=fe(r);function r(e,n){return s()(this,r),t.call(this,e,n)}return l()(r,[{key:"componentDidMount",value:function(){}},{key:"handleDataBind",value:function(){this.props.onOpenDataSelectorPanel&&this.props.onOpenDataSelectorPanel(!0,this)}},{key:"updateExpressionValueType",value:function(e){var t;if((null===(t=this.props.expressionValue)||void 0===t?void 0:t.valueType)!==e&&this.props.onUpdateExpressionValue){var r=Object.assign({},this.props.expressionValue);r.valueType=e,this.props.onUpdateExpressionValue(r)}}},{key:"updateExpressionValue",value:function(e){var t;if((null===(t=this.props.expressionValue)||void 0===t?void 0:t.value)!==e&&this.props.onUpdateExpressionValue){var r=Object.assign({},this.props.expressionValue);r.value=e,this.props.onUpdateExpressionValue(r)}}},{key:"handleBlur",value:function(e){this.updateExpressionValue(e)}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&this.handleBlur(e.target.value)}},{key:"getExpressionEditor",value:function(){var e,t=this;return(null===(e=this.props.expressionValue)||void 0===e?void 0:e.valueType)===pe.ExpressionValueType.Value?x.createElement(E.a.Item,{grow:2,key:this.props.expressionValue.value},x.createElement(de.a,{defaultValue:this.props.expressionValue.value,onKeyPress:function(e){return t.handleKeyPress(e)},onBlur:function(e){return t.handleBlur(e.target.value)},underlined:!0})):x.createElement(E.a.Item,{grow:2,key:this.props.expressionValue.value},x.createElement(E.a,{horizontal:!0},x.createElement(E.a.Item,{grow:2},x.createElement(de.a,{defaultValue:this.props.expressionValue.value,onKeyPress:function(e){return t.handleKeyPress(e)},onBlur:function(e){return t.handleBlur(e.target.value)},underlined:!0})),x.createElement(E.a.Item,null,x.createElement(ie.a,{iconProps:O.dataBindFieldIcon,onClick:function(){return t.handleDataBind()}}))))}},{key:"render",value:function(){var e,t=this,r=null===(e=this.props.expressionValue)||void 0===e?void 0:e.valueType,n=this.props.intl,o={items:[{key:"dwDataBind",text:n.formatMessage({id:"dialog.expression.action.databind"}),iconProps:O.dataBindFieldIcon,onClick:function(){return t.updateExpressionValueType(pe.ExpressionValueType.DataBind)}},{key:"dwValue",text:n.formatMessage({id:"dialog.expression.action.value"}),iconProps:O.valueFieldIcon,onClick:function(){return t.updateExpressionValueType(pe.ExpressionValueType.Value)}}],directionalHintFixed:!0};return x.createElement(E.a,{horizontal:!0},x.createElement(E.a.Item,{styles:O.propertyLableFieldStyles},x.createElement(P.a,{menuProps:o,iconProps:r===pe.ExpressionValueType.Value?O.valueFieldIcon:O.dataBindFieldIcon,text:r===pe.ExpressionValueType.Value?n.formatMessage({id:"dialog.expression.action.value"}):n.formatMessage({id:"dialog.expression.action.databind"})})),this.getExpressionEditor())}}]),r}(x.Component),me=Object(j.c)(ge);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\ExpressionField.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\ExpressionField.js")}}();var he=r(268);function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var ye=function(e){d()(r,e);var t=ve(r);function r(e,n){var o,a,i,l;return s()(this,r),l=t.call(this,e,n),y()(u()(l),"handleDataSourceParentMsg",(function(e){console.log("receive datasource from parent event."),l.setupDataSource(e.message)})),y()(u()(l),"setupDataSource",(function(e){if(e&&e.length>0){var t=JSON.parse(e),r=Object(he.a)(t);l.setState({dataSource:r})}})),y()(u()(l),"updateFormFieldValue",(function(e){l.props.updateFormFieldValue({elementName:e.elementName,dataBind:e.jsonPath})})),l.state={rules:null!==(o=null===(a=l.props.formData)||void 0===a||null===(i=a.expression)||void 0===i?void 0:i.source)&&void 0!==o?o:[],sourceCode:"",selectedList:[],isPanelOpened:!1,isDesignView:!0,dataSource:null,expandStatus:[]},l}return l()(r,[{key:"componentDidMount",value:function(){var e=this;if($.a.newInstance().isLocalStorageUsed()){var t=localStorage.getItem(O.STORAGE_KEY_DATASOURCE);this.setupDataSource(t)}else Object(I.G)(this.handleDataSourceParentMsg,(function(t){t.status===Office.AsyncResultStatus.Succeeded?(console.log("DialogParentMessageReceived event Registered."),e.props.sendMessage({keep:!0,requestDS:!0})):console.log("DialogParentMessageReceived event Register Failed.")}))}},{key:"createNewExpressionValueRule",value:function(){return{id:Date.now(),operator:pe.ExpressionOperator.Equal,sourceExpressionValue:{valueType:pe.ExpressionValueType.DataBind,value:""},compareExpressionValue:{valueType:pe.ExpressionValueType.DataBind,value:""}}}},{key:"createNewGroupRule",value:function(e){return{id:Date.now(),logicOperator:e,expressions:[]}}},{key:"handleAddRule",value:function(e){var t=ae()(this.state.rules),r=this.createNewExpressionValueRule();if(e){var n=this.searchRuleById(e.id,t);n&&n.expressions.push(r)}else t.push(r);this.setRulesState(t)}},{key:"handleAddGroupRule",value:function(e){if(this.state.selectedList&&this.state.selectedList.length>1){var t=this.createNewGroupRule(e),r=ae()(this.state.selectedList);t.expressions=r;for(var n=ae()(this.state.rules),o=Number.MAX_SAFE_INTEGER,a=function(e){var t=r[e],a=n.findIndex((function(e){return e.id===t.id}));a>=0&&(a<o&&(o=a),n.splice(a,1))},s=0;s<r.length;s++)a(s);o!==Number.MAX_SAFE_INTEGER&&n.splice(o,0,t),this.setRulesState(n),this.toggleExpandStatus(t.id,!1),this.resetSelectedList([])}}},{key:"resetSelectedList",value:function(e){this.setState({selectedList:e})}},{key:"handleUnGroup",value:function(){if(this.state.selectedList&&1===this.state.selectedList.length){var e=this.state.selectedList[0];if(e.expressions){var t=ae()(this.state.rules),r=t.findIndex((function(t){return t.id===e.id}));r>=0&&(t.splice.apply(t,[r,1].concat(ae()(e.expressions))),this.setRulesState(t),this.resetSelectedList([]),this.removeGroupExpandStatusTrack(e.id))}}}},{key:"handleDeleteSelectedRules",value:function(){var e=this;if(this.state.selectedList&&this.state.selectedList.length>0){for(var t=ae()(this.state.rules),r=function(r){var n=e.state.selectedList[r],o=t.findIndex((function(e){return e.id===n.id}));o>=0&&t.splice(o,1)},n=0;n<this.state.selectedList.length;n++)r(n);this.setRulesState(t),this.resetSelectedList([])}}},{key:"setRulesState",value:function(e){var t=this.renderSourceCode(e," && ");this.props.updateFormFieldValue&&this.props.updateFormFieldValue({expression:{source:e,value:t}}),this.setState({rules:e,sourceCode:t})}},{key:"setCheckItemStatus",value:function(e,t,r){var n=ae()(this.state.selectedList),o=n.findIndex((function(e){return e.id===t.id}));r?o>=0?n[o]=t:n.push(t):o>=0&&n.splice(o,1),this.setState({selectedList:n})}},{key:"changeRuleOperator",value:function(e,t){var r=ae()(this.state.rules),n=this.searchRuleById(e.id,r);n&&!n.expressions&&(n.operator=t.key,this.setRulesState(r))}},{key:"changeGroupLogicOperator",value:function(e,t){var r=ae()(this.state.rules),n=this.searchRuleById(e.id,r);n&&n.expressions&&(n.logicOperator=t,this.setRulesState(r))}},{key:"toggleShowExpressionRuleCode",value:function(){var e=this.state.isDesignView;this.setRulesState(ae()(this.state.rules)),this.setState({isDesignView:!e})}},{key:"setDataSelectorPanelOpen",value:function(e,t){this.setState({isPanelOpened:e}),this.setBindingField(t)}},{key:"searchRuleById",value:function(e,t){for(var r=0;t&&r<t.length;r++){var n=t[r];if(n.id===e)return n;var o=null;if(n.expressions&&(o=this.searchRuleById(e,n.expressions)),o)return o}return null}},{key:"handleUpdateExpressionValue",value:function(e,t,r){var n=ae()(this.state.rules),o=this.searchRuleById(e,n);o&&!o.expressions&&(t?o.sourceExpressionValue=r:o.compareExpressionValue=r,this.setRulesState(n))}},{key:"setBindingField",value:function(e){this.bindingField=e}},{key:"handleUpdateDataBind",value:function(e,t){this.bindingField&&this.bindingField.updateExpressionValue(e)}},{key:"removeGroupExpandStatusTrack",value:function(e){var t=ae()(this.state.expandStatus),r=t.findIndex((function(t){return t.id===e}));r>=0&&(t.splice(r,1),this.setState({expandStatus:t}))}},{key:"toggleExpandStatus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=ae()(this.state.expandStatus),n=r.find((function(t){return t.id===e}));n?n.collapse=!n.collapse:(n={id:e,collapse:t},r.push(n)),this.setState({expandStatus:r})}},{key:"renderExpressionRule",value:function(e,t){var r=this,n=this.props.intl,o=[{key:pe.ExpressionOperator.Equal,text:n.formatMessage({id:"dialog.expression.operator.equal"})},{key:pe.ExpressionOperator.NoEqual,text:n.formatMessage({id:"dialog.expression.operator.notequal"})},{key:pe.ExpressionOperator.GreatEqual,text:n.formatMessage({id:"dialog.expression.operator.greatequal"})},{key:pe.ExpressionOperator.LessEqual,text:n.formatMessage({id:"dialog.expression.operator.lessequal"})},{key:pe.ExpressionOperator.LessThan,text:n.formatMessage({id:"dialog.expression.operator.lessthan"})},{key:pe.ExpressionOperator.GreatThan,text:n.formatMessage({id:"dialog.expression.operator.greatthan"})},{key:pe.ExpressionOperator.Contains,text:n.formatMessage({id:"dialog.expression.operator.contains"})}],a=1===t;if(e.expressions){var s=e.logicOperator===pe.LogicOperator.And,i={items:[{key:"btnSwitchGroup",text:s?n.formatMessage({id:"dialog.expression.logicoperator.or"}):n.formatMessage({id:"dialog.expression.logicoperator.and"}),iconProps:s?O.groupOrIcon:O.groupAndIcon,onClick:function(){return r.changeGroupLogicOperator(e,s?pe.LogicOperator.Or:pe.LogicOperator.And)}},{key:"btnAddRule",text:n.formatMessage({id:"dialog.expression.action.add"}),iconProps:O.btnNewIcon,onClick:function(){return r.handleAddRule(e)}}]},l=e.expressions.map((function(e){var n=t+1;return r.renderExpressionRule(e,n)})),c=this.state.expandStatus.find((function(t){return t.id===e.id})),u=null==c?void 0:c.collapse;return x.createElement("li",{key:e.id},x.createElement("table",{className:"expressionRuleTable"},x.createElement("tbody",null,x.createElement("tr",null,a?x.createElement("td",{className:"checkboxCell"},x.createElement(se.a,{onChange:function(t,n){return r.setCheckItemStatus(t,e,n)}})):null,x.createElement("td",{className:"expressionGroupCell"},x.createElement(ie.a,{iconProps:u?O.expandTreeIcon:O.collapseTreeIcon,onClick:function(){return r.toggleExpandStatus(e.id,!0)},className:"treenode-normal"}),x.createElement(le.a,{menuProps:i,iconProps:e.logicOperator===pe.LogicOperator.And?O.groupAndIcon:O.groupOrIcon,text:e.logicOperator===pe.LogicOperator.And?n.formatMessage({id:"dialog.expression.logicoperator.and"}):n.formatMessage({id:"dialog.expression.logicoperator.or"})}))))),x.createElement("ul",{className:u?"collapse":"expand"},l))}return x.createElement("li",{key:e.id},x.createElement("table",{className:"expressionRuleTable"},x.createElement("tbody",null,x.createElement("tr",null,a?x.createElement("td",{className:"checkboxCell"},x.createElement(se.a,{onChange:function(t,n){return r.setCheckItemStatus(t,e,n)}})):null,x.createElement("td",{className:"expressionValueCell"},x.createElement(me,{key:e.id,expressionValue:null==e?void 0:e.sourceExpressionValue,onUpdateExpressionValue:function(t){r.handleUpdateExpressionValue(e.id,!0,t)},onOpenDataSelectorPanel:function(e,t){r.setDataSelectorPanelOpen(e,t)}})),x.createElement("td",{className:"operatorCell"},x.createElement(ce.a,{selectedKey:null==e?void 0:e.operator,onChange:function(t,n){return r.changeRuleOperator(e,n)},options:o,styles:{title:{border:"none",borderBottom:"solid"}}})),x.createElement("td",{className:"expressionValueCell"},x.createElement(me,{key:e.id,expressionValue:null==e?void 0:e.compareExpressionValue,onUpdateExpressionValue:function(t){r.handleUpdateExpressionValue(e.id,!1,t)},onOpenDataSelectorPanel:function(e,t){r.setDataSelectorPanelOpen(e,t)}}))))))}},{key:"parseExpressionOperator",value:function(e){switch(e){case pe.ExpressionOperator.Equal:return" == ";case pe.ExpressionOperator.NoEqual:return" != ";case pe.ExpressionOperator.GreatEqual:return" >= ";case pe.ExpressionOperator.LessEqual:return" <= ";case pe.ExpressionOperator.GreatThan:return" >= ";case pe.ExpressionOperator.LessThan:return" <= ";default:return""}}},{key:"checkValueType",value:function(e){var t,r=null!==(t=null==e?void 0:e.toLowerCase())&&void 0!==t?t:null;if(r)return r.startsWith("{")&&r.endsWith("}")?Object:isNaN(parseFloat(r))?r.startsWith("[")&&r.endsWith("]")?Array:!r||"true"!==r&&"false"!==r?String:Boolean:Number}},{key:"parseExpressionValue",value:function(e){var t=this.checkValueType(e.value);return t?e.valueType===pe.ExpressionValueType.DataBind?e.value:t===String?'"'+e.value+'"':e.value:"null"}},{key:"renderExpressionValueRule",value:function(e){return e?e.operator===pe.ExpressionOperator.Contains?'contains("'+e.sourceExpressionValue.value+'", "'+e.compareExpressionValue.value+'")':this.parseExpressionValue(e.sourceExpressionValue)+this.parseExpressionOperator(e.operator)+this.parseExpressionValue(e.compareExpressionValue):""}},{key:"renderRuleSourceCode",value:function(e){var t="";return e&&(e.expressions?(t+="(",t+=this.renderSourceCode(ae()(e.expressions),e.logicOperator===pe.LogicOperator.And?" && ":" || "),t+=")"):t=this.renderExpressionValueRule(e)),t}},{key:"renderSourceCode",value:function(e,t){for(var r="",n=0;n<e.length;n++){var o=e[n];r+=this.renderRuleSourceCode(o),n<e.length-1&&(r+=t)}return r}},{key:"render",value:function(){var e,t=this;if(!this.props.formData)return null;var r=this.props.intl,n=null===(e=this.state.selectedList)||void 0===e?void 0:e.length,o=this.state.isDesignView,a={ariaLabel:r.formatMessage({id:"dialog.expression.morecommands"})},s=[{key:"mnuAdd",text:r.formatMessage({id:"dialog.expression.action.add"}),iconProps:O.btnNewIcon,onClick:function(){return t.handleAddRule()},disabled:!o},{key:"mnuDelete",text:r.formatMessage({id:"dialog.expression.action.delete"}),iconProps:O.btnDeleteIcon,onClick:function(){return t.handleDeleteSelectedRules()},disabled:!o||n<=0},{key:"mnuAndGroup",text:r.formatMessage({id:"dialog.expression.action.groupand"}),iconProps:O.groupAndIcon,onClick:function(){return t.handleAddGroupRule(pe.LogicOperator.And)},disabled:!o||n<2},{key:"mnuOrGroup",text:r.formatMessage({id:"dialog.expression.action.groupor"}),iconProps:O.groupOrIcon,onClick:function(){return t.handleAddGroupRule(pe.LogicOperator.Or)},disabled:!o||n<2},{key:"mnuUnGroup",text:r.formatMessage({id:"dialog.expression.action.ungroup"}),iconProps:O.unGroupIcon,onClick:function(){return t.handleUnGroup()},disabled:!(o&&1==n&&this.state.selectedList[0].expressions)}],i=[{key:"btnShowCode",text:o?r.formatMessage({id:"dialog.expression.action.showcode"}):r.formatMessage({id:"dialog.expression.action.showdesign"}),ariaLabel:o?r.formatMessage({id:"dialog.expression.action.showcodedesc"}):r.formatMessage({id:"dialog.expression.action.showdesigndesc"}),iconOnly:!0,iconProps:o?O.editCodeIcon:O.btnDesignIcon,onClick:function(){t.toggleShowExpressionRuleCode()}}],l=this.state.rules.map((function(e){return t.renderExpressionRule(e,1)}));return x.createElement(E.a,{verticalAlign:"start"},x.createElement(E.a.Item,null,x.createElement("div",{className:"properties-bar"},x.createElement(ue.a,{items:s,overflowItems:[],overflowButtonProps:a,farItems:i}))),x.createElement(E.a.Item,null,x.createElement("ul",{className:"domtree",hidden:!this.state.isDesignView},l),x.createElement("div",{hidden:this.state.isDesignView,className:"expressionsourcecode"},this.state.sourceCode)),x.createElement(E.a.Item,null,x.createElement(M.a,{isOpen:this.state.isPanelOpened,onDismiss:function(){return t.setDataSelectorPanelOpen(!1,null)},type:C.a.medium,closeButtonAriaLabel:"Close",headerText:"Data Selector"},x.createElement(L.a,{key:"dataSelectorTree",mode:B.a.DataBind,treedata:this.state.dataSource,onUpdateDataBind:function(e,r){t.handleUpdateDataBind(e,r)},hidden:!1,onClose:function(){return t.setDataSelectorPanelOpen(!1,null)},isChinese:!1}))))}}]),r}(x.Component),xe=Object(j.c)(ye);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\ExpressionEditorForm.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\controls\\ExpressionEditorForm.js")}}();var Ee=r(228),Se=r(226);function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var we=function(e){d()(r,e);var t=be(r);function r(e,n){var o;s()(this,r),o=t.call(this,e,n),y()(u()(o),"updateFormFieldValue",(function(e){var t=Object.assign({},o.state.form);Object.assign(t,e),o.setState({form:t})})),y()(u()(o),"setShowButtonStatus",(function(e){o.setState({showButtons:e})})),y()(u()(o),"getFormControlByCommandName",(function(){switch(o.props.commandName){case O.CMD_PREVIEW_PDF:case O.CMD_PREVIEW_WORD:return ne;case O.CMD_EDIT_EXPRESSION:return xe;default:return S.a}}));var a=Object.assign({},o.props.formData);return o.state={form:a,errorMessage:null,showButtons:!0},o}return l()(r,[{key:"componentDidMount",value:function(){}},{key:"reportErrorMessage",value:function(e){this.setState({errorMessage:e})}},{key:"renderErrorMessageBar",value:function(){var e=this;return!this.state.errorMessage||this.state.errorMessage.length<=0?null:x.createElement(b.a,{messageBarType:w.a.error,isMultiline:!1,onDismiss:function(){return e.clearErrorMessage()},dismissButtonAriaLabel:"Close"},this.state.errorMessage)}},{key:"clearErrorMessage",value:function(){this.setState({errorMessage:null})}},{key:"render",value:function(){var e=this,t=this.getFormControlByCommandName();return this.state.form?x.createElement(k.a,null,x.createElement(E.a.Item,{grow:6},x.createElement(t,{sendMessage:this.props.sendMessage,formData:this.state.form,authConfig:this.props.authConfig,updateFormFieldValue:function(t){return e.updateFormFieldValue(t)},reportErrorMessage:function(t){return e.reportErrorMessage(t)},onShowButtons:function(t){return e.setShowButtonStatus(t)}})),x.createElement(E.a.Item,{grow:2},x.createElement(Se.a,{clearErrorMessage:function(){return e.clearErrorMessage()},isMultiline:!1,isError:!0,message:this.state.errorMessage})),x.createElement(E.a.Item,{grow:1},x.createElement(Ee.a,{formData:this.state.form,sendMessage:this.props.sendMessage,showButtons:this.state.showButtons}))):null}}]),r}(x.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DynamicForm.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DynamicForm.js")}}();var Oe=r(227);function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var Re=function(e){d()(r,e);var t=ke(r);function r(e,n){var a;return s()(this,r),a=t.call(this,e,n),y()(u()(a),"sendMessageToParent",(function(e){var t=e;"object"!==o()(e)&&"string"!=typeof e||(t=JSON.stringify(e)),Office.context.ui.messageParent(t)})),a}return l()(r,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return x.createElement(E.a,{verticalFill:!0,verticalAlign:"center",tokens:{childrenGap:1},className:"dialogwrapper"},x.createElement(Oe.a,{dialog:this.props.dialog}),x.createElement(we,{sendMessage:function(t){return e.sendMessageToParent(t)},formData:this.props.node,commandName:this.props.commandName,authConfig:this.props.authConfig}))}}]),r}(x.Component);!function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var r=void 0!==t?t:exports;if(r)if("function"!=typeof r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=void 0;try{o=r[n]}catch(e){continue}e.register(o,n,"D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DialogApp.js")}}else e.register(r,"module.exports","D:\\Work\\projects\\yundoc-client\\word-plugin\\src\\dialogs\\components\\DialogApp.js")}}()},77:function(e,t,r){var n=r(543),o=r(544),a=r(545),s=r(546);e.exports=function(e){return n(e)||o(e)||a(e)||s()},e.exports.default=e.exports,e.exports.__esModule=!0}});